(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[6895],{53001:(e,t,r)=>{"use strict";r.d(t,{xT:()=>n,H_:()=>o,Wv:()=>a,gC:()=>i,dG:()=>l,oQ:()=>c,Q2:()=>u,R3:()=>s,Zr:()=>p,Op:()=>d,l$:()=>f,uL:()=>y,zg:()=>m,M3:()=>v,st:()=>g,US:()=>E,$c:()=>T,pW:()=>h,$D:()=>R,ke:()=>b,vw:()=>O,r5:()=>S,X1:()=>L,V3:()=>A,p2:()=>I});var n="BACKGROUND_SELECTOR:ADD_BACKGROUND",o="BACKGROUND_SELECTOR:REMOVE_BACKGROUND",a="BACKGROUND_SELECTOR:SET_CURRENT_BACKGROUND_LAYER",i="BACKGROUND_SELECTOR:BACKGROUND_ADDED",l="BACKGROUND_SELECTOR:BACKGROUND_EDITED",c="BACKGROUND_SELECTOR:ADD_BACKGROUND_PROPERTIES",u="BACKGROUND_SELECTOR:SET_BACKGROUND_MODAL_PARAMS",s="BACKGROUND_SELECTOR:UPDATE_BACKGROUND_THUMBNAIL",p="BACKGROUND_SELECTOR:BACKGROUNDS_CLEAR",d="BACKGROUND_SELECTOR:CREATE_BACKGROUNDS_LIST",f="BACKGROUND_SELECTOR:CLEAR_MODAL_PARAMETERS",y="BACKGROUND_SELECTOR:CONFIRM_DELETE_BACKGROUND_MODAL",m="BACKGROUND_SELECTOR:ALLOW_BACKGROUNDS_DELETION";function v(e){return{type:d,backgrounds:e}}function g(e){return{type:n,source:e}}function E(e){return{type:c,modalParams:e}}function T(e){return{type:u,modalParams:e}}function h(e){return{type:i,layerId:e}}function R(e){return{type:l,layerId:e}}function b(e){return{type:a,layerId:e}}function O(e){return{type:m,allow:e}}function S(e,t){return{type:s,thumbnailData:e,id:t}}function L(e){return{type:o,backgroundId:e}}function A(){return{type:f}}function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:y,show:e,layerTitle:t,layerId:r}}},4206:(e,t,r)=>{"use strict";r.d(t,{hZ:()=>n,pb:()=>o,kD:()=>a,DI:()=>i,IC:()=>l,Vw:()=>s,KD:()=>p,uj:()=>d,lo:()=>f,Yf:()=>y,fo:()=>m,PY:()=>v});var n="CHANGE_DRAWING_STATUS",o="DRAW:END_DRAWING",a="DRAW:SET_CURRENT_STYLE",i="DRAW:GEOMETRY_CHANGED",l="DRAW:DRAW_SUPPORT_STOPPED",c="DRAW:FEATURES_SELECTED",u="DRAW:DRAWING_FEATURES";function s(e,t,r,n,o){return{type:i,features:e,owner:t,enableEdit:r,textChanged:n,circleChanged:o}}function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:c,features:e}}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{type:u,features:e}}function f(){return{type:l}}function y(e,t,r,o,a,i){return{type:n,status:e,method:t,owner:r,features:o,options:a,style:i}}function m(e,t){return{type:o,geometry:e,owner:t}}function v(e){return{type:a,currentStyle:e}}},90825:(e,t,r)=>{"use strict";r.d(t,{k:()=>i});var n=r(80416),o=r(67007);r(32420),r(75875),r(8575),r(27418),r(5055);var a=r(24262);function i(e,t){var r=(0,a.getCapabilitiesUrl)(e);return function(i){return i((0,n.tV)(e.id,"id",{capabilitiesLoading:!0})),o.ZP.getCapabilities(r,t).then((function(t){var r=o.ZP.parseLayerCapabilities(t,e);i(r?(0,n.tV)(e.id,"id",(0,a.formatCapabitiliesOptions)(r)):(0,n.tV)(e.id,"id",{capabilitiesLoading:null,capabilities:{error:"error getting capabilities",details:"no layer info"},description:null}))})).catch((function(t){i((0,n.tV)(e.id,"id",{capabilitiesLoading:null,capabilities:{error:"error getting capabilities",details:t},description:null}))}))}}r(61545)},40512:(e,t,r)=>{"use strict";function n(){return{type:"LAYER_FILTER:OPEN_QUERY_BUILDER"}}r.d(t,{Zq:()=>n})},21914:(e,t,r)=>{"use strict";r.d(t,{XL:()=>o,km:()=>a,Ih:()=>i,Xw:()=>l,Pn:()=>c,DZ:()=>u,e8:()=>s,E0:()=>p,F9:()=>d,X_:()=>f,pb:()=>y,qb:()=>m,Re:()=>v,ih:()=>g,xy:()=>E,jL:()=>T,oz:()=>h,ph:()=>R,lF:()=>b,gG:()=>O,cb:()=>S,GI:()=>L,B1:()=>A,fv:()=>I,gc:()=>C,zX:()=>_,ZF:()=>w,Fm:()=>x,sV:()=>D,Mn:()=>G,LU:()=>N,XP:()=>P,WU:()=>M,JB:()=>F,g:()=>U,ws:()=>B,HP:()=>j,aN:()=>Z,Pg:()=>k,u0:()=>q,TM:()=>Y,PM:()=>H,lK:()=>K,sv:()=>V,MO:()=>Q,oO:()=>$,Mc:()=>X,Zw:()=>z,RA:()=>J,am:()=>ee,ZM:()=>te,wm:()=>re});var n=r(47310),o="LOAD_FEATURE_INFO",a="ERROR_FEATURE_INFO",i="EXCEPTIONS_FEATURE_INFO",l="CHANGE_MAPINFO_STATE",c="NEW_MAPINFO_REQUEST",u="PURGE_MAPINFO_RESULTS",s="CHANGE_MAPINFO_FORMAT",p="SHOW_MAPINFO_MARKER",d="HIDE_MAPINFO_MARKER",f="SHOW_REVERSE_GEOCODE",y="HIDE_REVERSE_GEOCODE",m="GET_VECTOR_INFO",v="NO_QUERYABLE_LAYERS",g="CLEAR_WARNING",E="FEATURE_INFO_CLICK",T="IDENTIFY:UPDATE_FEATURE_INFO_CLICK_POINT",h="IDENTIFY:TOGGLE_HIGHLIGHT_FEATURE",R="TOGGLE_MAPINFO_STATE",b="UPDATE_CENTER_TO_MARKER",O="IDENTIFY:CHANGE_PAGE",S="IDENTIFY:CLOSE_IDENTIFY",L="IDENTIFY:CHANGE_FORMAT",A="IDENTIFY:TOGGLE_SHOW_COORD_EDITOR",I="IDENTIFY:EDIT_LAYER_FEATURES",C="IDENTIFY:CURRENT_EDIT_FEATURE_QUERY",_="IDENTIFY:SET_MAP_TRIGGER",w="IDENTIFY:TOGGLE_EMPTY_MESSAGE_GFI";function x(e,t,r,n,a){return{type:o,data:t,reqId:e,requestParams:r,layerMetadata:n,layer:a}}function D(e,t,r,n){return{type:a,error:t,reqId:e,requestParams:r,layerMetadata:n}}function G(e,t,r,n){return{type:i,reqId:e,exceptions:t,requestParams:r,layerMetadata:n}}function N(){return{type:v}}function P(){return{type:g}}function M(e,t){return{type:c,reqId:e,request:t}}function F(e,t,r,n){return{type:m,layer:e,request:t,metadata:r,queryableLayers:n}}function U(){return{type:u}}function B(e){return{type:s,infoFormat:e}}function j(){return{type:p}}function Z(){return{type:d}}function W(e){return{type:f,reverseGeocodeData:e.data}}function k(e){return function(t){n.Z.reverseGeocode(e).then((function(e){t(W(e))})).catch((function(e){t(W(e))}))}}function q(){return{type:y}}function Y(){return{type:R}}function H(e){return{type:b,status:e}}function K(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return{type:E,point:e,layer:t,filterNameList:r,overrideParams:n,itemId:o}}function V(e){return{type:T,point:e}}function Q(e){return{type:h,enabled:e}}function $(e){return{type:O,index:e}}var X=function(){return{type:S}},z=function(e){return{type:L,format:e}},J=function(e){return{type:A,showCoordinateEditor:e}},ee=function(e){return{type:I,layer:e}},te=function(e){return{type:C,query:e}},re=function(e){return{type:_,trigger:e}}},7878:(e,t,r)=>{"use strict";r.d(t,{E6:()=>n,vo:()=>o,l1:()=>a,J9:()=>i,U:()=>l,z8:()=>c,ql:()=>u,O_:()=>s,M$:()=>p,Ug:()=>d,p5:()=>f,Fz:()=>y,WZ:()=>m,bP:()=>v,d_:()=>g,xM:()=>E,bl:()=>T,Wi:()=>h,PN:()=>R,_M:()=>b,Eg:()=>O,V1:()=>S,cY:()=>L,RD:()=>A,Hl:()=>I,co:()=>C,uY:()=>_,H8:()=>w,je:()=>x,go:()=>D,_8:()=>G,xd:()=>N,o7:()=>P,Nr:()=>M,Gf:()=>F,nh:()=>U,Rf:()=>B,D6:()=>j,Sm:()=>Z,Ef:()=>W}),r(75875);var n="ADD_FILTER_FIELD",o="REMOVE_FILTER_FIELD",a="UPDATE_FILTER_FIELD",i="UPDATE_EXCEPTION_FIELD",l="ADD_GROUP_FIELD",c="UPDATE_LOGIC_COMBO",u="REMOVE_GROUP_FIELD",s="CHANGE_CASCADING_VALUE",p="EXPAND_ATTRIBUTE_PANEL",d="EXPAND_SPATIAL_PANEL",f="QUERYFORM:EXPAND_CROSS_LAYER",y="QUERYFORM:SET_CROSS_LAYER_PARAMETER",m="QUERYFORM:RESET_CROSS_LAYER_FILTER",v="SELECT_SPATIAL_METHOD",g="UPDATE_GEOMETRY",E="SELECT_SPATIAL_OPERATION",T="CHANGE_SPATIAL_ATTRIBUTE",h="CHANGE_SPATIAL_FILTER_VALUE",R="REMOVE_SPATIAL_SELECT",b="SHOW_SPATIAL_DETAILS",O="QUERY_FORM_RESET",S="SHOW_GENERATED_FILTER",L="CHANGE_DWITHIN_VALUE",A="ZONE_SEARCH",I="ZONE_SEARCH_ERROR",C="ZONE_FILTER",_="ZONE_CHANGE",w="ZONES_RESET",x="SIMPLE_FILTER_FIELD_UPDATE",D="ADD_SIMPLE_FILTER_FIELD",G="REMOVE_SIMPLE_FILTER_FIELD",N="REMOVE_ALL_SIMPLE_FILTER_FIELDS",P="UPDATE_FILTER_FIELD_OPTIONS",M="LOADING_FILTER_FIELD_OPTIONS",F="QUERYFORM:ADD_CROSS_LAYER_FILTER_FIELD",U="QUERYFORM:UPDATE_CROSS_LAYER_FILTER_FIELD",B="QUERYFORM:REMOVE_CROSS_LAYER_FILTER_FIELD",j="SET_AUTOCOMPLETE_MODE",Z="TOGGLE_AUTOCOMPLETE_MENU",W="QUERYFORM:LOAD_FILTER"},59551:(e,t,r)=>{"use strict";r.d(t,{Z:()=>y});var n=r(8575),o=r(61545),a=r.n(o),i=r(27418),l=r.n(i),c=r(75875),u=r.n(c),s=r(37275),p=r(90183),d=function(e){var t=n.parse(e,!0);return n.format(l()({},t,{search:null},{query:l()({service:"CSW",version:"2.0.2"},t.query,{request:void 0})}))},f={parseUrl:d,getRecordById:function(e){return new Promise((function(t){Promise.all([r.e(9942),r.e(6372)]).then(function(){t(u().get(e).then((function(e){if(e){var t=r(66372).unmarshaller.unmarshalString(e.data);if(t&&t.name&&"GetRecordByIdResponse"===t.name.localPart&&t.value&&t.value.abstractRecord){var n=t.value.abstractRecord[0].value.dcElement;if(n){for(var o={references:[]},a=0;a<n.length;a++){var i=n[a],l=i.name.localPart,c={};c="references"===l&&i.value?{value:i.value.content&&(0,s.$F)(i.value.content[0])||i.value.content||i.value,scheme:i.value.scheme}:i.value.content&&i.value.content[0]||i.value.content||i.value,o[l]&&Array.isArray(o[l])?o[l].push(c):o[l]?o[l]=[o[l],c]:o[l]=c}return{dc:o}}}else if(t&&t.name&&"ExceptionReport"===t.name.localPart)return{error:t.value.exception&&t.value.exception.length&&t.value.exception[0].exceptionText||"GenericError"};return null}return null})))}.bind(null,r)).catch(r.oe)}))},getRecords:function(e,t,n,o){return new Promise((function(i){Promise.all([r.e(9942),r.e(1269)]).then(function(){var l=r(66372),c=l.CSW,f=l.marshaller,y=l.unmarshaller,m=f.marshalString({name:"csw:GetRecords",value:c.getRecords(t,n,o)});i(u().post(d(e),m,{headers:{"Content-Type":"application/xml"}}).then((function(e){if(e){var t=y.unmarshalString(e.data);if(t&&t.name&&"GetRecordsResponse"===t.name.localPart&&t.value&&t.value.searchResults){var r=t.value,n=r.searchResults.abstractRecord||r.searchResults.any,o={numberOfRecordsMatched:r.searchResults.numberOfRecordsMatched,numberOfRecordsReturned:r.searchResults.numberOfRecordsReturned,nextRecord:r.searchResults.nextRecord},i=[];if(n)for(var l=0;l<n.length;l++){var c=n[l].value,u={dateStamp:c.dateStamp&&c.dateStamp.date,fileIdentifier:c.fileIdentifier&&c.fileIdentifier.characterString&&c.fileIdentifier.characterString.value,identificationInfo:c.abstractMDIdentification&&c.abstractMDIdentification.value};if(c.boundingBox){var d,f=void 0,m=void 0;if((d=Array.isArray(c.boundingBox)?a().head(c.boundingBox):c.boundingBox)&&d.value){var v,g,E,T,h=null!==(v=null===(g=d.value)||void 0===g?void 0:g.crs)&&void 0!==v?v:"",R=null===(E=h.match(/[\w-]*:[\w-]*:[\w-]*:[\w-]*:[\w-]*:[^:]*:(([\w-]+\s[\w-]+)|[\w-]*)/))||void 0===E?void 0:E[0],b=(0,p.makeNumericEPSG)(null===(T=h.match(/EPSG:[0-9]+/))||void 0===T?void 0:T[0]),O=d.value.lowerCorner,S=d.value.upperCorner,L=b||(0,p.extractCrsFromURN)(R)||a().last(h.split(":"));if(L){if("EPSG:"===L.slice(0,5)){if(!(m=(0,p.makeNumericEPSG)(L)))throw new Error('No suitable EPSG numeric conversion found for "'.concat(L,'"'))}else if(!(m=(0,p.makeNumericEPSG)("EPSG:".concat(L))))throw new Error('No suitable EPSG numeric conversion found for "'.concat(L,'"'))}else m="EPSG:4326";"EPSG:4326"===m&&"CRS84"!==L&&"OGC:CRS84"!==L&&(O=[O[1],O[0]],S=[S[1],S[0]]),f=(0,p.makeBboxFromOWS)(O,S)}u.boundingBox={extent:f,crs:m}}var A=c.dcElement;if(A){for(var I={references:[]},C=0;C<A.length;C++){var _=A[C],w=_.name.localPart,x={};x="references"===w&&_.value?{value:_.value.content&&(0,s.$F)(_.value.content[0])||_.value.content||_.value,scheme:_.value.scheme}:_.value.content&&_.value.content[0]||_.value.content||_.value,I[w]&&Array.isArray(I[w])?I[w].push(x):I[w]?I[w]=[I[w],x]:I[w]=x}u.dc=I}i.push(u)}return o.records=i,o}if(t&&t.name&&"ExceptionReport"===t.name.localPart)return{error:t.value.exception&&t.value.exception.length&&t.value.exception[0].exceptionText||"GenericError"}}return null})))}.bind(null,r)).catch(r.oe)}))},textSearch:function(e,t,n,o){return new Promise((function(a){Promise.all([r.e(9942),r.e(1269)]).then(function(){var i=r(84454).Filter,l=null;if(o){var c=i.propertyIsLike("csw:AnyText","%"+o+"%");l=i.filter(c)}a(f.getRecords(e,t,n,l))}.bind(null,r)).catch(r.oe)}))},workspaceSearch:function(e,t,n,o,a){return new Promise((function(i){Promise.all([r.e(9942),r.e(1269)]).then(function(){var l=r(84454).Filter,c=a||"%",u=o&&"%"+o+"%"||"%",s=l.propertyIsLike("identifier",c+":"+u),p=l.filter(s);i(f.getRecords(e,t,n,p))}.bind(null,r)).catch(r.oe)}))},reset:function(){}};const y=f},3475:(e,t,r)=>{"use strict";r.d(t,{Z:()=>E});var n=r(75875),o=r.n(n),a=r(37275),i=r(8575),l=r(27418),c=r.n(l),u=r(5055),s=r.n(u),p=r(61545),d=r(90183),f=r(7294),y={},m=function(e){var t=i.parse(e,!0);return i.format(c()({},t,{search:null},{query:c()({SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:"GetCapabilities"},t.query)}))},v=function(e,t,r,n,o){for(var a=e.Capabilities.Contents,i=(0,f.getOperations)(e),l=(0,f.getRequestEncoding)(e),u=a.TileMatrixSet&&(0,p.castArray)(a.TileMatrixSet)||[],s=[],y=u.length,m=0;m<y;m++)s.push((0,d.getEPSGCode)(u[m]["ows:SupportedCRS"]));var v=a.Layer,g=(0,p.castArray)(v).filter((function(e){return!n||-1!==e["ows:Identifier"].toLowerCase().indexOf(n.toLowerCase())||e["ows:Title"]&&-1!==e["ows:Title"].toLowerCase().indexOf(n.toLowerCase())}));return{numberOfRecordsMatched:g.length,numberOfRecordsReturned:Math.min(r,g.length),nextRecord:t+Math.min(r,g.length)+1,records:g.filter((function(e,n){return n>=t-1&&n<t-1+r})).map((function(e){return c()({},e,{SRS:s,TileMatrixSet:u,queryable:!!(0,f.getOperation)(i,"GetFeatureInfo","KVP"),requestEncoding:l,style:(0,f.getDefaultStyleIdentifier)(e),format:(0,f.getDefaultFormat)(e),GetTileURL:(0,f.getOperation)(i,"GetTile",l),capabilitiesURL:o})}))}},g={parseUrl:m,getRecords:function(e,t,r,n){var i=y[e];return i&&(new Date).getTime()<i.timestamp+1e3*((0,a.u8)("cacheExpire")||60)?new Promise((function(o){o(v(i.data,t,r,n,e))})):o().get(m(e)).then((function(o){var a;return s().parseString(o.data,{explicitArray:!1},(function(e,t){a=t})),y[e]={timestamp:(new Date).getTime(),data:a},v(a,t,r,n,e)}))},getCapabilities:function(e){var t=y[e];return t&&(new Date).getTime()<t.timestamp+1e3*((0,a.u8)("cacheExpire")||60)?new Promise((function(e){e(t.data)})):o().get(m(e)).then((function(t){var r;return s().parseString(t.data,{explicitArray:!1},(function(e,t){r=t})),y[e]={timestamp:(new Date).getTime(),data:r},r}))},textSearch:function(e,t,r,n){return g.getRecords(e,t,r,n)},reset:function(){Object.keys(y).forEach((function(e){delete y[e]}))}};const E=g},32354:(e,t,r)=>{"use strict";r.d(t,{Z:()=>i});var n=r(61545),o=r(37275),a=function(e,t,r,a){var i=(0,n.get)(o.ZP.getDefaults(),"initialState.defaultState.catalog.default.staticServices.default_map_backgrounds.backgrounds").filter((function(e){return!a||e.title.indexOf(a)>-1})),l=i.filter((function(e,n){return n>=t-1&&n<r+t-1}));return new Promise((function(e){return e({numberOfRecordsMatched:i.length,numberOfRecordsReturned:l.length,records:l,service:{Name:"Background Provider"}})}))};const i={getRecords:a,reset:function(){},textSearch:function(e,t,r,n){return a(0,t,r,n)}}},5570:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>le});var n=r(45697),o=r.n(n),a=r(67294),i=r.n(a),l=r(33664),c=r(22222),u=r(18093),s=r(30294),p=r(80416),d=r(40512),f=r(90825),y=r(1550),m=r(97395),v=r(75110),g=r(71314),E=r(827),T=r(8316),h=r(7147),R=r(7877),b=r(74621),O=r(38842),S=r(24262),L=r(52259),A=r(86638),I=r(5346),C=r(27418),_=r.n(C),w=r(24273),x=r.n(w),D=r(61545),G=r(82904),N=r(57579),P=r(31273),M=r(88113),F=r(93152),U=r(59309),B=r(24819),j=r(42678),Z=r(29180),W=r(51269),k=r(29423),q=r(64152);function Y(e){return(Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(){return(H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function K(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Q(e,t){return(Q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $(e,t){return!t||"object"!==Y(t)&&"function"!=typeof t?X(e):t}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var ee=function e(t,r){return t.reduce((function(t,n){var o=_()({},n);return o.nodes&&(o=_()({},o,{nodes:e(o.nodes,r)})),r.forEach((function(e){o=e.func(o)?_()({},o,e.options):_()({},o)})),t.push(o),t}),[])},te=function(e,t,r){return-1!==(((0,D.isObject)(e.title)?e.title[r]||e.title.default:e.title)||e.name).toLowerCase().indexOf(t.toLowerCase())},re=(0,c.P1)([function(e){return e.controls&&e.controls.toolbar&&"toc"===e.controls.toolbar.active},v.Bt,v.jN,g.yn,v.yj,v.lI,E.Od,T.Pz,T.KV,v.NP,v.wA,v.l2,E.Zs,M.$t,h.PJ,R.us,F.c0,b.np,O.wk],(function(e,t,r,n,o,a,i,l,c,u,s,p,d,f,y,m,v,g,E){return{enabled:e,groups:t,settings:r,swipeSettings:n,layerMetadata:o,layerdownload:a,currentZoomLvl:i&&i.zoom,scales:(0,L.getScales)(i&&i.projection||"EPSG:3857",i&&i.mapOptions&&i.mapOptions.view&&i.mapOptions.view.DPI||null),currentLocale:l,currentLocaleLanguage:c,selectedNodes:u,filterText:s,generalInfoFormat:m,selectedLayers:p.filter((function(e){return(0,D.head)(u.filter((function(t){return t===e.id})))})),noFilterResults:0===p.filter((function(e){return te(e,s,l)})).length,updatableLayersCount:p.filter((function(e){return"background"!==e.group&&("wms"===e.type||"wmts"===e.type)})).length,selectedGroups:u.map((function(e){return(0,S.getNode)(t,e)})).filter((function(e){return e&&e.nodes})),mapName:d,filteredGroups:ee(t,[{options:{showComponent:!0},func:function(){return!s}},{options:{loadingError:!0},func:function(e){return(0,D.head)((e.nodes||[]).filter((function(e){return e.loadingError&&"Warning"!==e.loadingError})))}},{options:{expanded:!0,showComponent:!0},func:function(e){return s&&(0,D.head)((e.nodes||[]).filter((function(t){return te(t,s,l)||t.nodes&&(0,D.head)(e.nodes.filter((function(e){return e.showComponent})))})))}},{options:{showComponent:!1},func:function(e){return(0,D.head)((e.nodes||[]).filter((function(e){return e.hidden||"annotations"===e.id&&v})))&&1===e.nodes.length}},{options:{showComponent:!1},func:function(e){return"annotations"===e.id&&v}}]),catalogActive:f,activateWidgetTool:y,user:g,isLocalizedLayerStylesEnabled:E}})),ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Q(e,t)}(l,e);var t,r,n,o,a=(n=l,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=z(n);if(o){var r=z(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return $(this,e)});function l(){var e;K(this,l);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return J(X(e=a.call.apply(a,[this].concat(r))),"getNoBackgroundLayers",(function(e){return"background"!==e.name})),J(X(e),"getDefaultGroup",(function(){var t=e.props.groupNodeComponent||Z.Z;return i().createElement(t,H({onSort:!e.props.filterText&&e.props.activateSortLayer?e.props.onSort:null},e.props.groupOptions,{titleTooltip:e.props.activateTitleTooltip,propertiesChangeHandler:e.props.groupPropertiesChangeHandler,onToggle:e.props.onToggleGroup,style:e.props.groupStyle,groupVisibilityCheckbox:!0,visibilityCheckType:e.props.visibilityCheckType,currentLocale:e.props.currentLocale,selectedNodes:e.props.selectedNodes,onSelect:e.props.activateToolsContainer?e.props.onSelectNode:null}))})),J(X(e),"getDefaultLayer",(function(){var t=e.props.layerNodeComponent||W.Z,r=(e.props.resolutions||(0,L.getResolutions)())[e.props.currentZoomLvl];return i().createElement(t,H({},e.props.layerOptions,{titleTooltip:e.props.activateTitleTooltip,showFullTitleOnExpand:e.props.showFullTitleOnExpand,onToggle:e.props.onToggleLayer,activateOpacityTool:e.props.activateOpacityTool,onContextMenu:e.props.onContextMenu,propertiesChangeHandler:e.props.layerPropertiesChangeHandler,onSelect:e.props.activateToolsContainer?e.props.onSelectNode:null,visibilityCheckType:e.props.visibilityCheckType,activateLegendTool:e.props.activateLegendTool,currentZoomLvl:e.props.currentZoomLvl,scales:e.props.scales,currentLocale:e.props.currentLocale,selectedNodes:e.props.selectedNodes,filterText:e.props.filterText,onUpdateNode:e.props.updateNode,hideOpacityTooltip:e.props.hideOpacityTooltip,language:e.props.isLocalizedLayerStylesEnabled?e.props.currentLocaleLanguage:null,resolution:r}))})),J(X(e),"renderTOC",(function(){var t=e.getDefaultGroup(),r=e.getDefaultLayer(),n=[e.props.activateToolsContainer,e.props.activateFilterLayer,e.props.activateMapTitle].filter((function(e){return e})),o=n.length>0?" toc-body-sections-"+n.length:" toc-body-sections";return i().createElement("div",null,i().createElement(B.Z,{title:e.props.mapName,showTitle:e.props.activateMapTitle,showFilter:e.props.activateFilterLayer&&(e.props.groups.filter((function(e){return(e.nodes||[]).length}))||[]).length,showTools:e.props.activateToolsContainer,onClear:function(){e.props.onSelectNode()},onFilter:e.props.onFilter,filterTooltipClear:i().createElement(I.Z,{msgId:"toc.clearFilter"}),filterPlaceholder:(0,A.S$)(e.context.messages,"toc.filterPlaceholder"),filterText:e.props.filterText,toolbar:i().createElement(j.Z,{items:e.props.items.filter((function(e){return"toolbar"===e.target})),groups:e.props.groups,selectedLayers:e.props.selectedLayers,selectedGroups:e.props.selectedGroups,generalInfoFormat:e.props.generalInfoFormat,settings:e.props.settings,swipeSettings:e.props.swipeSettings,layerMetadata:e.props.layerMetadata,layerdownload:e.props.layerdownload,metadataTemplate:e.props.metadataTemplate,maxDepth:e.props.maxDepth,activateTool:{activateToolsContainer:e.props.activateToolsContainer,activateRemoveLayer:e.props.activateRemoveLayer,activateRemoveGroup:e.props.activateRemoveGroup,activateZoomTool:e.props.activateZoomTool,activateQueryTool:e.props.activateQueryTool,activateDownloadTool:e.props.activateDownloadTool,activateSettingsTool:e.props.activateSettingsTool,activateAddLayer:e.props.activateAddLayerButton&&!e.props.catalogActive,activateAddGroup:e.props.activateAddGroupButton,includeDeleteButtonInSettings:!1,activateMetedataTool:e.props.activateMetedataTool,activateWidgetTool:e.props.activateWidgetTool,activateLayerFilterTool:e.props.activateLayerFilterTool,activateLayerInfoTool:e.props.updatableLayersCount>0&&e.props.activateLayerInfoTool},options:{modalOptions:{},metadataOptions:e.props.metadataOptions,settingsOptions:e.props.settingsOptions},style:{chartStyle:e.props.chartStyle},text:{settingsText:i().createElement(I.Z,{msgId:"layerProperties.windowTitle"}),opacityText:i().createElement(I.Z,{msgId:"opacity"}),elevationText:i().createElement(I.Z,{msgId:"elevation"}),saveText:i().createElement(I.Z,{msgId:"save"}),closeText:i().createElement(I.Z,{msgId:"close"}),confirmDeleteText:i().createElement(I.Z,{msgId:"layerProperties.deleteLayer"}),confirmDeleteMessage:i().createElement(I.Z,{msgId:"layerProperties.deleteLayerMessage"}),confirmDeleteLayerGroupText:i().createElement(I.Z,{msgId:"layerProperties.deleteLayerGroup"}),confirmDeleteLayerGroupMessage:i().createElement(I.Z,{msgId:"layerProperties.deleteLayerGroupMessage"}),confirmDeleteConfirmText:i().createElement(I.Z,{msgId:"layerProperties.delete"}),confirmDeleteCancelText:i().createElement(I.Z,{msgId:"cancel"}),addLayer:i().createElement(I.Z,{msgId:"toc.addLayer"}),addLayerTooltip:i().createElement(I.Z,{msgId:"toc.addLayer"}),addLayerToGroupTooltip:i().createElement(I.Z,{msgId:"toc.addLayerToGroup"}),addGroupTooltip:i().createElement(I.Z,{msgId:"toc.addGroup"}),addSubGroupTooltip:i().createElement(I.Z,{msgId:"toc.addSubGroup"}),createWidgetTooltip:i().createElement(I.Z,{msgId:"toc.createWidget"}),zoomToTooltip:{LAYER:i().createElement(I.Z,{msgId:"toc.toolZoomToLayerTooltip"}),LAYERS:i().createElement(I.Z,{msgId:"toc.toolZoomToLayersTooltip"})},settingsTooltip:{LAYER:i().createElement(I.Z,{msgId:"toc.toolLayerSettingsTooltip"}),GROUP:i().createElement(I.Z,{msgId:"toc.toolGroupSettingsTooltip"})},featuresGridTooltip:i().createElement(I.Z,{msgId:"toc.toolFeaturesGridTooltip"}),downloadToolTooltip:i().createElement(I.Z,{msgId:"toc.toolDownloadTooltip"}),trashTooltip:{LAYER:i().createElement(I.Z,{msgId:"toc.toolTrashLayerTooltip"}),LAYERS:i().createElement(I.Z,{msgId:"toc.toolTrashLayersTooltip"}),GROUP:i().createElement(I.Z,{msgId:"toc.toolTrashGroupTooltip"})},reloadTooltip:{LAYER:i().createElement(I.Z,{msgId:"toc.toolReloadLayerTooltip"}),LAYERS:i().createElement(I.Z,{msgId:"toc.toolReloadLayersTooltip"})},layerMetadataTooltip:i().createElement(I.Z,{msgId:"toc.layerMetadata.toolLayerMetadataTooltip"}),layerMetadataPanelTitle:i().createElement(I.Z,{msgId:"toc.layerMetadata.layerMetadataPanelTitle"}),layerFilterTooltip:i().createElement(I.Z,{msgId:"toc.layerFilterTooltip"}),layerInfoTooltip:i().createElement(I.Z,{msgId:"toc.layerInfoTooltip"})},onToolsActions:{onZoom:e.props.onZoomToExtent,onNewWidget:e.props.onNewWidget,onBrowseData:e.props.onBrowseData,onQueryBuilder:e.props.onQueryBuilder,onDownload:e.props.onDownload,onUpdate:e.props.updateNode,onRemove:e.props.removeNode,onClear:e.props.onSelectNode,onSettings:e.props.onSettings,onUpdateSettings:e.props.updateSettings,onRetrieveLayerData:e.props.retrieveLayerData,onHideSettings:e.props.hideSettings,onReload:e.props.refreshLayerVersion,onAddLayer:e.props.onAddLayer,onAddGroup:e.props.onAddGroup,onGetMetadataRecord:e.props.onGetMetadataRecord,onHideLayerMetadata:e.props.hideLayerMetadata,onShow:e.props.layerPropertiesChangeHandler,onLayerInfo:e.props.onLayerInfo}})}),i().createElement("div",{className:"mapstore-toc"+o},e.props.noFilterResults&&e.props.filterText?i().createElement("div",null,i().createElement("div",{className:"toc-filter-no-results"},i().createElement(I.Z,{msgId:"toc.noFilteredResults"}))):i().createElement(U.Z,{onError:e.props.onError,onSort:!e.props.filterText&&e.props.activateSortLayer?e.props.onSort:null,filter:e.getNoBackgroundLayers,nodes:e.props.filteredGroups},i().createElement(k.Z,{groupElement:t,layerElement:r}))))})),e}return t=l,(r=[{key:"render",value:function(){return this.props.groups?this.renderTOC():i().createElement("div",null)}}])&&V(t.prototype,r),l}(i().Component);J(ne,"propTypes",{id:o().number,items:o().array,buttonContent:o().node,groups:o().array,settings:o().object,swipeSettings:o().object,layerMetadata:o().object,layerdownload:o().object,metadataTemplate:o().oneOfType([o().string,o().array,o().object,o().func]),refreshMapEnabled:o().bool,groupStyle:o().object,groupPropertiesChangeHandler:o().func,layerPropertiesChangeHandler:o().func,onToggleGroup:o().func,onToggleLayer:o().func,onContextMenu:o().func,onBrowseData:o().func,onQueryBuilder:o().func,onDownload:o().func,onSelectNode:o().func,selectedNodes:o().array,onZoomToExtent:o().func,retrieveLayerData:o().func,onSort:o().func,onSettings:o().func,onRefreshLayer:o().func,onNewWidget:o().func,hideSettings:o().func,updateSettings:o().func,updateNode:o().func,removeNode:o().func,activateTitleTooltip:o().bool,showFullTitleOnExpand:o().bool,activateOpacityTool:o().bool,activateSortLayer:o().bool,activateFilterLayer:o().bool,activateMapTitle:o().bool,activateToolsContainer:o().bool,activateRemoveLayer:o().bool,activateRemoveGroup:o().bool,activateLegendTool:o().bool,activateZoomTool:o().bool,activateQueryTool:o().bool,activateDownloadTool:o().bool,activateSettingsTool:o().bool,activateMetedataTool:o().bool,activateWidgetTool:o().bool,activateLayerInfoTool:o().bool,maxDepth:o().number,visibilityCheckType:o().string,settingsOptions:o().object,chartStyle:o().object,currentZoomLvl:o().number,scales:o().array,layerOptions:o().object,metadataOptions:o().object,spatialOperations:o().array,spatialMethodOptions:o().array,groupOptions:o().object,currentLocale:o().string,currentLocaleLanguage:o().string,onFilter:o().func,filterText:o().string,generalInfoFormat:o().string,selectedLayers:o().array,selectedGroups:o().array,mapName:o().string,filteredGroups:o().array,noFilterResults:o().bool,onAddLayer:o().func,onAddGroup:o().func,onError:o().func,onGetMetadataRecord:o().func,hideLayerMetadata:o().func,activateAddLayerButton:o().bool,activateAddGroupButton:o().bool,activateLayerFilterTool:o().bool,catalogActive:o().bool,refreshLayerVersion:o().func,hideOpacityTooltip:o().bool,layerNodeComponent:o().func,groupNodeComponent:o().func,isLocalizedLayerStylesEnabled:o().bool,onLayerInfo:o().func,onSetSwipeActive:o().func,updatableLayersCount:o().number,onSetSwipeMode:o().func,resolutions:o().func}),J(ne,"contextTypes",{messages:o().object}),J(ne,"defaultProps",{items:[],groupPropertiesChangeHandler:function(){},layerPropertiesChangeHandler:function(){},retrieveLayerData:function(){},onToggleGroup:function(){},onToggleLayer:function(){},onContextMenu:function(){},onToggleQuery:function(){},onZoomToExtent:function(){},onSettings:function(){},onRefreshLayer:function(){},onNewWidget:function(){},updateNode:function(){},removeNode:function(){},onSelectNode:function(){},selectedNodes:[],activateOpacityTool:!0,activateTitleTooltip:!0,showFullTitleOnExpand:!1,activateSortLayer:!0,activateFilterLayer:!0,activateMapTitle:!0,activateToolsContainer:!0,activateLegendTool:!0,activateZoomTool:!0,activateSettingsTool:!0,activateMetedataTool:!0,activateRemoveLayer:!0,activateRemoveGroup:!0,activateQueryTool:!0,activateDownloadTool:!0,activateWidgetTool:!1,activateLayerFilterTool:!1,activateLayerInfoTool:!0,maxDepth:3,visibilityCheckType:"glyph",settingsOptions:{includeCloseButton:!1,closeGlyph:"1-close",buttonSize:"small",showFeatureInfoTab:!0},layerOptions:{},metadataOptions:{},groupOptions:{},spatialOperations:[{id:"INTERSECTS",name:"queryform.spatialfilter.operations.intersects"},{id:"BBOX",name:"queryform.spatialfilter.operations.bbox"},{id:"CONTAINS",name:"queryform.spatialfilter.operations.contains"},{id:"WITHIN",name:"queryform.spatialfilter.operations.within"}],spatialMethodOptions:[{id:"Viewport",name:"queryform.spatialfilter.methods.viewport"},{id:"BBOX",name:"queryform.spatialfilter.methods.box"},{id:"Circle",name:"queryform.spatialfilter.methods.circle"},{id:"Polygon",name:"queryform.spatialfilter.methods.poly"}],currentLocale:"en-US",filterText:"",selectedLayers:[],selectedGroups:[],mapName:"",filteredGroups:[],noFilterResults:!1,onAddLayer:function(){},onAddGroup:function(){},onError:function(){},onGetMetadataRecord:function(){},hideLayerMetadata:function(){},activateAddLayerButton:!1,activateAddGroupButton:!1,catalogActive:!1,refreshLayerVersion:function(){},metadataTemplate:null,onLayerInfo:function(){},onSetSwipeMode:function(){}});var oe=(0,u.withPropsOnChange)(["user","addLayersPermissions","activateAddLayerButton","removeLayersPermissions","activateRemoveLayer","sortingPermission","activateRemoveLayer","addGroupsPermissions","activateAddGroupButton","removeGroupsPermissions","activateRemoveGroup","layerInfoToolPermissions","activateLayerInfoTool"],(function(e){var t=e.addLayersPermissions,r=void 0===t||t,n=e.removeLayersPermissions,o=void 0===n||n,a=e.sortingPermissions,i=void 0===a||a,l=e.addGroupsPermissions,c=void 0===l||l,u=e.removeGroupsPermissions,s=void 0===u||u,p=e.layerInfoToolPermissions,d=void 0!==p&&p,f=e.activateAddLayerButton,y=e.activateRemoveLayer,m=e.activateSortLayer,v=e.activateAddGroupButton,g=e.activateRemoveGroup,E=e.activateLayerInfoTool,T=e.user,h=function(e,t){var r=T&&"ADMIN"===T.role||!1;return!(!e&&!r)&&t};return{activateAddLayerButton:h(r,f),activateRemoveLayer:h(o,y),activateSortLayer:h(i,m),activateAddGroupButton:h(c,v),activateRemoveGroup:h(s,g),activateLayerInfoTool:h(d,E)}})),ae=(0,u.branch)((function(e){var t=e.checkPlugins;return void 0===t||t}),(0,u.withPropsOnChange)(["items","activateAddLayerButton","activateAddGroupButton","activateLayerFilterTool","activateSettingsTool","FeatureEditor","activateLayerInfoTool"],(function(e){var t=e.items,r=void 0===t?[]:t,n=e.activateAddLayerButton,o=void 0===n||n,a=e.activateAddGroupButton,i=void 0===a||a,l=e.activateQueryTool,c=void 0===l||l,u=e.activateSettingsTool,s=void 0===u||u,p=e.activateLayerFilterTool,d=void 0===p||p,f=e.activateWidgetTool,y=void 0===f||f,m=e.activateLayerInfoTool,v=void 0===m||m,g=e.activateDownloadTool,E=void 0===g||g;return{activateAddLayerButton:o&&!!(0,D.find)(r,{name:"MetadataExplorer"})||!1,activateAddGroupButton:i&&!!(0,D.find)(r,{name:"AddGroup"})||!1,activateSettingsTool:s&&!!(0,D.find)(r,{name:"TOCItemsSettings"})||!1,activateQueryTool:c&&!!(0,D.find)(r,{name:"FeatureEditor"})||!1,activateLayerFilterTool:d&&!!(0,D.find)(r,{name:"FilterLayer"})||!1,activateWidgetTool:y&&!!(0,D.find)(r,{name:"WidgetBuilder"})&&!!(0,D.find)(r,{name:"Widgets"}),activateLayerInfoTool:v&&!!(0,D.find)(r,{name:"LayerInfo"})||!1,activateDownloadTool:E&&!!(0,D.find)(r,{name:"LayerDownload"})||!1}}))),ie=(0,l.connect)(re,{groupPropertiesChangeHandler:p.WO,layerPropertiesChangeHandler:p.He,retrieveLayerData:f.k,onToggleGroup:(0,S.toggleByType)("groups",p.bh),onToggleLayer:(0,S.toggleByType)("layers",p.bh),onContextMenu:p.pV,onBrowseData:p.Qr,onQueryBuilder:d.Zq,onDownload:p.LR,onSort:p.Dv,onSettings:p.RP,onZoomToExtent:y.Px,hideSettings:p.sF,updateSettings:p.VP,updateNode:p.tV,removeNode:p.ZF,onSelectNode:p.UG,onFilter:p.F5,onAddLayer:G.pu.bind(null,"metadataexplorer","enabled",!0,"group"),onAddGroup:G.pu.bind(null,"addgroup","enabled",!0,"parent"),onGetMetadataRecord:P.ky,onError:m.vU,hideLayerMetadata:p.Jh,onNewWidget:function(){return(0,N.A4)()},refreshLayerVersion:p.ct,onLayerInfo:G.Xg.bind(null,"layerinfo","enabled",!0,!1)})((0,u.compose)(oe,ae)(ne));const le={TOCPlugin:_()(ie,{Toolbar:{name:"toc",position:7,exclusive:!0,panel:!0,help:i().createElement(I.Z,{msgId:"helptexts.layerSwitcher"}),tooltip:"layers",wrap:!0,title:"layers",icon:i().createElement(s.Glyphicon,{glyph:"1-layer"}),priority:1},DrawerMenu:{name:"toc",position:1,glyph:"1-layer",icon:i().createElement("img",{src:x()}),buttonConfig:{buttonClassName:"square-button no-border",tooltip:"toc.layers"},priority:2}}),reducers:{queryform:r(46905).Z,query:r(97301).Z},epics:r(56175).Z(q.Z)}},71314:(e,t,r)=>{"use strict";r.d(t,{yn:()=>n});var n=function(e){return e.swipe&&e.swipe||{active:!1}}},76712:(e,t,r)=>{"use strict";r.d(t,{n0:()=>R,tW:()=>O,FJ:()=>S,ll:()=>I,eL:()=>C,AD:()=>_});var n=r(27418),o=r.n(n),a=r(61545),i=r(8575),l=r(90183),c=r(37275),u=r(24262),s=r(86638),p=r(7294),d=(r(33044),r(67007));function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){m(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var v=function(e){return e&&e.replace(/\/csw$/,"/")},g=function(e){return(0,a.isObject)(e)&&e._||e},E=function(e,t){return e.filter((function(r){return p.getTileMatrixSet(t,r,e,t,null)}))},T=function(e){var t=Array.isArray(e.references)?e.references:[e.references];return(0,a.head)([].filter.call(t,(function(t){return"WWW:LINK-1.0-http--image-thumbnail"===t.scheme||"thumbnail"===t.scheme||"WWW:DOWNLOAD-1.0-http--download"===t.scheme&&-1!==(t.value||"").indexOf("".concat(e.identifier||"","-thumb"))||"WWW:DOWNLOAD-REST_MAP"===t.scheme&&-1!==(t.value||"").indexOf("".concat(e.identifier||"","-thumb"))})))},h={csw:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e;return n&&n.records?n.records.map((function(e){var n,l,c,u=e.dc;if(u&&u.URI){var p=(0,a.isArray)(u.URI)?u.URI:u.URI&&[u.URI]||[],d=(0,a.head)([].filter.call(p,(function(e){return"thumbnail"===e.name})))||(0,a.head)([].filter.call(p,(function(e){var t;return!e.name&&(null===(t=e.protocol)||void 0===t?void 0:t.indexOf("image/"))>-1})));n=d?d.value:null,l=(0,a.head)([].filter.call(p,(function(e){return e.protocol&&(e.protocol.match(/^OGC:WMS-(.*)-http-get-map/g)||e.protocol.match(/^OGC:WMS/g))})))}if(!l&&u&&u.references&&u.references.length){var f=Array.isArray(u.references)?u.references:[u.references];if(l=(0,a.head)([].filter.call(f,(function(e){return e.scheme&&(e.scheme.match(/^OGC:WMS-(.*)-http-get-map/g)||"OGC:WMS"===e.scheme)})))){var g=i.parse(l.value,!0),E=g.query&&g.query.layers||u.alternative;l=o()({},l,{name:E})}}if(!l&&u&&u.references&&u.references.length){var h=Array.isArray(u.references)?u.references:[u.references];if(c=(0,a.head)([].filter.call(h,(function(e){return e.scheme&&"WWW:DOWNLOAD-REST_MAP"===e.scheme})))){var R=u.alternative;c=o()({},c,{name:R})}}if(!n&&u&&u.references){var b=T(u);b&&(n=b.value)}var O=[];if(u&&u.references&&(Array.isArray(u.references)?u.references:[u.references]).filter((function(e){return e.scheme.indexOf("http-get-capabilities")>-1})).forEach((function(e){var r=0===e.value.indexOf("http")?e.value:(t&&t.catalogURL||"")+"/"+e.value;O.push({type:e.scheme,url:r})})),l&&l.name){0===l.value.indexOf("http")||o()({},l,{value:(t&&t.catalogURL||"")+"/"+l.value});var S={type:l.protocol||l.scheme,url:l.value,SRS:[],params:{name:l.name}};O.push(S)}if(c&&c.name){var L={type:"arcgis",url:c.value,SRS:[],params:{name:c.name}};O.push(L)}n&&(0===n.indexOf("http")||(n=(v(t&&t.url)||"")+n));var A={boundingBox:e.boundingBox&&e.boundingBox.extent&&(0,a.castArray)(e.boundingBox.extent.join(","))};if(u&&(A=y(y({},A),(0,a.sortBy)(Object.keys(u)).reduce((function(e,t){return y(y({},e),{},m({},t,(0,a.uniq)((0,a.castArray)(u[t]))))}),{}))),u&&u.URI&&(0,a.castArray)(u.URI)&&(0,a.castArray)(u.URI).length&&(A=y(y({},A),{},{uri:["<ul>"+(0,a.castArray)(u.URI).map((function(e){return'<li><a target="_blank" href="'.concat(e.value,'">').concat(e.name,"</a></li>")})).join("")+"</ul>"]})),u&&u.subject&&(0,a.castArray)(u.subject)&&(0,a.castArray)(u.subject).length&&(A=y(y({},A),{},{subject:["<ul>"+(0,a.castArray)(u.subject).map((function(e){return"<li>".concat(e,"</li>")})).join("")+"</ul>"]})),O&&(0,a.castArray)(O).length?A=y(y({},A),{},{references:["<ul>"+(0,a.castArray)(O).map((function(e){return'<li><a target="_blank" href="'.concat(e.url,'">').concat(e.params&&e.params.name||e.url,"</a></li>")})).join("")+"</ul>"]}):delete A.references,u&&u.temporal){var I=u.temporal.split("; ");if(I.length){var C=I.filter((function(e){return-1!==e.indexOf("scheme=")})).map((function(e){var t=e.indexOf("=");return e.substr(t+1,e.length-1)}));C=C.length?C[0]:"W3C-DTF";var _=I.filter((function(e){return-1!==e.indexOf("start=")||-1!==e.indexOf("end=")})).map((function(e){var t=e.indexOf("="),n=e.substr(0,t),o=e.substr(t+1,e.length-1),i=e.length-t-1<=10;return(0,a.includes)(["start","end"],n)&&"W3C-DTF"===C&&!i?(0,s.S$)(r,"catalog.".concat(n))+new Date(o).toLocaleString():(0,a.includes)(["start","end"],n)?(0,s.S$)(r,"catalog.".concat(n))+o:""}));A=y(y({},A),{},{temporal:["<ul>"+_.map((function(e){return"<li>".concat(e,"</li>")})).join("")+"</ul>"]})}}return{boundingBox:e.boundingBox,description:u&&(0,a.isString)(u.abstract)&&u.abstract||"",layerOptions:t&&t.layerOptions||{},identifier:u&&(0,a.isString)(u.identifier)&&u.identifier||"",references:O,thumbnail:n,title:u&&(0,a.isString)(u.title)&&u.title||"",tags:u&&u.tags||"",metadata:A}})):null},wms:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e&&e.records?e.records.map((function(r){return{capabilities:r,credits:r.credits,boundingBox:d.ZP.getBBox(r),description:r.Abstract||r.Title||r.Name,identifier:r.Name,service:e.service,tags:"",layerOptions:y(y({},(null==t?void 0:t.layerOptions)||{}),(null==e?void 0:e.layerOptions)||{}),title:(0,u.getLayerTitleTranslations)(r)||r.Name,formats:(0,a.castArray)(r.formats||[]),dimensions:(r.Dimension&&(0,a.castArray)(r.Dimension)||[]).map((function(e){return o()({},{values:e._&&e._.split(",")||[]},e.$||{})})).filter((function(e){return e&&"time"!==e.name})),references:[{type:"OGC:WMS",url:t&&t.url,SRS:r.SRS&&((0,a.isArray)(r.SRS)?r.SRS:[r.SRS])||[],params:{name:r.Name}}]}})):null},wmts:function(e,t){return e&&e.records?e.records.map((function(e){var r=(0,a.castArray)(p.getGetTileURL(e)||t&&t.url);1===r.length&&(r=r[0]);var n=p.getCapabilitiesURL(e),i=(0,a.castArray)(e.TileMatrixSetLink||[]).reduce((function(t,r){var n,i=(0,a.head)((e.TileMatrixSet&&(0,a.castArray)(e.TileMatrixSet)||[]).filter((function(e){return e["ows:Identifier"]===r.TileMatrixSet}))),c=i&&l.default.getEPSGCode(i["ows:SupportedCRS"]),u=r.TileMatrixSetLimits&&(r.TileMatrixSetLimits.TileMatrixLimits||[]).map((function(e){return{identifier:e.TileMatrix,ranges:{cols:{min:e.MinTileCol,max:e.MaxTileCol},rows:{min:e.MinTileRow,max:e.MaxTileRow}}}}))||i.TileMatrix.map((function(e){return{identifier:e["ows:Identifier"]}}));return o()(t,(m(n={},i["ows:Identifier"],u),m(n,c,u),n))}),{}),c=function(e){var t=e["ows:WGS84BoundingBox"];return t||(t={"ows:LowerCorner":"-180.0 -90.0","ows:UpperCorner":"180.0 90.0"}),t}(e);return{title:g(e["ows:Title"]||e["ows:Identifier"]),description:g(e["ows:Abstract"]||e["ows:Title"]||e["ows:Identifier"]),identifier:g(e["ows:Identifier"]),tags:"",layerOptions:t&&t.layerOptions||{},style:e.style,capabilitiesURL:n,queryable:e.queryable,requestEncoding:e.requestEncoding,tileMatrixSet:e.TileMatrixSet,matrixIds:i,format:e.format,TileMatrixSetLink:(0,a.castArray)(e.TileMatrixSetLink),boundingBox:{extent:[c["ows:LowerCorner"].split(" ")[0],c["ows:LowerCorner"].split(" ")[1],c["ows:UpperCorner"].split(" ")[0],c["ows:UpperCorner"].split(" ")[1]],crs:"EPSG:4326"},references:[{type:"OGC:WMTS",url:r,SRS:E(e.SRS||[],i),params:{name:e["ows:Identifier"]}}]}})):null},tms:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e&&e.records){var r=t.service&&"tms"===t.service.provider;return r?e.records.map((function(e){return{title:e.title,tileMapUrl:e.href,description:"".concat(e.srs).concat(e.format?", "+e.format:""),tmsUrl:t.tmsUrl,references:[{type:"OGC:TMS",version:"1.0.0",url:t.url}]}})):e.records.map((function(e){return{title:e.title||e.provider,url:e.url,attribution:e.attribution,options:e.options,provider:e.provider,type:"tileprovider",references:[]}}))}return null},wfs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.records;return t?t.map((function(e){return y(y({},e),{},{references:[{type:"OGC:WFS-1.1.0-http-get-capabilities",url:e.url},{type:"OGC:WFS-1.1.0-http-get-feature",url:e.url}]})})):null},backgrounds:function(e){return e&&e.records?e.records.map((function(e){return{description:e.title,title:e.title,identifier:e.name,thumbnail:e.thumbURL,references:[],background:e}})):null}},R=function(e){return e.filter((function(e){return l.default.isSRSAllowed(e)})).reduce((function(e,t){return o()(e,m({},t,!0))}),{})},b=function(e,t){var r=e.split("?"),n={};return r.length>=2&&r[1]&&r[1].split(/[&;]/g).forEach((function(e){var r=e.split("=");-1===t.indexOf(r[0].toLowerCase())&&(n[r[0]]=r[1])})),{url:r[0],params:n}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.references,r=void 0===t?[]:t;return{wfs:(0,a.head)(r.filter((function(e){return e.type&&("OGC:WFS"===e.type||e.type.indexOf("OGC:WFS")>-1&&e.type.indexOf("http-get-feature")>-1)}))),wms:(0,a.head)(r.filter((function(e){return e.type&&("OGC:WMS"===e.type||e.type.indexOf("OGC:WMS")>-1&&e.type.indexOf("http-get-map")>-1)}))),wmts:(0,a.head)(r.filter((function(e){return e.type&&("OGC:WMTS"===e.type||e.type.indexOf("OGC:WMTS")>-1&&e.type.indexOf("http-get-map")>-1)}))),tms:(0,a.head)(r.filter((function(e){return e.type&&("OGC:TMS"===e.type||e.type.indexOf("OGC:TMS")>-1)})))}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{references:[]};return{esri:(0,a.head)(e.references.filter((function(e){return e.type&&("ESRI:SERVER"===e.type||"arcgis"===e.type)})))}},L=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.references,r=void 0===t?[]:t,n=(0,a.head)(r.filter((function(e){return e.type&&e.type.indexOf("OGC:WMS")>-1&&e.type.indexOf("http-get-capabilities")>-1}))),o=(0,a.head)(r.filter((function(e){return e.type&&e.type.indexOf("OGC:WFS")>-1&&e.type.indexOf("http-get-capabilities")>-1}))),i=(0,a.head)(r.filter((function(e){return e.type&&e.type.indexOf("OGC:WMTS")>-1&&e.type.indexOf("http-get-capabilities")>-1}))),l=[];return n&&l.push({type:"WMS_GET_CAPABILITIES",url:n.url,labelId:"catalog.wmsGetCapLink"}),i&&l.push({type:"WMTS_GET_CAPABILITIES",url:i.url,labelId:"catalog.wmtsGetCapLink"}),o&&l.push({type:"WFS_GET_CAPABILITIES",url:o.url,labelId:"catalog.wfsGetCapLink"}),l},A=function(e){return e&&!(0,a.isArray)(e)&&-1!==e.indexOf(",")?e.split(",").map((function(e){return e.trim()})):e},I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"wms",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=r.removeParams,o=void 0===n?[]:n,i=r.format,l=r.catalogURL,u=r.url,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},p=arguments.length>4?arguments[4]:void 0;if(!e||!e.references)return null;var d,f,m=O(e),v=m.wms,g=m.wmts,E=v||g,T=function(e){return b(c.ZP.cleanDuplicatedQuestionMarks(e),["request","layer","layers","service","version"].concat(o))},h=A(E.url);if(h&&(0,a.isArray)(h))d=h.map((function(e){return T(e)})).map((function(e){return e.url})),f=h.map((function(e){return T(e)})).map((function(e){return e.params})).reduce((function(e,t){return y(y({},e),t)}),{});else{var S=T(h||l),I=S.url,C=S.params;d=I,f=C}var _=function(e){return(0,a.isArray)(e)&&1===e.length?e[0]:e},w=_(u||d),x=R(E.SRS);return y(y(y({type:t,requestEncoding:e.requestEncoding,style:e.style,format:i,url:w,capabilitiesURL:e.capabilitiesURL,queryable:e.queryable,visibility:!0,dimensions:e.dimensions||[],name:E.params&&E.params.name,title:e.title||E.params&&E.params.name,matrixIds:"wmts"===t?e.matrixIds||[]:void 0,description:e.description||"",tileMatrixSet:"wmts"===t?e.tileMatrixSet||[]:void 0,credits:!c.ZP.getConfigProp("noCreditsFromCatalog")&&e.credits,bbox:{crs:e.boundingBox.crs,bounds:{minx:e.boundingBox.extent[0],miny:e.boundingBox.extent[1],maxx:e.boundingBox.extent[2],maxy:e.boundingBox.extent[3]}},links:L(e),params:f,allowedSRS:x,catalogURL:l},s),e.layerOptions),{},{localizedLayerStyles:(0,a.isNil)(p)?void 0:p})},C=function(e,t,r,n){return h[e]&&h[e](t,r,n)||null},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e||!e.references)return null;var r=S(e),n=r.esri;return y({type:n.type,url:n.url,visibility:!0,dimensions:e.dimensions||[],name:n.params&&n.params.name,bbox:{crs:e.boundingBox.crs,bounds:{minx:e.boundingBox.extent[0],miny:e.boundingBox.extent[1],maxx:e.boundingBox.extent[2],maxy:e.boundingBox.extent[3]}}},t)}},93201:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var n=r(61545),o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.split("?")[0].split("@");if(t.length>1){var r=t[t.length-1];if((0,n.includes)(["png","png8","jpeg","vnd.jpeg-png","gif"],r))return r}return null}},11847:(e,t,r)=>{"use strict";r.d(t,{vl:()=>a,K2:()=>i,Nw:()=>l}),r(8575);var n=r(61545),o=r(64210),a=function(e){return o.parse(e)},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/^(http(s{0,1}):\/\/)+?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+$/,r=new RegExp(t);return r.test(e)},l=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:/^(http(s{0,1}):\/\/)+?[\w.\-{}]+(?:\.[\w\.-]+)+[\w\-\._~\/\;\.\%\:\&\=\?{}]+$/,o=new RegExp(r),a=o.test(e);if(!a)return!1;if(a&&!t)return!0;if(a&&t){var i=/\{(.*?)\}/.test(e);return 0===t.filter((function(e){return(0,n.find)(i,e)})).length}return!1}},64210:(e,t,r)=>{"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var l=r(87883),c=r(44020),u=r(74851);function s(e,t){return t.encode?t.strict?l(e):encodeURIComponent(e):e}function p(e,t){return t.decode?c(e):e}function d(e){return Array.isArray(e)?e.sort():"object"===n(e)?d(Object.keys(e)).sort((function(e,t){return Number(e)-Number(t)})).map((function(t){return e[t]})):e}function f(e){var t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function y(e){var t=(e=f(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function m(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function v(e,t){var r=function(e){var t;switch(e.arrayFormat){case"index":return function(e,r,n){t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return function(e,r,n){t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":return function(e,t,r){var n="string"==typeof t&&t.split("").indexOf(",")>-1?t.split(","):t;r[e]=n};default:return function(e,t,r){void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",parseNumbers:!1,parseBooleans:!1},t)),o=Object.create(null);if("string"!=typeof e)return o;if(!(e=e.trim().replace(/^[?#&]/,"")))return o;var i,l,c,s=function(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=a(e))){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,l=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return l=e.done,e},e:function(e){c=!0,i=e},f:function(){try{l||null==r.return||r.return()}finally{if(c)throw i}}}}(e.split("&"));try{for(s.s();!(i=s.n()).done;){var f=i.value,y=(l=u(t.decode?f.replace(/\+/g," "):f,"="),c=2,function(e){if(Array.isArray(e))return e}(l)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){o=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}return r}}(l,c)||a(l,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=y[0],g=y[1];g=void 0===g?null:p(g,t),r(p(v,t),g,o)}}catch(e){s.e(e)}finally{s.f()}for(var E=0,T=Object.keys(o);E<T.length;E++){var h=T[E],R=o[h];if("object"===n(R)&&null!==R)for(var b=0,O=Object.keys(R);b<O.length;b++){var S=O[b];R[S]=m(R[S],t)}else o[h]=m(R,t)}return!1===t.sort?o:(!0===t.sort?Object.keys(o).sort():Object.keys(o).sort(t.sort)).reduce((function(e,t){var r=o[t];return Boolean(r)&&"object"===n(r)&&!Array.isArray(r)?e[t]=d(r):e[t]=r,e}),Object.create(null))}t.extract=y,t.parse=v,t.stringify=function(e,t){if(!e)return"";var r=function(e){switch(e.arrayFormat){case"index":return function(t){return function(r,n){var a=r.length;return void 0===n||e.skipNull&&null===n?r:[].concat(o(r),null===n?[[s(t,e),"[",a,"]"].join("")]:[[s(t,e),"[",s(a,e),"]=",s(n,e)].join("")])}};case"bracket":return function(t){return function(r,n){return void 0===n||e.skipNull&&null===n?r:[].concat(o(r),null===n?[[s(t,e),"[]"].join("")]:[[s(t,e),"[]=",s(n,e)].join("")])}};case"comma":return function(t){return function(r,n){return null==n||0===n.length?r:0===r.length?[[s(t,e),"=",s(n,e)].join("")]:[[r,s(n,e)].join(",")]}};default:return function(t){return function(r,n){return void 0===n||e.skipNull&&null===n?r:[].concat(o(r),null===n?[s(t,e)]:[[s(t,e),"=",s(n,e)].join("")])}}}}(t=Object.assign({encode:!0,strict:!0,arrayFormat:"none"},t)),n=Object.assign({},e);if(t.skipNull)for(var a=0,i=Object.keys(n);a<i.length;a++){var l=i[a];void 0!==n[l]&&null!==n[l]||delete n[l]}var c=Object.keys(n);return!1!==t.sort&&c.sort(t.sort),c.map((function(n){var o=e[n];return void 0===o?"":null===o?s(n,t):Array.isArray(o)?o.reduce(r(n),[]).join("&"):s(n,t)+"="+s(o,t)})).filter((function(e){return e.length>0})).join("&")},t.parseUrl=function(e,t){return{url:f(e).split("?")[0]||"",query:v(y(e),t)}}},87883:e=>{"use strict";e.exports=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,(function(e){return"%".concat(e.charCodeAt(0).toString(16).toUpperCase())}))}},74851:e=>{"use strict";e.exports=function(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];var r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},44020:e=>{"use strict";var t="%[a-f0-9]{2}",r=new RegExp(t,"gi"),n=new RegExp("("+t+")+","gi");function o(e,t){try{return decodeURIComponent(e.join(""))}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],o(r),o(n))}function a(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(r),n=1;n<t.length;n++)t=(e=o(t,n).join("")).match(r);return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=n.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var o=a(r[0]);o!==r[0]&&(t[r[0]]=o)}r=n.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),l=0;l<i.length;l++){var c=i[l];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}}}]);