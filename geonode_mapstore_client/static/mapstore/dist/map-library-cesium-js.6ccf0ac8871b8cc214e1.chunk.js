(window.webpackJsonp=window.webpackJsonp||[]).push([["map-library-cesium-js"],{"./MapStore2/web/client/components/map/cesium/Layer.jsx":function(e,t,r){"use strict";r.r(t);var n=r("./MapStore2/node_modules/react/index.js"),o=r.n(n),i=r("./MapStore2/web/client/utils/cesium/Layers.js"),a=r.n(i),c=r("./MapStore2/node_modules/object-assign/index.js"),u=r.n(c),s=r("./MapStore2/node_modules/prop-types/index.js"),l=r.n(s);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?f(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=v(e);if(t){var o=v(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return b(this,r)}}function b(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(c,e);var t,r,n,i=O(c);function c(){var e;g(this,c);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return S(h(e=i.call.apply(i,[this].concat(r))),"updateZIndex",(function(t){var r=t||e.props.position,n=e.props.map.imageryLayers._layers.reduce((function(t,r,n){return e.provider===r?n:t}),-1),o=e.props.map.imageryLayers._layers.reduce((function(e,t,n){return-1===e&&r<t._position?n:e}),-1);-1===o&&(o=n);var i=o-n;0!==i&&Array.apply(null,{length:Math.abs(i)}).map(Number.call,Number).forEach((function(){e.props.map.imageryLayers[i>0?"raise":"lower"](e.provider)}))})),S(h(e),"setLayerVisibility",(function(t,r){t!==(e.props.options&&!1!==e.props.options.visibility)&&(t?(e.addLayer(r),e.updateZIndex()):e.removeLayer())})),S(h(e),"setLayerOpacity",(function(t){t!==(e.props.options&&void 0!==e.props.options.opacity?e.props.options.opacity:1)&&e.layer&&e.provider&&(e.provider.alpha=t)})),S(h(e),"createLayer",(function(t,r,n,o,i){if(t){var c=u()({},r,n?{zIndex:n}:null,{securityToken:i});e.layer=a.a.createLayer(t,c,o),e.layer&&(e.layer.layerName=r.name,e.layer.layerId=r.id),null===e.layer&&e.props.onCreationError(r)}})),S(h(e),"updateLayer",(function(t,r){var n=a.a.updateLayer(t.type,e.layer,d(d({},t.options),{},{securityToken:t.securityToken}),d(d({},r.options),{},{securityToken:r.securityToken}),e.props.map);n&&(e.removeLayer(),e.layer=n,e.addLayer(t))})),S(h(e),"addLayerInternal",(function(t){t.options.useForElevation?e.props.map.terrainProvider=e.layer:(e.provider=e.props.map.imageryLayers.addImageryProvider(e.layer),e.provider._position=e.props.position,void 0!==t.options.opacity&&(e.provider.alpha=t.options.opacity))})),S(h(e),"addLayer",(function(t){if(e.layer&&!e.layer.detached&&(e.addLayerInternal(t),e.props.options.refresh&&e.layer.updateParams)){var r=0;e.refreshTimer=setInterval((function(){var n=e.layer.updateParams(u()({},e.props.options.params,{_refreshCounter:r++}));e.removeLayer(),e.layer=n,e.addLayerInternal(t)}),e.props.options.refresh)}})),S(h(e),"removeLayer",(function(t){var r=t||e.provider;r&&e.props.map.imageryLayers.remove(r)})),e}return t=c,(r=[{key:"componentDidMount",value:function(){this.createLayer(this.props.type,this.props.options,this.props.position,this.props.map,this.props.securityToken),this.props.options&&this.layer&&!1!==this.props.options.visibility&&(this.addLayer(this.props),this.updateZIndex())}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this,r=e.options&&!1!==e.options.visibility;this.setLayerVisibility(r,e);var n=e.options&&void 0!==e.options.opacity?e.options.opacity:1;if(this.setLayerOpacity(n),e.position!==this.props.position&&(this.updateZIndex(e.position),this.provider&&(this.provider._position=e.position)),this.props.options&&this.props.options.params&&this.layer.updateParams&&e.options.visibility&&Object.keys(this.props.options.params).reduce((function(r,n){return e.options.params[n]!==t.props.options.params[n]||r}),!1)){var o=this.provider,i=this.layer.updateParams(e.options.params);this.layer=i,this.addLayer(e),setTimeout((function(){t.removeLayer(o)}),1e3)}this.updateLayer(e,this.props)}},{key:"componentWillUnmount",value:function(){this.layer&&this.props.map&&!this.props.map.isDestroyed()&&(this.layer.detached?this.layer.remove():(this.layer.destroy&&this.layer.destroy(),this.props.map.imageryLayers.remove(this.provider)),this.refreshTimer&&clearInterval(this.refreshTimer))}},{key:"render",value:function(){var e=this;if(this.props.children){var t=this.layer,r=t?o.a.Children.map(this.props.children,(function(r){return r?o.a.cloneElement(r,{container:t,styleName:e.props.options&&e.props.options.styleName}):null})):null;return o.a.createElement(o.a.Fragment,null,r)}return a.a.renderLayer(this.props.type,this.props.options,this.props.map,this.props.map.id,this.layer)}}])&&m(t.prototype,r),n&&m(t,n),c}(o.a.Component);S(j,"propTypes",{map:l.a.object,type:l.a.string,options:l.a.object,onCreationError:l.a.func,position:l.a.number,securityToken:l.a.string}),t.default=j},"./MapStore2/web/client/components/map/cesium/Map.jsx":function(e,t,r){"use strict";r.r(t);var n=r("./MapStore2/web/client/libs/cesium.js"),o=r.n(n),i=r("./MapStore2/node_modules/prop-types/index.js"),a=r.n(i),c=r("./MapStore2/node_modules/rxjs/Rx.js"),u=r.n(c),s=r("./MapStore2/node_modules/react/index.js"),l=r.n(s),p=r("./MapStore2/node_modules/react-dom/index.js"),f=r.n(p),d=r("./MapStore2/web/client/utils/ConfigUtils.js"),g=r("./MapStore2/web/client/utils/cesium/ClickUtils.js"),m=r.n(g),y=r("./MapStore2/web/client/utils/MapUtils.js"),O=r("./MapStore2/web/client/utils/CoordinatesUtils.js"),b=r("./MapStore2/node_modules/object-assign/index.js"),h=r.n(b),v=r("./MapStore2/node_modules/lodash/lodash.js");function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=L(e);if(t){var o=L(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return F(this,r)}}function F(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?T(e):t}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(a,e);var t,r,n,i=P(a);function a(){var e;w(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return C(T(e=i.call.apply(i,[this].concat(r))),"state",{}),C(T(e),"onClick",(function(t,r){if(e.props.onClick&&null!==r.position){var n=t.camera.pickEllipsoid(r.position,t.scene.globe.ellipsoid),i=m.a.getMouseXYZ(t,r)||n&&o.a.Cartographic.fromCartesian(n);if(i){var a=180*i.latitude/Math.PI,c=180*i.longitude/Math.PI,u=(90-a)/180*e.props.standardHeight*(e.props.zoom+1),s=(180+c)/360*e.props.standardWidth*(e.props.zoom+1);e.props.onClick({pixel:{x:s,y:u},height:e.props.mapOptions&&e.props.mapOptions.terrainProvider?i.height:void 0,cartographic:i,latlng:{lat:a,lng:c},crs:"EPSG:4326"})}}})),C(T(e),"onMouseMove",(function(t){if(e.props.onMouseMove&&t.endPosition){var r=e.map.camera.pickEllipsoid(t.endPosition,e.map.scene.globe.ellipsoid),n=m.a.getMouseXYZ(e.map,t)||r&&o.a.Cartographic.fromCartesian(r);if(n){var i=Math.round(n.height);e.props.onMouseMove({y:180*n.latitude/Math.PI,x:180*n.longitude/Math.PI,z:i,crs:"EPSG:4326"})}}})),C(T(e),"getDocument",(function(){return e.props.document||document})),C(T(e),"getMapOptions",(function(e){var t={};if(e.terrainProvider){var r=e.terrainProvider,n=r.type,i=j(r,["type"]);switch(n){case"cesium":t.terrainProvider=new o.a.CesiumTerrainProvider(i);break;case"ellipsoid":t.terrainProvider=new o.a.EllipsoidTerrainProvider}}return h()({},e,t)})),C(T(e),"getCenter",(function(){var t=e.map.camera.positionCartographic;return{longitude:180*t.longitude/Math.PI,latitude:180*t.latitude/Math.PI,height:t.height}})),C(T(e),"getZoomFromHeight",(function(t){return Math.log2(e.props.zoomToHeight/t)+1})),C(T(e),"getHeightFromZoom",(function(t){return e.props.zoomToHeight/Math.pow(2,t-1)})),C(T(e),"gestureStartListener",(function(e){e.preventDefault()})),C(T(e),"setMousePointer",(function(t){e.map&&(f.a.findDOMNode(T(e)).getElementsByClassName("cesium-viewer")[0].style.cursor=t||"auto")})),C(T(e),"_updateMapPositionFromNewProps",(function(t){var r=e.getCenter(),n=e.getZoomFromHeight(r.height),i=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)<=1e-12},a=!i(t.center.x,r.longitude)||!i(t.center.y,r.latitude),c=t.zoom!==n;if(a||c){var u={destination:o.a.Cartesian3.fromDegrees(t.center.x,t.center.y,e.getHeightFromZoom(t.zoom)),orientation:t.viewerOptions.orientation};e.setView(u)}})),C(T(e),"setView",(function(t){e.props.mapOptions&&e.props.mapOptions.flyTo?e.map.camera.flyTo(t,e.props.mapOptions.defaultFlightOptions):e.map.camera.setView(t)})),C(T(e),"subscribeClickEvent",(function(t){var r={LEFT_UP:o.a.ScreenSpaceEventType.LEFT_UP,LEFT_DOWN:o.a.ScreenSpaceEventType.LEFT_DOWN,LEFT_CLICK:o.a.ScreenSpaceEventType.LEFT_CLICK,PINCH_START:o.a.ScreenSpaceEventType.PINCH_START,PINCH_END:o.a.ScreenSpaceEventType.PINCH_END,PINCH_MOVE:o.a.ScreenSpaceEventType.PINCH_MOVE},n=new u.a.Subject,i=new u.a.Subject;Object.keys(r).forEach((function(t){return e.hand.setInputAction((function(e){i.next({type:r[t],movement:e}),n.next({type:r[t],movement:e})}),r[t])})),i.filter((function(e){return e.type===r.PINCH_END})).switchMap((function(){return u.a.Observable.of(!0).concat(u.a.Observable.of(!1).delay(500))})).startWith(!1).switchMap((function(e){return e?u.a.Observable.never():n})).filter((function(e){return e.type===r.LEFT_DOWN})).switchMap((function(e){var t=e.movement;return n.filter((function(e){return e.type===r.LEFT_CLICK})).takeUntil(u.a.Observable.timer(500).merge(n.filter((function(e){return e.type!==r.LEFT_UP&&e.type!==r.LEFT_CLICK||e.type===r.LEFT_UP&&(n=t&&t.position,o=e.movement&&e.movement.position,!(n&&o&&n.x===o.x&&n.y===o.y));var n,o}))))})).subscribe((function(r){var n=r.movement;return e.onClick(t,n)})),e.clickStream$=n,e.pauserStream$=i})),C(T(e),"registerHooks",(function(){e.props.hookRegister.registerHook(y.GET_PIXEL_FROM_COORDINATES_HOOK),e.props.hookRegister.registerHook(y.GET_COORDINATES_FROM_PIXEL_HOOK),e.props.hookRegister.registerHook(y.ZOOM_TO_EXTENT_HOOK,(function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.crs,i=r.duration,a=Object(O.reprojectBbox)(t,n,"EPSG:4326");if(e.map.camera.flyTo){var c=o.a.Rectangle.fromDegrees(a[0],a[1],a[2],a[3]);e.map.camera.flyTo({destination:c,duration:i,complete:e.updateMapInfoState})}}))})),C(T(e),"updateMapInfoState",(function(){var t=e.getCenter(),r=e.getZoomFromHeight(t.height),n={height:Math.round(e.props.standardWidth*(r+1)),width:Math.round(e.props.standardHeight*(r+1))};e.props.onMapViewChanges({x:t.longitude,y:t.latitude,crs:"EPSG:4326"},r,{bounds:{minx:-180,miny:-90,maxx:180,maxy:90},crs:"EPSG:4326",rotation:0},n,e.props.id,e.props.projection,{orientation:{heading:e.map.camera.heading,pitch:e.map.camera.pitch,roll:e.map.camera.roll}})})),e}return t=a,(r=[{key:"UNSAFE_componentWillMount",value:function(){this.getDocument().addEventListener("gesturestart",this.gestureStartListener)}},{key:"componentDidMount",value:function(){var e=new o.a.Viewer(this.getDocument().getElementById(this.props.id),h()({baseLayerPicker:!1,animation:!1,fullscreenButton:!1,geocoder:!1,homeButton:!1,infoBox:!1,sceneModePicker:!1,selectionIndicator:!1,timeline:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1},this.getMapOptions(this.props.mapOptions)));e.scene.globe.baseColor=o.a.Color.WHITE,e.imageryLayers.removeAll(),e.camera.moveEnd.addEventListener(this.updateMapInfoState),this.hand=new o.a.ScreenSpaceEventHandler(e.scene.canvas),this.subscribeClickEvent(e),this.hand.setInputAction(Object(v.throttle)(this.onMouseMove.bind(this),500),o.a.ScreenSpaceEventType.MOUSE_MOVE),e.camera.setView({destination:o.a.Cartesian3.fromDegrees(this.props.center.x,this.props.center.y,this.getHeightFromZoom(this.props.zoom))}),this.setMousePointer(this.props.mousePointer),this.map=e,this.forceUpdate(),this.props.mapOptions.navigationTools&&(this.cesiumNavigation=window.CesiumNavigation,this.cesiumNavigation&&this.cesiumNavigation.navigationInitialization(this.props.id,e)),this.props.registerHooks&&this.registerHooks()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){return e.mousePointer!==this.props.mousePointer&&this.setMousePointer(e.mousePointer),e.mapStateSource!==this.props.id&&this._updateMapPositionFromNewProps(e),!1}},{key:"componentWillUnmount",value:function(){this.clickStream$.complete(),this.pauserStream$.complete(),this.hand.destroy(),this.getDocument().removeEventListener("gesturestart",this.gestureStartListener),this.map.destroy()}},{key:"render",value:function(){var e=this,t=this.map,r=this.props.projection,n=t?l.a.Children.map(this.props.children,(function(n){return n?l.a.cloneElement(n,{map:t,projection:r,onCreationError:e.props.onCreationError}):null})):null;return l.a.createElement("div",{id:this.props.id},n)}}])&&E(t.prototype,r),n&&E(t,n),a}(l.a.Component);C(N,"propTypes",{id:a.a.string,document:a.a.object,center:d.default.PropTypes.center,zoom:a.a.number.isRequired,mapStateSource:d.default.PropTypes.mapStateSource,projection:a.a.string,onMapViewChanges:a.a.func,onCreationError:a.a.func,onClick:a.a.func,onMouseMove:a.a.func,mapOptions:a.a.object,standardWidth:a.a.number,standardHeight:a.a.number,mousePointer:a.a.string,zoomToHeight:a.a.number,registerHooks:a.a.bool,hookRegister:a.a.object,viewerOptions:a.a.object}),C(N,"defaultProps",{id:"map",onMapViewChanges:function(){},onClick:function(){},onCreationError:function(){},projection:"EPSG:3857",mapOptions:{},standardWidth:512,standardHeight:512,zoomToHeight:8e7,registerHooks:!0,hookRegister:{registerHook:y.registerHook},viewerOptions:{orientation:{heading:0,pitch:-1*Math.PI/2,roll:0}}}),t.default=N},"./MapStore2/web/client/components/map/plugins/cesium.js":function(e,t,r){"use strict";r.r(t);var n=r("./MapStore2/node_modules/recompose/es/Recompose.js").createSink;t.default=function(){return r("./MapStore2/web/client/components/map/cesium/plugins/index.js"),{Map:r("./MapStore2/web/client/components/map/cesium/Map.jsx").default,Layer:r("./MapStore2/web/client/components/map/cesium/Layer.jsx").default,Feature:n((function(){}))}}},"./MapStore2/web/client/utils/CoordinatesUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"FORMULAS",(function(){return N})),r.d(t,"getProjUrl",(function(){return I})),r.d(t,"determineCrs",(function(){return A})),r.d(t,"normalizePoint",(function(){return _})),r.d(t,"reproject",(function(){return D})),r.d(t,"reprojectExtent",(function(){return U})),r.d(t,"getPolygonFromExtent",(function(){return H})),r.d(t,"getExtentFromNormalized",(function(){return V})),r.d(t,"crsCodeTable",(function(){return q})),r.d(t,"setCrsLabels",(function(){return W})),r.d(t,"getUnits",(function(){return z})),r.d(t,"getProjectedBBox",(function(){return K})),r.d(t,"createBBox",(function(){return X})),r.d(t,"reprojectGeoJson",(function(){return Q})),r.d(t,"lineIntersectPolygon",(function(){return Z})),r.d(t,"normalizeLng",(function(){return $})),r.d(t,"reprojectBbox",(function(){return Y})),r.d(t,"bboxToFeatureGeometry",(function(){return J})),r.d(t,"getCompatibleSRS",(function(){return ee})),r.d(t,"getEquivalentSRS",(function(){return te})),r.d(t,"getEPSGCode",(function(){return re})),r.d(t,"normalizeSRS",(function(){return ne})),r.d(t,"isAllowedSRS",(function(){return oe})),r.d(t,"getAvailableCRS",(function(){return ie})),r.d(t,"filterCRSList",(function(){return ae})),r.d(t,"calculateAzimuth",(function(){return ce})),r.d(t,"calculateDistance",(function(){return ue})),r.d(t,"extendExtent",(function(){return se})),r.d(t,"getGeoJSONExtent",(function(){return le})),r.d(t,"isValidExtent",(function(){return pe})),r.d(t,"calculateCircleCoordinates",(function(){return fe})),r.d(t,"transformLineToArcs",(function(){return de})),r.d(t,"transformArcsToLine",(function(){return ge})),r.d(t,"coordsOLtoLeaflet",(function(){return me})),r.d(t,"mergeToPolyGeom",(function(){return ye})),r.d(t,"getViewportGeometry",(function(){return Oe})),r.d(t,"getExtentFromViewport",(function(){return be})),r.d(t,"fetchProjRemotely",(function(){return he})),r.d(t,"parseURN",(function(){return ve})),r.d(t,"parseString",(function(){return Se})),r.d(t,"getWMSBoundingBox",(function(){return je})),r.d(t,"isSRSAllowed",(function(){return we})),r.d(t,"getNormalizedLatLon",(function(){return Ee})),r.d(t,"isInsideVisibleArea",(function(){return xe})),r.d(t,"centerToVisibleArea",(function(){return Pe})),r.d(t,"calculateCircleRadiusFromPixel",(function(){return Fe})),r.d(t,"roundCoord",(function(){return Te})),r.d(t,"midpoint",(function(){return Le})),r.d(t,"pointObjectToArray",(function(){return Ce})),r.d(t,"isPointInsideExtent",(function(){return Ne})),r.d(t,"isBboxCompatible",(function(){return Me})),r.d(t,"extractCrsFromURN",(function(){return Ie})),r.d(t,"makeNumericEPSG",(function(){return Ge})),r.d(t,"makeBboxFromOWS",(function(){return Ae}));var n=r("./MapStore2/node_modules/node-geo-distance/index.js"),o=r.n(n),i=r("./MapStore2/web/client/libs/proj4.js"),a=r.n(i),c=r("./MapStore2/web/client/libs/ajax.js"),u=r.n(c),s=r("./MapStore2/node_modules/object-assign/index.js"),l=r.n(s),p=r("./MapStore2/node_modules/lodash/lodash.js"),f=r("./MapStore2/node_modules/@turf/line-intersect/index.js"),d=r.n(f),g=r("./MapStore2/node_modules/@turf/polygon-to-linestring/index.js"),m=r.n(g),y=r("./MapStore2/node_modules/@turf/great-circle/main.es.js"),O=r("./MapStore2/node_modules/turf-point/index.js"),b=r.n(O),h=r("./MapStore2/node_modules/@turf/bbox-polygon/main.es.js"),v=r("./MapStore2/node_modules/@turf/boolean-overlap/main.es.js"),S=r("./MapStore2/node_modules/@turf/boolean-contains/main.es.js");function j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function w(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?j(Object(r),!0).forEach((function(t){E(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function E(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x(e){return function(e){if(Array.isArray(e))return T(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||F(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,o=!1,i=void 0;try{for(var a,c=e[Symbol.iterator]();!(n=(a=c.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}return r}(e,t)||F(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function F(e,t){if(e){if("string"==typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?T(e,t):void 0}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L,C=a.a,N={vincenty:function(e){for(var t=0,r=0;r<e.length-1;++r){var n=e[r],i=e[r+1],a=P(n,2),c=a[0],u=a[1],s=P(i,2),l=s[0],p=s[1];t+=parseFloat(o.a.vincentySync({longitude:c,latitude:u},{longitude:l,latitude:p}))}return t},haversine:function(e){for(var t=0,r=0;r<e.length-1;++r){var n=e[r],i=e[r+1],a=P(n,2),c=a[0],u=a[1],s=P(i,2),l=s[0],p=s[1];t+=parseFloat(o.a.haversineSync({longitude:c,latitude:u},{longitude:l,latitude:p}))}return t}};function M(e,t){return(r=e).length>=2&&"number"==typeof r[0]&&"number"==typeof r[1]?t(e):e.map((function(e){return M(e,t)}));var r}var I=function(e){return"http://spatialreference.org/ref/epsg/".concat(e,"/proj4/")};function G(e,t,r){if(null===e)return e;var n=Object(p.cloneDeep)(e);return"Feature"===e.type?n.geometry=G(e.geometry,t,r):"FeatureCollection"===e.type?n.features=n.features.map((function(e){return G(e,t,r)})):"GeometryCollection"===e.type?n.geometries=n.geometries.map((function(e){return G(e,t,r)})):t&&t(n),r&&r(n),n}function A(e){return"string"==typeof e||e instanceof String?a.a.defs(e)?new a.a.Proj(e):null:e}var R={"EPSG:4326":"WGS 84","EPSG:3857":"EPSG:3857"},_=function(e){return{x:e.x||0,y:e.y||0,srs:e.srs||e.crs||"EPSG:4326",crs:e.srs||e.crs||"EPSG:4326"}},k=function(e){var t=e;return Object(p.isNumber)(e.x)||(t.x=parseFloat(e.x)),Object(p.isNumber)(e.y)||(t.y=parseFloat(e.y)),t},D=function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=t&&a.a.defs(t)?new a.a.Proj(t):null,i=r&&a.a.defs(r)?new a.a.Proj(r):null;if(o&&i){var c=Object(p.isArray)(e)?a.a.toPoint(e):a.a.toPoint([e.x,e.y]),u=l()({},t===r?k(c):a.a.transform(o,i,k(c)),{srs:r});return n?_(u):u}return null},B=["EPSG:900913","EPSG:4326","EPSG:3857"],U=function(e,t,r){return"EPSG:4326"===t?e:r?e.map((function(e){return[D([e[0],e[1]],"EPSG:4326",t),D([e[2],e[3]],"EPSG:4326",t)].reduce((function(e,t){return[].concat(x(e),[t.x,t.y])}),[])})):[D([e[0],e[1]],"EPSG:4326",t),D([e[2],e[3]],"EPSG:4326",t)].reduce((function(e,t){return[].concat(x(e),[t.x,t.y])}),[])},H=function(e){return e?e.hasOwnProperty("geometry")&&"Polygon"===e.geometry.type?e:Object(h.a)(e):null},V=function(e,t){var r=function(e,t){var r="EPSG:4326"!==t?[D([parseFloat(e.minx),parseFloat(e.miny)],t,"EPSG:4326"),D([parseFloat(e.maxx),parseFloat(e.maxy)],t,"EPSG:4326")].reduce((function(e,t){return[].concat(x(e),[t.x,t.y])}),[]):[parseFloat(e.minx),parseFloat(e.miny),parseFloat(e.maxx),parseFloat(e.maxy)],n=!1;return"EPSG:4326"===t?n=Math.abs(e.maxx-e.minx)>=360:"EPSG:900913"!==t&&"EPSG:3857"!==t||(n=Math.abs(e.maxx-e.minx)>=40075016.68557849),n?[0,r[1],360,r[3]]:[(r[0]+180)%360,r[1],(r[2]+180)%360,r[3]].map((function(e,t){return t%2==0&&e<0?360+e:e}))}(e,t),n=r[2]<r[0];return n?{extent:U([[-180,r[1],r[2]-180,r[3]],[r[0]-180,r[1],180,r[3]]],t,n),isIDL:n}:{extent:U([r[0]-180,r[1],r[2]-180,r[3]],t,n),isIDL:n}},q={wgs84:4326,wgs1984:4326,crs84:4326,ogccrs84:4326,lambert93:2154,rgflambert93:2154},W=function(e){R=l()({},R,e)},z=function(e){return new a.a.Proj(e).units||"degrees"},K=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,o=t*n[0]/2,i=t*n[1]/2,a=Math.cos(r),c=Math.sin(r),u=o*a,s=o*c,l=i*a,p=i*c,f=e.x,d=e.y,g=f-u+p,m=f-u-p,y=f+u-p,O=f+u+p,b=d-s-l,h=d-s+l,v=d+s+l,S=d+s-l,j=L.createBBox(Math.min(g,m,y,O),Math.min(b,h,v,S),Math.max(g,m,y,O),Math.max(b,h,v,S));return j},X=function(e,t,r,n){return{minx:e,miny:t,maxx:r,maxy:n}},Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EPSG:4326",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"EPSG:4326",n=t,o=r;"string"==typeof n&&(n=A(n)),"string"==typeof o&&(o=A(o));var i=C(n,o);return G(e,(function(e){e.crs&&delete e.crs,e.coordinates=M(e.coordinates,(function(e){var t=P(e,2),r=t[0],n=t[1];return i.forward([r,n])}))}),(function(e){var t,r;e.bbox&&(e.bbox=(t=[Number.MAX_VALUE,Number.MAX_VALUE],r=[-Number.MAX_VALUE,-Number.MAX_VALUE],G(e,(function(e){M(e.coordinates,(function(e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),r[0]=Math.max(r[0],e[0]),r[1]=Math.max(r[1],e[1])}))})),[t[0],t[1],r[0],r[1]]))}))},Z=function(e,t){var r=m()(t).features[0];return 0!==d()(e,r).features.length},$=function(e){var t=e/360%1*360;return t<-180?t+=360:t>180&&(t-=360),t},Y=function(e,t,r){var n,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];n=Object(p.isArray)(e)?{sw:[e[0],e[1]],ne:[e[2],e[3]]}:{sw:[e.minx,e.miny],ne:[e.maxx,e.maxy]};var i=[];for(var a in n)if(n.hasOwnProperty(a)){var c=L.reproject(n[a],t,r,o);if(!c)return null;var u=c.x,s=c.y;i.push(u),i.push(s)}return i},J=function(e){var t=Object(p.isArray)(e)?{minx:e[0],miny:e[1],maxx:e[2],maxy:e[3]}:e,r=t.minx,n=t.miny,o=t.maxx,i=t.maxy;return{type:"Polygon",coordinates:[[[r,n],[r,i],[o,i],[o,n],[r,n]]]}},ee=function(e,t){return"EPSG:900913"===e&&!t["EPSG:900913"]&&t["EPSG:3857"]?"EPSG:3857":"EPSG:3857"===e&&!t["EPSG:3857"]&&t["EPSG:900913"]?"EPSG:900913":e},te=function(e){return"EPSG:900913"===e||"EPSG:3857"===e?["EPSG:3857","EPSG:900913"]:[e]},re=function(e){return-1!==e.indexOf(":")?"EPSG:"+e.substring(e.lastIndexOf(":")+1):e},ne=function(e,t){var r="EPSG:900913"===e?"EPSG:3857":e;return t&&!t[r]?L.getCompatibleSRS(r,t):r},oe=function(e,t){return t[L.getCompatibleSRS(e,t)]},ie=function(){var e={};for(var t in a.a.defs)a.a.defs.hasOwnProperty(t)&&(e[t]={label:R[t]||t});return e},ae=function(e,t,r,n){var o=Object.keys(e).reduce((function(r,n){return l()({},-1===t.indexOf(n)?r:w(w({},r),{},E({},n,e[n])))}),{}),i=n.map((function(e){return e.code})),a=Object.keys(r).reduce((function(e,t){return l()({},-1===i.indexOf(t)?e:w(w({},e),{},E({},t,r[t])))}),{});return l()({},o,a)},ce=function(e,t,r){var n=L.reproject(e,r,"EPSG:4326"),o=L.reproject(t,r,"EPSG:4326"),i=n.x*Math.PI/180,a=n.y*Math.PI/180,c=o.x*Math.PI/180,u=o.y*Math.PI/180,s=c-i,l=Math.sin(s)*Math.cos(u),p=Math.cos(a)*Math.sin(u)-Math.sin(a)*Math.cos(u)*Math.cos(s);return(180*Math.atan2(l,p)/Math.PI+360)%360},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"haversine";return e.length>=2&&-1!==Object.keys(N).indexOf(t)?N[t](e):0},se=function(e,t){var r=e.slice();return t[0]<e[0]&&(r[0]=t[0]),t[2]>e[2]&&(r[2]=t[2]),t[1]<e[1]&&(r[1]=t[1]),t[3]>e[3]&&(r[3]=t[3]),r},le=function(e){var t=this,r=[1/0,1/0,-1/0,-1/0],n=function(e,r){var n=L.getGeoJSONExtent(r);return t.isValidExtent(n)?t.extendExtent(n,e):n};if(e.coordinates){if("Point"===e.type){var o=e.coordinates;r[0]=o[0]-.01*o[0],r[1]=o[1]-.01*o[1],r[2]=o[0]+.01*o[0],r[3]=o[1]+.01*o[1]}return Object(p.chunk)(Object(p.flattenDeep)(e.coordinates),2).reduce((function(e,t){return[t[0]<e[0]?t[0]:e[0],t[1]<e[1]?t[1]:e[1],t[0]>e[2]?t[0]:e[2],t[1]>e[3]?t[1]:e[3]]}),r)}if("GeometryCollection"===e.type)return e.geometries.reduce(n,r);if(e.type){if("FeatureCollection"===e.type)return e.features.reduce(n,r);if("Feature"===e.type&&e.geometry)return L.getGeoJSONExtent(e.geometry)}return r},pe=function(e){return!(-1!==e.indexOf(1/0)||-1!==e.indexOf(-1/0)||e[0]>e[2]||e[1]>e[3])},fe=function(e,t,r,n){var o,i,a,c=Math.PI*(1/r-.5);n&&(c+=n/180*Math.PI);for(var u=[[]],s=0;s<r;s++)o=c+2*s*Math.PI/r,i=e.x+t*Math.cos(o),a=e.y+t*Math.sin(o),u[0].push([i,a]);return u[0].push(u[0][0]),u},de=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{npoints:100,offset:10,properties:{}},r=[],n=0;n<e.length-1;++n){var o=e[n],i=e[n+1],a=b()(o),c=b()(i);if(o[0]!==i[0]||o[1]!==i[1]){var u=Object(y.a)(a,c,t);r=[].concat(x(r),x(u.geometry.coordinates))}}return r},ge=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return e.length<=t?[Object(p.head)(e),Object(p.last)(e)]:e.length>t?[Object(p.head)(e)].concat(L.transformArcsToLine(Object(p.slice)(e,t))):[]},me=function(e){var t=e.coordinates;switch(e.type){case"Polygon":return t.map((function(e){return e.map((function(e){return e.reverse()}))}));case"LineString":return t.map((function(e){return e.reverse()}));case"Point":return t.reverse();default:return[]}},ye=function(e){return 1===e.length?e[0].geometry:{type:"GeometryCollection",geometries:e.map((function(e){return e.geometry}))}},Oe=function(e,t){if(Object(p.head)(B.filter((function(e){return e===t})))){var r=V(e,t),n=r.extent,o=r.isIDL,i=(o?n:[n]).map((function(e){var t=[e[0],e[1]],r=[e[2],e[3]];return[[t,[t[0],r[1]],r,[r[0],t[1]],t]]}));if(o){var a=n[1][0]+(Math.abs(n[0][0]-n[0][2])+Math.abs(n[1][0]-n[1][2]))/2;return{type:"MultiPolygon",radius:0,projection:t,coordinates:i,extent:n,center:[a=a>180?a-360:a,(n[0][1]+n[0][3])/2]}}return{type:"Polygon",radius:0,projection:t,coordinates:i[0],extent:n,center:[(n[0]+n[2])/2,(n[1]+n[3])/2]}}var c=[e.minx,e.miny,e.maxx,e.maxy],u=[c[0],c[1]],s=[c[2],c[3]];return{type:"Polygon",radius:0,projection:t,coordinates:[[u,[u[0],s[1]],s,[s[0],u[1]],u]],extent:c,center:[(c[0]+c[2])/2,(c[1]+c[3])/2]}},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bounds,r=e.crs,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EPSG:4326";if(!t||!r)return null;var o=L.getViewportGeometry(t,r),i=o.extent;if(4===i.length)return L.reprojectBbox(i,r,n);var a=i.map((function(e){return e[2]-e[0]})),c=P(a,2),u=c[0],s=c[1];return u>s?L.reprojectBbox(i[0],r,n):L.reprojectBbox(i[1],r,n)},he=function(e,t){var r=2===e.split(":").length?e.split(":")[1]:"3857";return u.a.get(t||I(r),null,{timeout:2e3})},ve=function(e){var t=e&&e.properties&&e.properties.name||e&&e.name||e&&e.properties&&e.properties.code||e,r=t&&Object(p.last)(t.split(":"));return"WGS 1984"===r||"WGS84"===r?"EPSG:4326":r?"EPSG:"+r:null},Se=function(e){var t=e.split(" "),r=parseFloat(t[0]),n=parseFloat(t[1]);return!isNaN(r)&&!isNaN(n)&&{x:r,y:n}||null},je=function(e,t){var r=t||"EPSG:3857",n=e&&Object(p.isArray)(e)&&Object(p.head)(e.filter((function(e){return e&&e.$&&e.$.SRS===r&&e.$.maxx&&e.$.maxy&&e.$.minx&&e.$.miny})).map((function(e){return e&&e.$&&L.reprojectBbox([parseFloat(e.$.minx),parseFloat(e.$.miny),parseFloat(e.$.maxx),parseFloat(e.$.maxy)],r,"EPSG:4326")})));return Object(p.isArray)(n)&&{minx:n[0],miny:n[1],maxx:n[2],maxy:n[3]}||null},we=function(e){return!!a.a.defs(e)},Ee=function(e){var t=e.lng,r=void 0===t?1:t,n=e.lat;return{lat:void 0===n?1:n,lng:L.normalizeLng(r)}},xe=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=L.getNormalizedLatLon(e),i=D([o.lng,o.lat],"EPSG:4326",t.projection);if(!t.bbox)return!1;var a=L.reprojectBbox(t.bbox.bounds,t.bbox.crs,t.projection),c=w({left:0,right:0,top:0,bottom:0},r),u={minx:a[0]+c.left*n,miny:a[1]+c.bottom*n,maxx:a[2]-c.right*n,maxy:a[3]-c.top*n},s=L.getViewportGeometry(u,t.projection),l=4===s.extent.length?[x(s.extent)]:x(s.extent);return Object(p.head)(l.map((function(e){return i.x>=e[0]&&i.y>=e[1]&&i.x<=e[2]&&i.y<=e[3]})).filter((function(e){return e})))||!1},Pe=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=L.getNormalizedLatLon(e),i=D([o.lng,o.lat],"EPSG:4326",t.projection),a=w({left:0,right:0,top:0,bottom:0},r),c={width:(t.size.width-a.right-a.left)*n,height:(t.size.height-a.top-a.bottom)*n},u={minx:i.x-c.width/2-a.left*n,miny:i.y-c.height/2-a.bottom*n,maxx:i.x+c.width/2+a.right*n,maxy:i.y+c.height/2+a.top*n},s=L.getViewportGeometry(u,t.projection);if(4===s.extent.length)return{pos:D([s.extent[0]+t.size.width/2*n,s.extent[1]+t.size.height/2*n],t.projection,"EPSG:4326"),zoom:t.zoom,crs:"EPSG:4326"};if(Math.abs(s.extent[0][2]-s.extent[0][0])>Math.abs(s.extent[1][2]-s.extent[1][0])){var l=D([s.extent[0][2]-t.size.width/2*n,s.extent[0][3]-t.size.height/2*n],t.projection,"EPSG:4326"),p=w(w({},l),{},{x:l.x+(o.lng>l.x?360:0)});return{pos:p,zoom:t.zoom,crs:"EPSG:4326"}}return{pos:D([s.extent[1][0]+t.size.width/2*n,s.extent[1][1]+t.size.height/2*n],t.projection,"EPSG:4326"),zoom:t.zoom,crs:"EPSG:4326"}},Fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.01,i=Object(p.isArray)(r)?r:[r.x,r.y];if(Object(p.isNumber)(i[0])&&!isNaN(i[0])&&Object(p.isNumber)(i[1])&&!isNaN(i[1])&&Object(p.isNumber)(t.x)&&!isNaN(t.x)&&Object(p.isNumber)(t.y)&&!isNaN(t.y)){var a=Object(p.isFunction)(e)?e([t.x,t.y>=n?t.y-n:t.y+n]):null,c=a&&(Object(p.isArray)(a)?a:[a.x,a.y]);return Object(p.isArray)(c)?Math.sqrt((i[0]-c[0])*(i[0]-c[0])+(i[1]-c[1])*(i[1]-c[1])):o}return o},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.roundingBehaviour,r=void 0===t?"round":t,n=e.value,o=void 0===n?0:n,i=e.maximumFractionDigits,a=void 0===i?0:i;return 0===a&&Math[r]?Math[r](o):o},Le=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Object(p.isArray)(e)?{x:e[0],y:e[1]}:e,o=Object(p.isArray)(t)?{x:t[0],y:t[1]}:t,i={x:.5*(n.x+o.x),y:.5*(n.y+o.y)};return r?[i.x,i.y]:i},Ce=function(e){return Object(p.isObject)(e)&&Object(p.isNumber)(e.x)&&Object(p.isNumber)(e.y)?[e.x,e.y]:e},Ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{lat:1,lng:1},t=arguments.length>1?arguments[1]:void 0;return Object(S.a)(H(t),b()([e.lng,e.lat]))},Me=function(e,t){return Object(v.a)(e,t)||Object(S.a)(e,t)||Object(S.a)(t,e)},Ie=function(e){if(e){var t=e.split(":");if(!("urn"!==t[0]||"ogc"!==t[1]&&"x-ogc"!==t[1]||"def"!==t[2]||"crs"!==t[3]||!t[4]&&!t[6])){var r=t[4],n=t[6];return r?"".concat(r,":").concat(n):n}}return null},Ge=function(e){if(!e||"EPSG:"!==e.slice(0,5))return null;var t=e.slice(5),r=parseInt(t,10);if(r>=1024&&r<=32767)return e;var n=t.replace(" ","").replace(":","").toLowerCase(),o=q[n];return o>=1024&&o<=32767?"EPSG:".concat(o):null},Ae=function(e,t){var r=[e[0],e[1]],n=[t[0],t[1]];if(r[1]>n[1]){var o=r;r=n,n=o}if(r[0]>n[0]){var i=r.slice(),a=n.slice();r=[a[0],i[1]],n=[i[0],a[1]]}return[r[0],r[1],n[0],n[1]]};L={setCrsLabels:W,getUnits:z,reproject:D,getProjectedBBox:K,createBBox:X,reprojectGeoJson:Q,lineIntersectPolygon:Z,normalizePoint:_,normalizeLng:$,reprojectBbox:Y,getCompatibleSRS:ee,getEquivalentSRS:te,getEPSGCode:re,normalizeSRS:ne,isAllowedSRS:oe,getAvailableCRS:ie,filterCRSList:ae,calculateAzimuth:ce,calculateDistance:ue,FORMULAS:N,extendExtent:se,getGeoJSONExtent:le,isValidExtent:pe,calculateCircleCoordinates:fe,transformLineToArcs:de,transformArcsToLine:ge,coordsOLtoLeaflet:me,mergeToPolyGeom:ye,getViewportGeometry:Oe,getProjUrl:I,getExtentFromViewport:be,fetchProjRemotely:he,parseURN:ve,determineCrs:A,parseString:Se,getWMSBoundingBox:je,isSRSAllowed:we,getNormalizedLatLon:Ee,isInsideVisibleArea:xe,centerToVisibleArea:Pe,calculateCircleRadiusFromPixel:Fe,roundCoord:Te,midpoint:Le,pointObjectToArray:Ce,getExtentFromNormalized:V,getPolygonFromExtent:H,isPointInsideExtent:Ne,isBboxCompatible:Me,extractCrsFromURN:Ie,crsCodeTable:q,makeNumericEPSG:Ge,makeBboxFromOWS:Ae},t.default=L},"./MapStore2/web/client/utils/FilterUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"cqlToOgc",(function(){return h})),r.d(t,"escapeCQLStrings",(function(){return v})),r.d(t,"checkOperatorValidity",(function(){return S})),r.d(t,"isCrossLayerFilterValid",(function(){return j})),r.d(t,"setupCrossLayerFilterDefaults",(function(){return E})),r.d(t,"ogcDateField",(function(){return F})),r.d(t,"ogcListField",(function(){return T})),r.d(t,"ogcStringField",(function(){return L})),r.d(t,"ogcBooleanField",(function(){return C})),r.d(t,"ogcNumberField",(function(){return N})),r.d(t,"processOGCSimpleFilterField",(function(){return M})),r.d(t,"toOGCFilterParts",(function(){return A})),r.d(t,"toOGCFilter",(function(){return R})),r.d(t,"processOGCFilterGroup",(function(){return _})),r.d(t,"processOGCFilterFields",(function(){return k})),r.d(t,"getGmlPointElement",(function(){return D})),r.d(t,"getGmlPolygonElement",(function(){return B})),r.d(t,"getGmlLineStringElement",(function(){return U})),r.d(t,"processOGCGeometry",(function(){return H})),r.d(t,"processOGCSpatialFilter",(function(){return V})),r.d(t,"getGetFeatureBase",(function(){return q})),r.d(t,"getCrossLayerCqlFilter",(function(){return W})),r.d(t,"processOGCCrossLayerFilter",(function(){return z})),r.d(t,"toCQLFilter",(function(){return K})),r.d(t,"processCQLFilterGroup",(function(){return X})),r.d(t,"getCQLGeometryElement",(function(){return Q})),r.d(t,"processCQLSpatialFilter",(function(){return Z})),r.d(t,"cqlDateField",(function(){return $})),r.d(t,"cqlStringField",(function(){return Y})),r.d(t,"cqlBooleanField",(function(){return J})),r.d(t,"cqlNumberField",(function(){return ee})),r.d(t,"findSubGroups",(function(){return te})),r.d(t,"cqlListField",(function(){return re})),r.d(t,"processCQLFilterFields",(function(){return ne})),r.d(t,"processCQLSimpleFilterField",(function(){return oe})),r.d(t,"getOgcAllPropertyValue",(function(){return ie})),r.d(t,"getSLD",(function(){return ae})),r.d(t,"getWFSFilterData",(function(){return ce})),r.d(t,"isLikeOrIlike",(function(){return ue})),r.d(t,"isFilterEmpty",(function(){return se})),r.d(t,"isFilterValid",(function(){return le})),r.d(t,"composeAttributeFilters",(function(){return fe})),r.d(t,"reprojectFilterInNativeCrs",(function(){return de})),r.d(t,"normalizeFilterCQL",(function(){return ge})),r.d(t,"mergeFiltersToOGC",(function(){return me}));var n=r("./MapStore2/web/client/utils/ogc/GML/index.js"),o=r("./MapStore2/web/client/utils/ogc/WFS/base.js"),i=r("./MapStore2/web/client/utils/ogc/Filter/operators.js"),a=r("./MapStore2/web/client/utils/ogc/Filter/CQL/parser.js"),c=r("./MapStore2/web/client/utils/ogc/Filter/fromObject.js"),u=r.n(c),s=r("./MapStore2/web/client/utils/ogc/Filter/FilterBuilder.js"),l=r.n(s),p=r("./MapStore2/web/client/utils/CoordinatesUtils.js"),f=r("./MapStore2/node_modules/lodash/lodash.js");function d(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b,h=function(e,t){var r=l()(t);return u()(r)(Object(a.read)(e))},v=function(e){return e&&e.replace?e.replace(/\'/g,"''"):e},S=function(e,t){return!Object(f.isNil)(e)&&"isNull"!==t||!Object(f.isUndefined)(e)&&"isNull"===t},j=function(e){return Object(f.get)(e,"operation",!1)&&Object(f.get)(e,"collectGeometries.queryCollection.typeName",!1)&&Object(f.get)(e,"collectGeometries.queryCollection.geometryName",!1)},w=function(e){return'"'+e+'"'},E=function(e){if(!e||!Object(f.get)(e,"collectGeometries.queryCollection"))return null;if(Object(f.get)(e,"collectGeometries.queryCollection")){var t=(Object(f.get)(e,"collectGeometries.queryCollection.filterFields")||[]).filter((function(e){return S(e.value,e.operator)})),r=Object(f.get)(e,"collectGeometries.queryCollection.groupFields")||[{id:1,index:0,logic:"OR"}];return y(y({},e),{},{collectGeometries:y(y({},e.collectGeometries),{},{queryCollection:y(y({},e.collectGeometries.queryCollection),{},{filterFields:t,groupFields:r})})})}return null},x=function(e){return e?"1.0"===e?"1.0.0":"1.1"===e?"1.1.0":e:"2.0"},P={ogc:{startTag:"<ogc:PropertyName>",endTag:"</ogc:PropertyName>"},fes:{startTag:"<fes:ValueReference>",endTag:"</fes:ValueReference>"}},F=function(e,t,r,n){var o;if("><"===t){if(r.startDate&&r.endDate){var a=r.startDate.toISOString?r.startDate.toISOString():r.startDate,c=r.endDate.toISOString?r.endDate.toISOString():r.endDate;o=i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag+"<"+n+":LowerBoundary><"+n+":Literal>"+a+"</"+n+":Literal></"+n+":LowerBoundary><"+n+":UpperBoundary><"+n+":Literal>"+c+"</"+n+":Literal></"+n+":UpperBoundary>")}}else if(r.startDate){var u=r.startDate.toISOString?r.startDate.toISOString():r.startDate;o=i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag+"<"+n+":Literal>"+u+"</"+n+":Literal>")}return o},T=function(e,t,r,n){var o;return Object(f.isNil)(r)||(o=i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag+"<"+n+":Literal>"+r+"</"+n+":Literal>")),o},L=function(e,t,r,n){var o;return S(r,t)&&(o="isNull"===t?i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag):"="===t?i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag+"<"+n+":Literal>"+r+"</"+n+":Literal>"):i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag+"<"+n+":Literal>*"+r+"*</"+n+":Literal>")),o},C=function(e,t,r,n){var o="";return S(r,t)&&"="===t&&""!==r&&(o=i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag+"<"+n+":Literal>"+r+"</"+n+":Literal>")),o},N=function(e,t,r,n){var o;if("><"===t)Object(f.isNil)(r)||null===r.lowBound||void 0===r.lowBound||null!==r.upBound&&void 0!==r.upBound?Object(f.isNil)(r)||null===r.upBound||void 0===r.upBound||null!==r.lowBound&&void 0!==r.lowBound?Object(f.isNil)(r)||null===r.upBound||void 0===r.upBound||null===r.lowBound||void 0===r.lowBound||(o=i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag+"<"+n+":LowerBoundary><"+n+":Literal>"+r.lowBound+"</"+n+":Literal></"+n+":LowerBoundary><"+n+":UpperBoundary><"+n+":Literal>"+r.upBound+"</"+n+":Literal></"+n+":UpperBoundary>")):o=i.ogcComparisonOperators["<="](n,P[n].startTag+e+P[n].endTag+"<"+n+":Literal>"+r.upBound+"</"+n+":Literal>"):o=i.ogcComparisonOperators[">="](n,P[n].startTag+e+P[n].endTag+"<"+n+":Literal>"+r.lowBound+"</"+n+":Literal>");else{var a=Object(f.isNil)(r)||null===r.lowBound||void 0===r.lowBound?r:r.lowBound;Object(f.isNil)(a)||(o=i.ogcComparisonOperators[t](n,P[n].startTag+e+P[n].endTag+"<"+n+":Literal>"+a+"</"+n+":Literal>"))}return o},M=function(e,t){var r="";switch(e.type){case"date":r=F(e.attribute,e.operator,e.values,t);break;case"number":r=N(e.attribute,e.operator,e.values,t);break;case"string":r=L(e.attribute,e.operator,e.values,t);break;case"boolean":r=C(e.attribute,e.operator,e.values,t);break;case"list":if(e.values&&e.values.length>0){r=e.values.reduce((function(r,n){var o=null===n||"null"===n?"isNull":"=";return r+L(e.attribute,o,n,t)}),""),r=i.ogcLogicalOperators.OR(t,r)}}return r},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.typeName,r=e.geometryName,n=e.cqlFilter,o=void 0===n?"INCLUDE":n;return"queryCollection('".concat(t,"', '").concat(r,"','").concat(v(o),"')")},G=function(e){return"collectGeometries(".concat(e,")")},A=function(e,t,r){var n,a,c,u,s=[];if(e.filterFields&&e.filterFields.length>0)""!==(n=e.groupFields&&e.groupFields.length>0?b.processOGCFilterGroup(e.groupFields[0],e,r):b.processOGCFilterFields(null,e,r))&&s.push(n);else if(e.simpleFilterFields&&e.simpleFilterFields.length>0){var l=i.ogcLogicalOperators.AND(r,e.simpleFilterFields.map((function(e){return M(e,r)})).join(""));s.push(l)}if(Object(f.isArray)(e.spatialField)?(u=Object(f.find)(e.spatialField,(function(e){return"BBOX"===e.operation})))||(c=e.spatialField):e.spatialField&&("BBOX"===e.spatialField.operation?u=e.spatialField:c=[e.spatialField]),u){if(Object(f.isArray)(u.geometry&&u.geometry.extent[0])){var p=u.geometry.extent.reduce((function(e,n){var o=Object.assign({},u);return u.geometry.extent=n,e+b.processOGCSpatialFilter(t,o,r)}),"");a=i.ogcLogicalOperators.OR(r,p)}s.push(a)}else if(c&&(c=c.filter((function(e){return e&&e.geometry&&e.operation}))).length>0){var d=c.map((function(e){return b.processOGCSpatialFilter(t,e,r)})).join("");a=c.length>1?i.ogcLogicalOperators[e.spatialFieldOperator||"AND"](r,d):d,s.push(a)}if(e.crossLayerFilter&&e.crossLayerFilter.operation){var g=y(y({},e.crossLayerFilter),{},{attribute:e.crossLayerFilter.attribute});Array.isArray()?g.forEach((function(e){return s.push(b.processOGCCrossLayerFilter(e,r))})):s.push(b.processOGCCrossLayerFilter(g,r))}return e.options&&e.options.cqlFilter&&s.push(h(e.options.cqlFilter,{filterNS:r,wfsVersion:t,gmlVersion:Object(o.wfsToGmlVersion)(t)})),s},R=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"EPSG:4326";try{n=t instanceof Object?t:JSON.parse(t)}catch(e){return e}var s=x(r||"2.0"),l="2.0"===s?"fes":"ogc",p=b.getGetFeatureBase(s,n.pagination,i,a,t&&t.options),f=b.toOGCFilterParts(n,s,l),d="";return f.length>0&&(d="<"+l+":Filter>",1===f.length?d+=f[0]:(d+="<"+l+":And>",f.forEach((function(e){d+=e})),d+="</"+l+":And>"),d+="</"+l+":Filter>"),p+="<wfs:Query ".concat("2.0"===s?"typeNames":"typeName",'="').concat(e,'" ').concat("native"!==u&&'srsName="'.concat(u,'"')||"",">"),p+=d,c&&(p+=c.map((function(e){return P[l].startTag+e+P[l].endTag})).join("")),o&&o.sortBy&&o.sortOrder&&(p+="<"+l+":SortBy><"+l+":SortProperty>"+P[l].startTag+o.sortBy+P[l].endTag+"<"+l+":SortOrder>"+o.sortOrder+"</"+l+":SortOrder></"+l+":SortProperty></"+l+":SortBy>"),p+="</wfs:Query></wfs:GetFeature>"},_=function(e,t,r){var n=b.processOGCFilterFields(e,t,r),o=b.findSubGroups(e,t.groupFields);return o.length>0&&o.forEach((function(e){n+=b.processOGCFilterGroup(e,t,r)})),""!==n?i.ogcLogicalOperators[e.logic](r,n):""},k=function(e,t,r){var n=e?t.filterFields.filter((function(t){return t.groupId===e.id&&S(t.value,t.operator)})):t.filterFields.filter((function(e){return S(e.value,e.operator)}));return n.length?n.reduce((function(e,t){var n;switch(t.type){case"date":case"date-time":case"time":n=F(t.attribute,t.operator,t.value,r);break;case"number":n=N(t.attribute,t.operator,t.value,r);break;case"string":n=L(t.attribute,t.operator,t.value,r);break;case"boolean":n=C(t.attribute,t.operator,t.value,r);break;case"list":n=T(t.attribute,t.operator,t.value,r)}return"isNull"===t.operator&&(n=L(t.attribute,t.operator,t.operator,r)),n&&e.push(n),e}),[]).join(""):""},D=function(e,t,r){return Object(n.pointElement)(e,t,Object(o.wfsToGmlVersion)(r))},B=function(e,t,r){return Object(n.polygonElement)(e,t,Object(o.wfsToGmlVersion)(r))},U=function(e,t,r){return Object(n.lineStringElement)(e,t,Object(o.wfsToGmlVersion)(r))},H=function(e,t){return Object(n.processOGCGeometry)(Object(o.wfsToGmlVersion)(e),t)},V=function(e,t,r){if(t.collectGeometries)return b.processOGCCrossLayerFilter(t);var a=P[r].startTag+t.attribute+P[r].endTag;switch(t.operation){case"INTERSECTS":case"DWITHIN":case"WITHIN":case"CONTAINS":a+=Object(n.processOGCGeometry)(Object(o.wfsToGmlVersion)(e),t.geometry),"DWITHIN"===t.operation&&(a+="<"+r+':Distance units="m">'+(t.geometry.distance||0)+"</"+r+":Distance>");break;case"BBOX":var c=t.geometry.extent[0]+" "+t.geometry.extent[1],u=t.geometry.extent[2]+" "+t.geometry.extent[3];a+='<gml:Envelope srsName="'+t.geometry.projection+'"><gml:lowerCorner>'+c+"</gml:lowerCorner><gml:upperCorner>"+u+"</gml:upperCorner></gml:Envelope>"}return i.ogcSpatialOperators[t.operation](r,a)},q=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=x(e),a="<wfs:GetFeature ";switch(a+=n?'outputFormat="'+n+'" ':"",a+=t&&(t.startIndex||0===t.startIndex)?'startIndex="'+t.startIndex+'" ':"",a+=o.viewParams?' viewParams="'.concat(o.viewParams,'" '):"",i){case"1.0.0":a+=t&&t.maxFeatures?'maxFeatures="'+t.maxFeatures+'" ':"",a=r?a+' resultType="hits"':a,a+='service="WFS" version="'+i+'" outputFormat="GML2" xmlns:gml="http://www.opengis.net/gml" xmlns:wfs="http://www.opengis.net/wfs" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+(o.noSchemaLocation?"":'xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-basic.xsd"')+">";break;case"1.1.0":a+=t&&t.maxFeatures?'maxFeatures="'+t.maxFeatures+'" ':"",a=r?a+' resultType="hits"':a,a+='service="WFS" version="'+i+'" xmlns:gml="http://www.opengis.net/gml" xmlns:wfs="http://www.opengis.net/wfs" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+(o.noSchemaLocation?"":'xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"')+">";break;default:a+=t&&t.maxFeatures?'count="'+t.maxFeatures+'" ':"",a=r&&!t?a+' resultType="hits"':a,a+='service="WFS" version="'+i+'" xmlns:wfs="http://www.opengis.net/wfs/2.0" xmlns:fes="http://www.opengis.net/fes/2.0" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+(o.noSchemaLocation?"":'xsi:schemaLocation="http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd http://www.opengis.net/gml/3.2 http://schemas.opengis.net/gml/3.2.1/gml.xsd"')+">"}return a},W=function(e){return Object(f.get)(e,"collectGeometries.queryCollection.cqlFilter")||(Object(f.get)(e,"collectGeometries.queryCollection.filterFields")||[]).length>0&&(Object(f.get)(e,"collectGeometries.queryCollection.groupFields")||[]).length>0&&b.toCQLFilter(e.collectGeometries.queryCollection)||"INCLUDE"},z=function(e,t){var r=t||"ogc",n=P[r].startTag+e.attribute+P[r].endTag;if(e.collectGeometries){var o=b.getCrossLayerCqlFilter(e);n+='<ogc:Function name="collectGeometries"><ogc:Function name="queryCollection">'+"<ogc:Literal>".concat(e.collectGeometries.queryCollection.typeName,"</ogc:Literal>")+"<ogc:Literal>".concat(e.collectGeometries.queryCollection.geometryName,"</ogc:Literal>")+"<ogc:Literal><![CDATA[".concat(o,"]]></ogc:Literal>")+"</ogc:Function></ogc:Function>"}return"DWITHIN"===e.operation&&(n+="<"+r+':Distance units="m">'+(e.distance||0)+"</"+r+":Distance>"),i.ogcSpatialOperators[e.operation](r,n)},K=function(e){var t;try{t=e instanceof Object?e:JSON.parse(e)}catch(e){return e}var r,n,o=[];if(t.filterFields&&t.filterFields.length>0)(r=b.processCQLFilterGroup(t.groupFields[0],t))&&o.push(r);else if(t.simpleFilterFields&&t.simpleFilterFields.length>0){var i=t.simpleFilterFields.reduce((function(e,t){var r=e,n=b.processCQLSimpleFilterField(t);return!1!==n&&(r=e.length>0?e+" AND ("+n+")":"("+n+")"),r}),"");i=i.length>0?i:"INCLUDE",o.push(i)}if(t.spatialField&&(n=b.processCQLSpatialFilter(t))&&o.push(n),t.crossLayerFilter){var a=t.crossLayerFilter,c=a.operation,u=a.attribute,s=a.collectGeometries&&a.collectGeometries.queryCollection;if(c&&u&&s){var l=s.typeName,p=s.geometryName,f=b.getCrossLayerCqlFilter(a),d=G(I({typeName:l,geometryName:p,cqlFilter:f}));o.push("".concat(c,"(").concat(u,",").concat(d,")"))}}return o.length?"("+(o.length>1?o.join(") AND ("):o[0])+")":null},X=function(e,t){var r="NOR"===e.logic?y(y({},e),{},{logic:"AND",negateAll:!0}):e,n=b.processCQLFilterFields(r,t),o=b.findSubGroups(r,t.groupFields);if(o.length>0){var i=o.map((function(e){return(r.negateAll?"NOT (":"(")+b.processCQLFilterGroup(e,t)+")"})).join(" "+r.logic+" ");return n?[n,i].join(" "+r.logic+" "):i}return n},Q=function(e,t){var r=t+"(";switch(t){case"Point":r+=e.join(" ");break;case"MultiPoint":e.forEach((function(t,n){r+=t.join(" "),r+=n<e.length-1?", ":""}));break;case"Polygon":e.forEach((function(t,o){r+="(";var i=Object(n.closePolygon)(t).map((function(e){return e[0]+" "+e[1]}));r+=i.join(", "),r+=")",r+=o<e.length-1?", ":""}));break;case"MultiPolygon":e.forEach((function(t,o){r+="(",t.forEach((function(e,o){r+="(";var i=Object(n.closePolygon)(e).map((function(e){return e[0]+" "+e[1]}));r+=i.join(", "),r+=")",r+=o<t.length-1?", ":""})),r+=")",r+=o<e.length-1?", ":""}))}return r+=")"},Z=function(e){var t=(Object(f.isArray)(e.spatialField)?e.spatialField:[e.spatialField]).filter((function(e){return e&&e.geometry&&e.operation})),r="";return t.forEach((function(n,o){if(r+=n.operation+'("'+n.attribute+'",',n.collectGeometries&&n.collectGeometries.queryCollection)r+=G(I(n.collectGeometries.queryCollection));else{var i=n.geometry.projection||"";i=2===i.split(":").length?"SRID="+i.split(":")[1]+";":"",r+=i+b.getCQLGeometryElement(n.geometry.coordinates,n.geometry.type)}r+=")",o<t.length-1&&(r+=" ".concat(e.spatialFieldOperator||"AND"," "))})),r},$=function(e,t,r){var n;"><"===t?r.startDate&&r.endDate&&(n="("+e+">='"+(r.startDate.toISOString?r.startDate.toISOString():r.startDate)+"' AND "+e+"<='"+(r.endDate.toISOString?r.endDate.toISOString():r.endDate)+"')"):r.startDate&&(n=e+t+"'"+(r.startDate.toISOString?r.startDate.toISOString():r.startDate)+"'");return n},Y=function(e,t,r){var n,o=w(e);if(!Object(f.isNil)(r))if("isNull"===t)n="isNull("+o+")=true";else if("="===t){n=o+t+("'"+v(r)+"'")}else if("ilike"===t){n="strToLowerCase("+o+") LIKE "+("'%"+v(r).toLowerCase()+"%'")}else{n=o+" LIKE "+("'%"+v(r)+"%'")}return n},J=function(e,t,r){var n="";Object(f.isNil)(r)||""===r||"="===t&&(n='"'+e+'"'+t+("'"+r+"'"));return n},ee=function(e,t,r){var n,o=w(e);if("><"===t)Object(f.isNil)(r)||null===r.lowBound||void 0===r.lowBound||null!==r.upBound&&void 0!==r.upBound?Object(f.isNil)(r)||null===r.upBound||void 0===r.upBound||null!==r.lowBound&&void 0!==r.lowBound?Object(f.isNil)(r)||null===r.upBound||void 0===r.upBound||null===r.lowBound||void 0===r.lowBound||(n="("+o+">='"+r.lowBound+"' AND "+o+"<='"+r.upBound+"')"):n="("+o+"<='"+r.upBound+"')":n="("+o+">='"+r.lowBound+"')";else{var i=Object(f.isNil)(r)||null===r.lowBound||void 0===r.lowBound?r:r.lowBound;Object(f.isNil)(i)||(n=o+" "+t+" '"+i+"'")}return n},te=function(e,t){return t.filter((function(t){return t.groupId===e.id}))},re=function(e,t,r){return b.cqlStringField(e,t,r)},ne=function(e,t){var r=t.filterFields.filter((function(t){return t.groupId===e.id})),n=[];return r&&(r.forEach((function(t){var r;switch(t.type){case"date":case"time":case"date-time":r=b.cqlDateField(t.attribute,t.operator,t.value);break;case"number":r=b.cqlNumberField(t.attribute,t.operator,t.value);break;case"string":r=b.cqlStringField(t.attribute,t.operator,t.value);break;case"boolean":r=b.cqlBooleanField(t.attribute,t.operator,t.value);break;case"list":r=b.cqlListField(t.attribute,t.operator,t.value)}r&&n.push(e.negateAll?"NOT ("+r+")":r)})),n=n.join(" "+e.logic+" ")),n},oe=function(e){var t=!1;switch(e.type){case"date":t=b.cqlDateField(e.attribute,e.operator,e.values);break;case"number":t=b.cqlNumberField(e.attribute,e.operator,e.values);break;case"string":t=b.cqlStringField(e.attribute,e.operator,e.values);break;case"boolean":t=b.cqlBooleanField(e.attribute,e.operator,e.values);break;case"list":if(e.values.length!==e.optionsValues.length){var r=!1,n=e.values.reduce((function(e,t){return null===t||"null"===t?r=!0:e.push("'"+t+"'"),e}),[]);t=n.length>0?e.attribute+" IN("+n.join(",")+")":t,r&&(t=t?t+" OR isNull("+e.attribute+")=true":"isNull("+e.attribute+")=true")}}return!!(t&&t.length>0)&&t},ie=function(e,t){return'<wfs:GetPropertyValue service="WFS" valueReference=\''.concat(t,'\'\n                version="2.0" xmlns:fes="http://www.opengis.net/fes/2.0"\n                xmlns:gml="http://www.opengis.net/gml/3.2"\n                xmlns:wfs="http://www.opengis.net/wfs/2.0"\n                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                xsi:schemaLocation="http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd http://www.opengis.net/gml/3.2 http://schemas.opengis.net/gml/3.2.1/gml.xsd">\n                    <wfs:Query typeNames="').concat(e,'"/>\n            </wfs:GetPropertyValue>')},ae=function(e,t,r){var n=b.toOGCFilter(e,t,r),o=n.search("<".concat(b.nsplaceholder,":Filter>"));if(-1!==o){var i=n.search("</wfs:Query>");n=n.substr(o,i-o)}else n="";return'<StyledLayerDescriptor version="1.0.0"\n            xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:gml="http://www.opengis.net/gml" xmlns:gsml="urn:cgi:xmlns:CGI:GeoSciML:2.0" xmlns:sld="http://www.opengis.net/sld" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><Name>'.concat(e,"</Name><UserStyle><FeatureTypeStyle><Rule >").concat(n,'<PointSymbolizer><Graphic><Mark><WellKnownName>circle</WellKnownName><Fill><CssParameter name="fill">#0000FF</CssParameter></Fill></Mark><Size>20</Size></Graphic></PointSymbolizer></Rule></FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>')},ce=function(e,t){return"string"==typeof e?e:"OGC"===e.filterType?b.toOGCFilter(e.featureTypeName,y(y({},e),{},{options:t}),e.ogcVersion,e.sortOptions,e.hits):b.toCQLFilter(e)},ue=function(e){return"ilike"===e||"like"===e},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filterFields,r=void 0===t?[]:t,n=e.spatialField,o=void 0===n?{}:n,i=e.crossLayerFilter,a=void 0===i?{}:i;return!(r.filter((function(e){return e.value||0===e.value})).length>0||o.geometry||a&&a.attribute&&a.operation)},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.filterFields&&e.filterFields.length>0||e.simpleFilterFields&&e.simpleFilterFields.length>0||e.spatialField&&e.spatialField.geometry&&e.spatialField.operation||Object(f.isArray)(e.spatialField)&&Object(f.findIndex)(e.spatialField,(function(e){return e.operation&&e.geometry}))>-1||e.crossLayerFilter&&e.crossLayerFilter.collectGeometries&&e.crossLayerFilter.collectGeometries.queryCollection&&e.crossLayerFilter.collectGeometries.queryCollection.geometryName&&e.crossLayerFilter.collectGeometries.queryCollection.typeName},pe=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(f.flatten)(t.filter((function(e){return!!e})))},fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AND",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"AND",n={id:(new Date).getTime(),index:0,logic:t};return e.reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.filterFields,i=void 0===o?[]:o,a=t.groupFields,c=void 0===a?[]:a,u=t.spatialField,s=arguments.length>2?arguments[2]:void 0;return{groupFields:e.groupFields.concat(i.length>0&&c.map((function(e){return{groupId:0===e.index&&n.id||"".concat(e.groupId,"_").concat(s),logic:e.logic,id:"".concat(e.id,"_").concat(s),index:1+e.index}}))||[]),filterFields:e.filterFields.concat(i.map((function(e){return y(y({},e),{},{groupId:"".concat(e.groupId,"_").concat(s)})}))),spatialField:pe(e.spatialField,u),spatialFieldOperator:r}}),{groupFields:[n],filterFields:[],spatialField:[]})},de=function(e,t){var r,n=e.spatialField.geometry.projection,o=e.spatialField.geometry.center,i=e.spatialField.geometry.radius,a=Object(p.reprojectGeoJson)(e.spatialField.geometry,e.spatialField.geometry.projection||"EPSG:3857",t).coordinates,c=o&&[(r=Object(p.reproject)(o,n,t)).x,r.y],u=i&&Object(p.reproject)([i,0],n,t).x;return y(y({},e),{},{spatialField:y(y({},e.spatialField),{},{geometry:y(y({},e.spatialField.geometry),{},{center:c,radius:u,coordinates:a,projection:t})})})},ge=function(e,t){return e&&e.spatialField&&e.spatialField.geometry&&e.spatialField.geometry.coordinates&&e.spatialField.geometry.coordinates[0]&&(e.spatialField.projection||"EPSG:3857")!==t?t?b.reprojectFilterInNativeCrs(e,t):y(y({},e),{},{spatialField:void 0}):e},me=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.nsPlaceholder,r=void 0===t?"ogc":t,n=e.ogcVersion,i=void 0===n?"2.0":n,c=e.addXmlnsToRoot,s=void 0!==c&&c,p=e.xmlnsToAdd,g=void 0===p?[]:p,m=l()({filterNS:r,wfsVersion:i,gmlVersion:Object(o.wfsToGmlVersion)(i)}),y=u()(m),O=arguments.length,b=new Array(O>1?O-1:0),h=1;h<O;h++)b[h-1]=arguments[h];var v=m.filter(m.and.apply(m,d(Object(f.flatten)(b.filter((function(e){return!!e&&(Object(f.isString)(e)||le(e)&&!e.disabled)})).map((function(e){return Object(f.isString)(e)?[y(Object(a.read)(e))]:A(e,i,r)}))))));if(s){var S=v.indexOf(">");return"".concat(v.slice(0,S)).concat(g.length>0?" ".concat(g.join(" ")):"").concat(v.slice(S))}return v};b={processOGCFilterGroup:_,processOGCFilterFields:k,processOGCCrossLayerFilter:z,getGetFeatureBase:q,toOGCFilterParts:A,findSubGroups:te,toCQLFilter:K,getCrossLayerCqlFilter:W,processCQLFilterGroup:X,processCQLSimpleFilterField:oe,processCQLSpatialFilter:Z,processCQLFilterFields:ne,getCQLGeometryElement:Q,cqlStringField:Y,cqlDateField:$,cqlNumberField:ee,cqlBooleanField:J,cqlListField:re,toOGCFilter:R,reprojectFilterInNativeCrs:de,processOGCSpatialFilter:V,mergeFiltersToOGC:me}},"./MapStore2/web/client/utils/ImmutableUtils.js":function(e,t,r){"use strict";r.d(t,"e",(function(){return l})),r.d(t,"f",(function(){return p})),r.d(t,"d",(function(){return f})),r.d(t,"c",(function(){return d})),r.d(t,"b",(function(){return g})),r.d(t,"a",(function(){return m}));var n=r("./MapStore2/node_modules/lodash/lodash.js"),o=r("./MapStore2/node_modules/lodash/fp/set.js"),i=r.n(o),a=r("./MapStore2/node_modules/lodash/fp/unset.js"),c=r.n(a),u=r("./MapStore2/node_modules/lodash/fp/compose.js"),s=r.n(u),l=i.a,p=c.a,f=s.a,d=function(e,t,r,o){var i=e?Object(n.get)(o,e)||[]:o,a=Object(n.findIndex)(i,r);if(a>=0){var c=i.slice();return c.splice(a,1,t),e?l(e,c,o):c}return e?l(e,i.concat(t),o):i.concat(t)},g=function(e,t,r,o){var i=e?Object(n.get)(o,e)||[]:o,a=Object(n.findIndex)(i,r);if(a>=0){var c=i.slice();return c.splice(a,1,t),e?l(e,c,o):c}return o},m=function(e,t,r){var o=e?Object(n.get)(r,e)||[]:r,i=Object(n.findIndex)(o,t);if(i>=0){var a=o.slice();return a.splice(i,1),e?l(e,a,r):a()}return r}},"./MapStore2/web/client/utils/MapUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_SCREEN_DPI",(function(){return b})),r.d(t,"METERS_PER_UNIT",(function(){return h})),r.d(t,"GOOGLE_MERCATOR",(function(){return v})),r.d(t,"EXTENT_TO_ZOOM_HOOK",(function(){return S})),r.d(t,"ZOOM_TO_EXTENT_HOOK",(function(){return j})),r.d(t,"RESOLUTIONS_HOOK",(function(){return w})),r.d(t,"RESOLUTION_HOOK",(function(){return E})),r.d(t,"COMPUTE_BBOX_HOOK",(function(){return x})),r.d(t,"GET_PIXEL_FROM_COORDINATES_HOOK",(function(){return P})),r.d(t,"GET_COORDINATES_FROM_PIXEL_HOOK",(function(){return F})),r.d(t,"registerHook",(function(){return L})),r.d(t,"getHook",(function(){return C})),r.d(t,"executeHook",(function(){return N})),r.d(t,"clearHooks",(function(){return M})),r.d(t,"dpi2dpm",(function(){return I})),r.d(t,"dpi2dpu",(function(){return G})),r.d(t,"getSphericalMercatorScale",(function(){return A})),r.d(t,"getGoogleMercatorScale",(function(){return R})),r.d(t,"getSphericalMercatorScales",(function(){return _})),r.d(t,"getGoogleMercatorScales",(function(){return k})),r.d(t,"getResolutionsForScales",(function(){return D})),r.d(t,"getGoogleMercatorResolutions",(function(){return B})),r.d(t,"getResolutions",(function(){return U})),r.d(t,"getScales",(function(){return H})),r.d(t,"defaultGetZoomForExtent",(function(){return V})),r.d(t,"getZoomForExtent",(function(){return q})),r.d(t,"getCurrentResolution",(function(){return W})),r.d(t,"getCenterForExtent",(function(){return z})),r.d(t,"getBbox",(function(){return K})),r.d(t,"isNearlyEqual",(function(){return X})),r.d(t,"mapUpdated",(function(){return Q})),r.d(t,"transformExtent",(function(){return Z})),r.d(t,"groupSaveFormatted",(function(){return $})),r.d(t,"saveMapConfiguration",(function(){return Y})),r.d(t,"generateNewUUIDs",(function(){return J})),r.d(t,"mergeMapConfigs",(function(){return ee})),r.d(t,"addRootParentGroup",(function(){return te})),r.d(t,"isSimpleGeomType",(function(){return re})),r.d(t,"getSimpleGeomType",(function(){return ne})),r.d(t,"getIdFromUri",(function(){return oe})),r.d(t,"parseLayoutValue",(function(){return ie})),r.d(t,"prepareMapObjectToCompare",(function(){return ae})),r.d(t,"updateObjectFieldKey",(function(){return ce})),r.d(t,"compareMapChanges",(function(){return ue})),r.d(t,"createRegisterHooks",(function(){return se}));var n=r("./MapStore2/node_modules/lodash/lodash.js"),o=r("./MapStore2/node_modules/uuid/v1.js"),i=r.n(o),a=r("./MapStore2/web/client/utils/CoordinatesUtils.js"),c=r("./MapStore2/web/client/utils/ImmutableUtils.js"),u=r("./MapStore2/web/client/utils/LayersUtils.js"),s=r("./MapStore2/node_modules/object-assign/index.js"),l=r.n(s);function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function d(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){O(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function O(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=96,h={m:1,degrees:111194.87428468118,ft:.3048,"us-ft":1200/3937},v={RADIUS:6378137,TILE_WIDTH:256,ZOOM_FACTOR:2},S="EXTENT_TO_ZOOM_HOOK",j="ZOOM_TO_EXTENT_HOOK",w="RESOLUTIONS_HOOK",E="RESOLUTION_HOOK",x="COMPUTE_BBOX_HOOK",P="GET_PIXEL_FROM_COORDINATES_HOOK",F="GET_COORDINATES_FROM_PIXEL_HOOK",T={};function L(e,t){T[e]=t}function C(e){return T[e]}function N(e,t,r){var n=C(e);return n?t(n):r?r():null}function M(){T={}}function I(e){return e*(100/2.54)}function G(e,t){var r=Object(a.getUnits)(t||"EPSG:3857");return h[r]*I(e||b)}function A(e,t,r,n,o){return 2*Math.PI*e/(t*Math.pow(r,n)/I(o||b))}function R(e,t){return A(v.RADIUS,v.TILE_WIDTH,v.ZOOM_FACTOR,e,t)}function _(e,t,r,n,o,i){for(var a=[],c=n;c<=o;c++)a.push(A(e,t,r,c,i));return a}function k(e,t,r){return _(v.RADIUS,v.TILE_WIDTH,v.ZOOM_FACTOR,e,t,r)}function D(e,t,r){var n=G(r,t);return e.map((function(e){return e/n}))}function B(e,t,r){return D(k(e,t,r),"EPSG:3857",r)}function U(){return C("RESOLUTIONS_HOOK")?C("RESOLUTIONS_HOOK")():B(0,21,b)}function H(e,t){var r=G(t,e);return U().map((function(e){return e*r}))}function V(e,t,r,n,o,i){var a=e[2]-e[0],c=e[3]-e[1],u=Math.abs(a/t.width),s=Math.abs(c/t.height),l=Math.max(u,s),p=(i||D(k(r,n,o||b),"EPSG:3857",o)).reduce((function(e,t,r){var n=Math.abs(t-l);return n>e.diff?e:{diff:n,zoom:r}}),{diff:Number.POSITIVE_INFINITY,zoom:0}).zoom;return Math.max(0,Math.min(p,n))}function q(e,t,r,n,o){return C("EXTENT_TO_ZOOM_HOOK")?C("EXTENT_TO_ZOOM_HOOK")(e,t,r,n,o):V(e,t,r,n,o,C("RESOLUTIONS_HOOK")?C("RESOLUTIONS_HOOK")(e,t,r,n,o,I(o||b)):null)}function W(e,t,r,n){return C("RESOLUTION_HOOK")?C("RESOLUTION_HOOK")(e,t,r,n):B(t,r,n)[e]}function z(e,t){var r=(e[2]-e[0])/2,n=(e[3]-e[1])/2;return{x:e[0]+r,y:e[1]+n,crs:t}}function K(e,t){return N("COMPUTE_BBOX_HOOK",(function(r){return r(e,t)}))}var X=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0};function Q(e,t){var r,o,i,a;return!(!e||Object(n.isEmpty)(e)||!t||Object(n.isEmpty)(t))&&(!(X(null==t||null===(r=t.center)||void 0===r?void 0:r.x,null==e||null===(o=e.center)||void 0===o?void 0:o.x)&&X(null==t||null===(i=t.center)||void 0===i?void 0:i.y,null==e||null===(a=e.center)||void 0===a?void 0:a.y))||(null==t?void 0:t.zoom)!==(null==e?void 0:e.zoom))}function Z(e,t,r,n){var o=Object(a.getUnits)(e);return"ft"===o?{width:r/h.ft,height:n/h.ft}:"us-ft"===o?{width:r/h["us-ft"],height:n/h["us-ft"]}:"degrees"===o?{width:r/(111132.92-559.82*Math.cos(2*t.y)+1.175*Math.cos(4*t.y)),height:n/(111412.84*Math.cos(t.y)-93.5*Math.cos(3*t.y))}:{width:r,height:n}}var $=function(e){return{id:e.id,title:e.title,description:e.description,tooltipOptions:e.tooltipOptions,tooltipPlacement:e.tooltipPlacement,expanded:e.expanded}};function Y(e,t,r,o,i,a,s){var p={center:e.center,maxExtent:e.maxExtent,projection:e.projection,units:e.units,mapInfoControl:e.mapInfoControl,zoom:e.zoom,mapOptions:e.mapOptions||{}},f=t.map((function(e){return Object(u.saveLayer)(e)})),d=r.reduce((function(e,t){return e.concat(Object(u.getGroupNodes)(t))}),[].concat(r.map((function(e){return e.id})))).map((function(e){var t=Object(u.getNode)(r,e);return t&&t.nodes?$(t):null})).filter((function(e){return e})),g=o.filter((function(e){return!!e.thumbnail})),m=Object(u.extractSourcesFromLayers)(f),O=f.map((function(e){return l()({},e,{tileMatrixSet:e.tileMatrixSet&&e.tileMatrixSet.length>0,matrixIds:e.matrixIds&&Object.keys(e.matrixIds)})})),b=Object(n.findIndex)(O,(function(e){return"annotations"===e.id}));if(-1!==b){var h=O[b].features.map((function(e){return"FeatureCollection"===e.type?y(y({},e),{},{features:e.features.map((function(e){return e.properties.geometryGeodesic?Object(c.e)("properties.geometryGeodesic",null,e):e}))}):e.properties.geometryGeodesic?Object(c.e)("properties.geometryGeodesic",null,e):{}}));O[b]=Object(c.e)("features",h,O[b])}return y({version:2,map:l()({},p,{layers:O,groups:d,backgrounds:g,text_search_config:i,bookmark_search_config:a},!Object(n.isEmpty)(m)&&{sources:m}||{})},s)}var J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(n.cloneDeep)(e),r=y(y({},Object(n.get)(e,"map.layers",[]).reduce((function(e,t){return y(y({},e),{},O({},t.id,"annotations"===t.id?t.id:i()()))}),{})),Object(n.get)(e,"widgetsConfig.widgets",[]).reduce((function(e,t){return y(y({},e),{},O({},t.id,i()()))}),{}));return Object(c.e)("map.backgrounds",Object(n.get)(e,"map.backgrounds",[]).map((function(e){return y(y({},e),{},{id:r[e.id]})})),Object(c.e)("widgetsConfig",{collapsed:Object(n.mapValues)(Object(n.mapKeys)(Object(n.get)(e,"widgetsConfig.collapsed",{}),(function(e,t){return r[t]})),(function(e){return y(y({},e),{},{layouts:Object(n.mapValues)(e.layouts,(function(e){return y(y({},e),{},{i:r[e.i]})}))})})),layouts:Object(n.mapValues)(Object(n.get)(e,"widgetsConfig.layouts",{}),(function(e){return e.map((function(e){return y(y({},e),{},{i:r[e.i]})}))})),widgets:Object(n.get)(e,"widgetsConfig.widgets",[]).map((function(e){return y(y({},e),{},{id:r[e.id],layer:y(y({},Object(n.get)(e,"layer",{})),{},{id:r[Object(n.get)(e,"layer.id")]})})}))},Object(c.e)("map.layers",Object(n.get)(e,"map.layers",[]).map((function(e){return y(y({},e),{},{id:r[e.id]})})),t)))},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return Object(n.pick)(e,Object(n.keys)(e).filter((function(t){return void 0!==e[t]})))}))},o=J(t),i=[].concat(d(Object(n.get)(e,"map.backgrounds",[])),d(Object(n.get)(o,"map.backgrounds",[]))),a=r(Object(n.get)(e,"map.layers",[])),c=r(Object(n.get)(o,"map.layers",[])),u=Object(n.find)(a,(function(e){return"annotations"===e.id})),s=Object(n.find)(c,(function(e){return"annotations"===e.id})),l=[].concat(d(c.filter((function(e){return"annotations"!==e.id}))),d(a.filter((function(e){return"annotations"!==e.id}))),d(u||s?[y(y(y({},u||{}),s||{}),{},{features:[].concat(d(Object(n.get)(u,"features",[])),d(Object(n.get)(s,"features",[])))})]:[])),p=l.filter((function(e){return"background"===e.group})),f=Object(n.findIndex)(p,(function(e){return e.visibility})),g=Object(n.get)(e,"map.sources",{}),m=Object(n.get)(o,"map.sources",{}),b=y(y({},g),m),h=Object(n.get)(e,"widgetsConfig",{}),v=Object(n.get)(o,"widgetsConfig",{});return y(y(y({},o),e),{},{catalogServices:y(y({},Object(n.get)(e,"catalogServices",{})),{},{services:y(y({},Object(n.get)(e,"catalogServices.services",{})),Object(n.get)(o,"catalogServices.services",{}))}),map:y(y(y({},o.map),e.map),{},{backgrounds:i,groups:Object(n.uniqWith)([].concat(d(Object(n.get)(e,"map.groups",[])),d(Object(n.get)(o,"map.groups",[]))),(function(e,t){return e.id===t.id})),layers:[].concat(d(p.slice(0,f+1)),d(p.slice(f+1).map((function(e){return y(y({},e),{},{visibility:!1})}))),d(l.filter((function(e){return"background"!==e.group})))),sources:Object(n.isEmpty)(b)?void 0:b}),widgetsConfig:{collapsed:y(y({},h.collapsed),v.collapsed),layouts:Object(n.uniq)([].concat(d(Object(n.keys)(h.layouts)),d(Object(n.keys)(v.layouts)))).reduce((function(e,t){return y(y({},e),{},O({},t,[].concat(d(Object(n.get)(h,"layouts.".concat(t),[])),d(Object(n.get)(v,"layouts.".concat(t),[])))))}),{}),widgets:[].concat(d(Object(n.get)(h,"widgets",[])),d(Object(n.get)(v,"widgets",[])))},timelineData:y(y({},Object(n.get)(e,"timelineData",{})),Object(n.get)(o,"timelineData",{})),dimensionData:y(y({},Object(n.get)(e,"dimensionData",{})),Object(n.get)(o,"dimensionData",{}))})},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RootGroup",r=Object(n.get)(e,"map.groups",[]),o=r.filter((function(e){return"Default"!==e.id})),a=Object(n.find)(r,(function(e){return"Default"===e.id})),c=a&&{id:i()(),title:t,expanded:a.expanded},u=a?[].concat(d(o.map((function(e){var t=e.id,r=f(e,["id"]);return y({id:"".concat(c.id,".").concat(t)},r)}))),[c]):o;return y(y({},e),{},{map:y(y({},e.map),{},{groups:u,layers:Object(n.get)(e,"map.layers",[]).map((function(e){var t,r=e.group;return y(y({},f(e,["group"])),{},{group:!a||"background"===r||"Default"!==r&&r?a&&(null===(t=Object(n.find)(u,(function(e){var t=e.id;return t.slice(t.indexOf(".")+1)===r})))||void 0===t?void 0:t.id)||r:c.id})}))})})};function re(e){switch(e){case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":case"Text":return!1;case"Point":case"Circle":case"LineString":case"Polygon":default:return!0}}function ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Point";switch(e){case"Point":case"LineString":case"Polygon":case"Circle":return e;case"MultiPoint":case"Marker":return"Point";case"MultiLineString":return"LineString";case"MultiPolygon":return"Polygon";case"GeometryCollection":return"GeometryCollection";case"Text":return"Point";default:return e}}var oe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/data\/(\d+)/,r=decodeURIComponent(e),n=t.exec(r);return n&&n.length&&n.length>1?n[1]:null},ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(n.isString)(e)&&-1!==e.indexOf("%")?parseFloat(Object(n.trim)(e))*t/100:Object(n.isNumber)(e)?e:0},ae=function e(t){var r=["apiKey","time","args","fixed"],n=function(e){return r.reduce((function(t,r){return t||e===r}),!1)};Object.keys(t).forEach((function(r){var o=t[r],i=p(o);"object"!==i||null===o||n(r)?"undefined"!==i&&o&&!n(r)||delete t[r]:(e(o),Object.keys(o).length||delete t[r])}))},ce=function(e,t,r){e[t]&&(Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(e,t)),delete e[t])},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=["map.layers","map.backgrounds","map.text_search_config","map.bookmark_search_config","map.text_serch_config","map.zoom","widgetsConfig"],o=Object(n.pick)(Object(n.cloneDeep)(e),r),i=Object(n.pick)(Object(n.cloneDeep)(t),r);return ce(o.map,"text_serch_config","text_search_config"),ce(i.map,"text_serch_config","text_search_config"),ae(o),ae(i),Object(n.isEqual)(o,i)},se=function(){var e={};return{registerHook:function(t,r){e[t]=r},getHook:function(t){return e[t]},executeHook:function(t,r,n){var o=e[t];return o?r(o):n?n():null}}};t.default={createRegisterHooks:se,EXTENT_TO_ZOOM_HOOK:S,RESOLUTIONS_HOOK:w,RESOLUTION_HOOK:E,COMPUTE_BBOX_HOOK:x,GET_PIXEL_FROM_COORDINATES_HOOK:P,GET_COORDINATES_FROM_PIXEL_HOOK:F,DEFAULT_SCREEN_DPI:b,ZOOM_TO_EXTENT_HOOK:j,registerHook:L,getHook:C,dpi2dpm:I,getSphericalMercatorScales:_,getSphericalMercatorScale:A,getGoogleMercatorScales:k,getGoogleMercatorResolutions:B,getGoogleMercatorScale:R,getResolutionsForScales:D,getZoomForExtent:q,defaultGetZoomForExtent:V,getCenterForExtent:z,getResolutions:U,getScales:H,getBbox:K,mapUpdated:Q,getCurrentResolution:W,transformExtent:Z,saveMapConfiguration:Y,generateNewUUIDs:J,mergeMapConfigs:ee,addRootParentGroup:te,isSimpleGeomType:re,getSimpleGeomType:ne,getIdFromUri:oe,parseLayoutValue:ie,prepareMapObjectToCompare:ae,updateObjectFieldKey:ce,compareMapChanges:ue,clearHooks:M}},"./MapStore2/web/client/utils/VendorParamsUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"optionsToVendorParams",(function(){return c}));var n=r("./MapStore2/web/client/utils/FilterUtils.js");r("./MapStore2/web/client/utils/ConfigUtils.js");function o(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?o(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=t.layerFilter,a=t.filterObj,c=[Object(n.isFilterValid)(o)&&!o.disabled&&Object(n.toCQLFilter)(o),Object(n.isFilterValid)(a)&&Object(n.toCQLFilter)(a),t&&t.params&&t.params.CQL_FILTER,r];return(e=(c=c.filter((function(e){return!!e}))).length>1?c.map((function(e){return"(".concat(e,")")})).join(" AND "):c.pop())?i(i({},t.params),{},{CQL_FILTER:e}):t.params}},"./MapStore2/web/client/utils/WMTSUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"getDefaultMatrixId",(function(){return s})),r.d(t,"getMatrixIds",(function(){return l})),r.d(t,"limitMatrix",(function(){return p})),r.d(t,"getTileMatrixSet",(function(){return f})),r.d(t,"getRequestEncoding",(function(){return d})),r.d(t,"getOperations",(function(){return g})),r.d(t,"getOperation",(function(){return m})),r.d(t,"getGetTileURL",(function(){return y})),r.d(t,"getCapabilitiesURL",(function(){return O})),r.d(t,"getDefaultStyleIdentifier",(function(){return b})),r.d(t,"getDefaultFormat",(function(){return h})),r.d(t,"sortTileMatrix",(function(){return v})),r.d(t,"getTileMatrix",(function(){return S}));var n,o=r("./MapStore2/web/client/utils/CoordinatesUtils.js"),i=r("./MapStore2/node_modules/lodash/lodash.js");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){u(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=function(e){for(var t=new Array(30),r=0;r<30;++r)t[r]=e.tileMatrixPrefix+r;return t},l=function(e,t){return Object(i.isObject)(e)&&Object(i.isArray)(e[t])&&e[t]||Object(i.isArray)(e)&&e||[]},p=function(e,t){return e.length>t?Object(i.slice)(e,0,t):e.length<t?e.concat(new Array(t-e.length)):e},f=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t;return e&&Object(i.isString)(e)?e:e?Object(o.getEquivalentSRS)(t,r).reduce((function(t,r){if(Object(i.isArray)(e)){var a=Object(i.head)(e.filter((function(e){return(e["ows:Identifier"]===r||Object(o.getEPSGCode)(e["ows:SupportedCRS"])===r)&&n[e["ows:Identifier"]]})));return a&&a["ows:Identifier"]?a["ows:Identifier"]:t}return Object(i.isObject)(e)&&e[r]||t}),a):a},d=function(e){var t=n.getOperations(e);return n.getOperation(t,"GetTile","KVP")?"KVP":n.getOperation(t,"GetTile","RESTful")&&"RESTful"},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.castArray)(e.Capabilities["ows:OperationsMetadata"]["ows:Operation"])},m=function(e,t,r){return Object(i.head)(Object(i.castArray)(Object(i.head)(e.filter((function(e){return e.$.name===t})).map((function(e){return Object(i.castArray)(e["ows:DCP"]["ows:HTTP"]["ows:Get"])})))||[]).filter((function(e){return(e["ows:Constraint"]&&e["ows:Constraint"]["ows:AllowedValues"]["ows:Value"])===r})).map((function(e){return e.$["xlink:href"]})))},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ResourceURL,r=e.GetTileURL,n=e.requestEncoding;return"KVP"===n?r:t&&Object(i.castArray)(t).map((function(e){var t=e.$,r=void 0===t?{}:t;return r.template||r.value}))||r},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.head)(Object(i.castArray)(e.capabilitiesURL||e.GetTileURL))},b=function(e){return Object(i.head)(Object(i.castArray)(e.Style).filter((function(e){var t=e.$;return"true"===(void 0===t?{}:t).isDefault})).map((function(e){return e["ows:Identifier"]})))},h=function(e){return Object(i.head)(Object(i.castArray)(e.Format))},v=function(e,t){return e?c(c({},e),{},{TileMatrix:Object(i.sortBy)(null==e?void 0:e.TileMatrix.map((function(e){return c(c({},e),{},{ScaleDenominator:Number(e.ScaleDenominator)})})),"ScaleDenominator").reverse().filter((function(e){return!t||t.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.identifier;return t})).indexOf(e["ows:Identifier"])>=0}))}):e},S=function(e,t){var r,n,o=f(e.tileMatrixSet,t,e.allowedSRS,e.matrixIds),a=e.matrixIds&&l(e.matrixIds,o||t),c=v(Object(i.head)(e.tileMatrixSet.filter((function(e){return e["ows:Identifier"]===o}))),a),u=null==c||null===(r=(n=c.TileMatrix).map)||void 0===r?void 0:r.call(n,(function(e){return e["ows:Identifier"]}));return{matrixIds:u&&a?a.sort((function(e,t){return u.indexOf(e.identifier)-u.indexOf(t.identifier)})):a,tileMatrixSetName:o,tileMatrixSet:c}};n={getOperations:g,getOperation:m}},"./MapStore2/web/client/utils/cesium/ClickUtils.js":function(e,t,r){var n=r("./MapStore2/web/client/libs/cesium.js");e.exports={getMouseXYZ:function(e,t){var r=e.scene,o=t.position||t.endPosition;if(!o)return null;var i=e.camera.getPickRay(o),a=e.scene.globe.pick(i,e.scene),c=r._globe.ellipsoid;if(n.defined(a)){var u=c.cartesianToCartographic(a),s=function(e,t){if(null!==t.position){var r=e.scene,n=r._globe.ellipsoid;return r._camera.pickEllipsoid(t.position||t.endPosition,n)}return null}(e,t);return s&&(u.height=r._globe.getHeight(u),u.cartesian=s,u.position=a),u}return null},getMouseTile:function(e,t){var r=e.scene;if(!t.position)return null;var n=e.camera.getPickRay(t.position);return e.scene.globe.pickTile(n,r)}}},"./MapStore2/web/client/utils/ogc/Filter/CQL/parser.js":function(e,t){var r="INTERSECTS",n="BBOX",o="CONTAINS",i="DWITHIN",a="WITHIN",c={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,IS_NULL:/^IS NULL/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('([^']|'')*'|-?\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(e){var t=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(e);if(t){var r=e.length,n=e.indexOf("(",t[0].length);if(n>-1)for(var o=1;n<r&&o>0;)switch(n++,e.charAt(n)){case"(":o++;break;case")":o--}return[e.substr(0,n+1)]}return null},END:/^$/},u={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON","BETWEEN","COMMA","IS_NULL"],BETWEEN:["VALUE"],IS_NULL:["END"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},s={"=":"=","<>":"<>","<":"<","<=":"<=",">":">",">=":">=",LIKE:"like",ILIKE:"ilike",BETWEEN:"><","IS NULL":"isNull"},l={AND:"and",OR:"or",NOT:"not"},p={RPAREN:3,LOGICAL:2,COMPARISON:1},f=function(e,t){return t instanceof RegExp?t.exec(e):t(e)},d=function(e,t){var r,n,o=t.length;for(r=0;r<o;r++){n=t[r];var i=f(e,c[n]);if(i){var a=i[0];return{type:n,text:a,remainder:e.substr(a.length).replace(/^\s*/,"")}}}var u="ERROR: In parsing: ["+e+"], expected one of: ";for(r=0;r<o;r++)u+="\n    "+(n=t[r])+": "+c[n];throw new Error(u)},g=function(e){for(var t=[],c=[];e.length;){var u=e.shift();switch(u.type){case"PROPERTY":case"GEOMETRY":case"VALUE":c.push(u);break;case"COMPARISON":case"BETWEEN":case"IS_NULL":case"LOGICAL":for(var f=p[u.type];t.length>0&&p[t[t.length-1].type]<=f;)c.push(t.pop());t.push(u);break;case"SPATIAL":case"NOT":case"LPAREN":t.push(u);break;case"RPAREN":for(;t.length>0&&"LPAREN"!==t[t.length-1].type;)c.push(t.pop());t.pop(),t.length>0&&"SPATIAL"===t[t.length-1].type&&c.push(t.pop());break;case"COMMA":case"END":break;default:throw new Error("Unknown token type "+u.type)}}for(;t.length>0;)c.push(t.pop());var d=function e(){var t=c.pop();switch(t.type){case"LOGICAL":var u=e();return{filters:[e(),u],type:l[t.text.toUpperCase()]};case"NOT":return{filters:[e()],type:l.NOT};case"BETWEEN":c.pop();var p=e(),f=e();return{property:e(),lowerBoundary:f,upperBoundary:p,type:s.BETWEEN};case"COMPARISON":var d=e();return{property:e(),value:d,type:s[t.text.toUpperCase()]};case"IS_NULL":return{property:e(),type:s[t.text.toUpperCase()]};case"VALUE":var g=t.text.match(/^'(.*)'$/);return g?g[1].replace(/''/g,"'"):Number(t.text);case"SPATIAL":switch(t.text.toUpperCase()){case"BBOX":var m=e(),y=e(),O=e(),b=e(),h=e();return{type:n,property:h,value:[b,O,y,m]};case"INTERSECTS":var v=e(),S=e();return{type:r,property:S,value:v};case"WITHIN":var j=e(),w=e();return{type:a,property:w,value:j};case"CONTAINS":var E=e(),x=e();return{type:o,property:x,value:E};case"DWITHIN":var P=e(),F=e(),T=e();return{type:i,value:F,property:T,distance:Number(P)};default:return null}case"GEOMETRY":return function(){throw new Error("WKT parsing for CQL filter not supported yet")}(t.text);default:return t.text}}();if(c.length>0){for(var g="Remaining tokens after building AST: \n",m=c.length-1;m>=0;m--)g+=c[m].type+": "+c[m].text+"\n";throw new Error(g)}return d};e.exports={read:function(e){return g(function(e){var t,r=[],n=e,o=["NOT","GEOMETRY","SPATIAL","PROPERTY","LPAREN"];do{if(n=(t=d(n,o)).remainder,o=u[t.type],"END"!==t.type&&!o)throw new Error("No follows list for "+t.type);r.push(t)}while("END"!==t.type);return r}(e))}}},"./MapStore2/web/client/utils/ogc/Filter/FilterBuilder.js":function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var o=r("./MapStore2/web/client/utils/ogc/Filter/operators.js"),i=o.logical,a=o.spatial,c=o.comparison,u=o.literal,s=o.propertyName,l=o.valueReference,p=o.distance,f=o.lower,d=o.upper,g=r("./MapStore2/web/client/utils/ogc/Filter/filter.js"),m=g.filter,y=g.fidFilter,O=r("./MapStore2/web/client/utils/ogc/GML/index.js").processOGCGeometry;e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filterNS,r=void 0===t?"ogc":t,o=e.gmlVersion,g=e.wfsVersion,b=void 0===g?"1.1.0":g,h=o||"3.1.1",v=function(e){return O(h,e)},S=function(e){return"object"===n(e)&&Date,u(r,e)},j=0===b.indexOf("2.")?l:s;return{filter:m.bind(null,r),fidFilter:y.bind(null,r),and:i.and.bind(null,r),or:i.or.bind(null,r),not:i.not.bind(null,r),property:function(e){return{equalTo:function(t){return c.equal(r,j(r,e),S(t))},greaterThen:function(t){return c.greater(r,j(r,e),S(t))},greaterThenOrEqualTo:function(t){return c.greaterOrEqual(r,j(r,e),S(t))},lessThen:function(t){return c.less(r,j(r,e),S(t))},lessThenOrEqualTo:function(t){return c.lessOrEqual(r,j(r,e),S(t))},notEqualTo:function(t){return c.notEqual(r,j(r,e),S(t))},between:function(t,n){return c.between(r,j(r,e),f(r,S(t)),d(r,S(n)))},like:function(t,n){return c.like(r,j(r,e),S(t),n)},ilike:function(t,n){return c.ilike(r,j(r,e),S(t),n)},isNull:function(){return c.isNull(r,j(r,e))},intersects:function(t){return a.intersects(r,j(r,e),v(t))},within:function(t){return a.within(r,j(r,e),v(t))},dwithin:function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"m";return a.dwithin(r,j(r,e),v(t),p(r,n,o))},contains:function(t){return a.contains(r,j(r,e),v(t))}}}}}},"./MapStore2/web/client/utils/ogc/Filter/filter.js":function(e,t){var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ogc",t=arguments.length>1?arguments[1]:void 0;return"<".concat(e,":Filter>").concat(Array.isArray(t)?t.join(""):t,"</").concat(e,":Filter>")};e.exports={fidFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ogc",t=arguments.length>1?arguments[1]:void 0;return r(e,"<".concat(e,':FeatureId fid="').concat(t,'"/>'))},filter:r}},"./MapStore2/web/client/utils/ogc/Filter/fromObject.js":function(e,t,r){function n(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return o(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var i=r("./MapStore2/node_modules/lodash/lodash.js"),a=i.includes,c=i.isNil,u=["and","or","not"],s={"=":"equalTo","<>":"notEqualTo","><":"between","<":"lessThen","<=":"lessThenOrEqualTo",">":"greaterThen",">=":"greaterThenOrEqualTo",like:"like",ilike:"ilike"};e.exports=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){var o=r.type,i=r.filters,l=void 0===i?[]:i,p=r.value,f=r.property,d=r.lowerBoundary,g=r.upperBoundary;return a(u,o)?t[o].apply(t,n(l.map(e(t)))):t.property(f)[s[o]](c(p)?d:p,g)}}},"./MapStore2/web/client/utils/ogc/Filter/operators.js":function(e,t){var r={"=":function(e,t){return"<".concat(e,":PropertyIsEqualTo>").concat(t,"</").concat(e,":PropertyIsEqualTo>")},">":function(e,t){return"<".concat(e,":PropertyIsGreaterThan>").concat(t,"</").concat(e,":PropertyIsGreaterThan>")},"<":function(e,t){return"<".concat(e,":PropertyIsLessThan>").concat(t,"</").concat(e,":PropertyIsLessThan>")},">=":function(e,t){return"<".concat(e,":PropertyIsGreaterThanOrEqualTo>").concat(t,"</").concat(e,":PropertyIsGreaterThanOrEqualTo>")},"<=":function(e,t){return"<".concat(e,":PropertyIsLessThanOrEqualTo>").concat(t,"</").concat(e,":PropertyIsLessThanOrEqualTo>")},"<>":function(e,t){return"<".concat(e,":PropertyIsNotEqualTo>").concat(t,"</").concat(e,":PropertyIsNotEqualTo>")},"><":function(e,t){return"<".concat(e,":PropertyIsBetween>").concat(t,"</").concat(e,":PropertyIsBetween>")},like:function(e,t){return"<".concat(e,':PropertyIsLike matchCase="true" wildCard="*" singleChar="." escapeChar="!">').concat(t,"</").concat(e,":PropertyIsLike>")},ilike:function(e,t){return"<".concat(e,':PropertyIsLike matchCase="false" wildCard="*" singleChar="." escapeChar="!">').concat(t,"</").concat(e,":PropertyIsLike>")},isNull:function(e,t){return"<".concat(e,":PropertyIsNull>").concat(t,"</").concat(e,":PropertyIsNull>")}},n={AND:function(e,t){return"<".concat(e,":And>").concat(t,"</").concat(e,":And>")},OR:function(e,t){return"<".concat(e,":Or>").concat(t,"</").concat(e,":Or>")},NOR:function(e,t){return"<".concat(e,":Not><").concat(e,":Or>").concat(t,"</").concat(e,":Or></").concat(e,":Not>")},NOT:function(e,t){return"<".concat(e,":Not>").concat(t,"</").concat(e,":Not>")}},o={INTERSECTS:function(e,t){return"<".concat(e,":Intersects>").concat(t,"</").concat(e,":Intersects>")},BBOX:function(e,t){return"<".concat(e,":BBOX>").concat(t,"</").concat(e,":BBOX>")},CONTAINS:function(e,t){return"<".concat(e,":Contains>").concat(t,"</").concat(e,":Contains>")},DWITHIN:function(e,t){return"<".concat(e,":DWithin>").concat(t,"</").concat(e,":DWithin>")},WITHIN:function(e,t){return"<".concat(e,":Within>").concat(t,"</").concat(e,":Within>")}},i=function(e,t,r){return t(e,Array.isArray(r)?r.join(""):r)},a={and:function(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];return o&&o.length>0?i(e,n.AND,[t].concat(o)):i(e,n.AND,t)},or:function(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];return o&&o.length>0?i(e,n.OR,[t].concat(o)):i(e,n.OR,t)},not:function(e,t){return i(e,n.NOT,t)},nor:function(e,t){for(var r=arguments.length,o=new Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];return o&&o.length>0?i(e,n.NOR,[t].concat(o)):i(e,n.NOR,t)}},c={intersects:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i(e,o.INTERSECTS,r)},within:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i(e,o.WITHIN,r)},bbox:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i(e,o.BBOX,r)},dwithin:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i(e,o.DWITHIN,r)},contains:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return i(e,o.CONTAINS,r)}},u={equal:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r["="],n)},greater:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r[">"],n)},less:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r["<"],n)},greaterOrEqual:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r[">="],n)},lessOrEqual:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r["<="],n)},notEqual:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r["<>"],n)},between:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r["><"],n)},like:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r.like,n)},ilike:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r.ilike,n)},isNull:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return i(e,r.isNull,n)}};e.exports={ogcComparisonOperators:r,ogcLogicalOperators:n,ogcSpatialOperators:o,propertyName:function(e,t){return"<".concat(e,":PropertyName>").concat(t,"</").concat(e,":PropertyName>")},valueReference:function(e,t){return"<".concat(e,":ValueReference>").concat(t,"</").concat(e,":ValueReference>")},distance:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"m";return"<".concat(e,':Distance units="').concat(r,'">').concat(t,"</").concat(e,":Distance>")},literal:function(e,t){return"<".concat(e,":Literal>").concat(t,"</").concat(e,":Literal>")},logical:a,spatial:c,comparison:u,lower:function(e,t){return"<".concat(e,":LowerBoundary>").concat(t,"</").concat(e,":LowerBoundary>")},upper:function(e,t){return"<".concat(e,":UpperBoundary>").concat(t,"</").concat(e,":UpperBoundary>")}}},"./MapStore2/web/client/utils/ogc/GML/index.js":function(e,t,r){var n=r("./MapStore2/node_modules/lodash/lodash.js").isArray,o=function(e){return 0===e.indexOf("2.")},i=function(e){if(e.length>=3){var t=e[0],r=e[e.length-1];if(t[0]!==r[0]||t[1]!==r[1])return e.concat([e[0]])}return e},a=function(e,t,r){var n='<gml:Point srsDimension="2"';return n+=t?' srsName="'+t+'">':">",n+=o(r)?"<gml:coord><X>"+e[0]+"</X><Y>"+e[1]+"</Y></gml:coord>":"<gml:pos>"+e.join(" ")+"</gml:pos>",n+="</gml:Point>"},c=function(e,t,r){var a=o(r),c="<gml:Polygon";return c+=t?' srsName="'+t+'">':">",(e.length&&n(e[0])&&e[0].length&&n(e[0][0])?e:[e]).forEach((function(e,t){var r=i(e).map((function(e){return e[0]+(a?",":" ")+e[1]})),n=a?"outerBoundaryIs":"exterior",o=a?"innerBoundaryIs":"exterior";c+=(t<1?"<gml:"+n+">":"<gml:"+o+">")+"<gml:LinearRing>"+(a?"<gml:coordinates>":"<gml:posList>")+r.join(" ")+(a?"</gml:coordinates>":"</gml:posList>")+"</gml:LinearRing>"+(t<1?"</gml:"+n+">":"</gml:"+o+">")})),c+="</gml:Polygon>"},u=function(e,t,r){var n=o(r),i="<gml:LineString";i+=t?' srsName="'+t+'">':">";var a=e.map((function(e){return e[0]+(n?",":" ")+e[1]}));return i+=(n?"<gml:coordinates>":"<gml:posList>")+a.join(" ")+(n?"</gml:coordinates>":"</gml:posList>"),i+="</gml:LineString>"};e.exports={closePolygon:i,pointElement:a,polygonElement:c,lineStringElement:u,processOGCGeometry:function(e,t){var r="",n=t.projection||"EPSG:4326";switch(t.type){case"Point":r+=a(t.coordinates,n,e);break;case"MultiPoint":r+='<gml:MultiPoint srsName="'+(t.projection||"EPSG:4326")+'">',t.coordinates.forEach((function(t){t&&(r+="<gml:pointMember>",r+=a(t,n,e),r+="</gml:pointMember>")})),r+="</gml:MultiPoint>";break;case"LineString":r+=u(t.coordinates,n,e);break;case"MultiLineString":var o="3.2"===e?"MultiCurve":"MultiLineString",i="3.2"===e?"curveMember":"lineStringMember";r+="<gml:".concat(o,' srsName="').concat(n,'">'),t.coordinates.forEach((function(t){t&&(r+="<gml:"+i+">",r+=u(t,n,e),r+="</gml:"+i+">")})),r+="</gml:"+o+">";break;case"Polygon":r+=c(t.coordinates,n,e);break;case"MultiPolygon":var s="3.2"===e?"MultiSurface":"MultiPolygon",l="3.2"===e?"surfaceMembers":"polygonMember";r+="<gml:".concat(s,' srsName="').concat(n,'">'),t.coordinates.forEach((function(t){t&&(r+="<gml:"+l+">",r+=c(t,n,e),r+="</gml:"+l+">")})),r+="</gml:"+s+">"}return r}}},"./MapStore2/web/client/utils/ogc/WFS/base.js":function(e,t,r){var n=r("./MapStore2/node_modules/lodash/lodash.js"),o=n.head,i=n.get,a=function(e){return/[<>&'"]/.test(e)?"<![CDATA[".concat(e,"]]>"):e},c=r("./MapStore2/web/client/utils/ogc/GML/index.js").processOGCGeometry,u={"1.0.0":"2.0","1.1.0":"3.1.1","2.0":"3.2","2.0.0":"3.2"},s=function(e){return i(e,"featureTypes[0].properties")},l=function(e,t){return o((s(t)||[]).filter((function(t){return t.name===e})))},p=function(e){return e.targetNamespace},f=function(e){return 0===e.type.indexOf("gml:")},d=function(e,t){return null==t||t&&!0===t.nillable||t&&!1===t.nillable&&null!=e},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.geom,r=e.properties,n=arguments.length>1?arguments[1]:void 0;return d(f(n)?t:r[n.name],n)};e.exports={schemaLocation:p,isGeometryType:f,featureTypeSchema:function(e){return"xmlns:".concat(e.targetPrefix,'="').concat(p(e),'"')},getValue:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"1.1.0",o=f(l(t,r));return o?e?c(n,{type:e.type,coordinates:e.coordinates}):"":null==e?"":"string"==typeof e?a(e):e},getPropertyDesciptor:l,findGeometryProperty:function(e){return o((s(e)||[]).filter((function(e){return 0===e.type.indexOf("gml:")})))},getFeatureTypeProperties:s,getTypeName:function(e){return e.targetPrefix?e.targetPrefix+":"+e.featureTypes[0].typeName:e.featureTypes[0].typeName},wfsToGmlVersion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1.1.0";return u[e]},processOGCGeometry:c,isValid:function(e,t){return s(t).map((function(t){return g(e,t)}))},isValidProperty:g,isValidValueForPropertyName:function(e,t,r){return d(e,l(t,r))},isValidValue:d}}}]);