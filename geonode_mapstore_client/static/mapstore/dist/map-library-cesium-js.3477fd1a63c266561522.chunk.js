(window.webpackJsonp=window.webpackJsonp||[]).push([["map-library-cesium-js"],{"./MapStore2/node_modules/eventlistener/eventlistener.js":function(e,t,r){var n,i;void 0===(i="function"==typeof(n=function(){function e(e,t){return function(r,n,i,o){r[e]?r[e](n,i,o):r[t]&&r[t]("on"+n,i)}}return{add:e("addEventListener","attachEvent"),remove:e("removeEventListener","detachEvent")}})?n.call(t,r,t,e):n)||(e.exports=i)},"./MapStore2/web/client/components/map/cesium/plugins/BingLayer.js":function(e,t,r){var n=r("./MapStore2/web/client/utils/cesium/Layers.js"),i=r("./MapStore2/web/client/libs/cesium.js");n.registerType("bing",(function(e){var t=e.apiKey;return new i.BingMapsImageryProvider({url:"//dev.virtualearth.net",key:t,mapStyle:i.BingMapsStyle[e.name.toUpperCase()]})}))},"./MapStore2/web/client/components/map/cesium/plugins/GraticuleLayer.js":function(e,t,r){var n=r("./MapStore2/web/client/utils/cesium/Layers.js"),i=r("./MapStore2/web/client/libs/cesium.js"),o=r("./MapStore2/node_modules/object-assign/index.js"),a=function(){var e=[i.Math.toRadians(.05),i.Math.toRadians(.1),i.Math.toRadians(.2),i.Math.toRadians(.5),i.Math.toRadians(1),i.Math.toRadians(2),i.Math.toRadians(5),i.Math.toRadians(10)];function t(e,t){var r=e||{};this._tilingScheme=r.tilingScheme||new i.GeographicTilingScheme,this._color=r.color&&new i.Color(r.color[0],r.color[1],r.color[2],r.color[3])||new i.Color(1,1,1,.4),this._tileWidth=r.tileWidth||256,this._tileHeight=r.tileHeight||256,this._ready=!0,this._sexagesimal=r.sexagesimal||!1,this._numLines=r.numLines||50,this._scene=t,this._labels=new i.LabelCollection,t.primitives.add(this._labels),this._polylines=new i.PolylineCollection,t.primitives.add(this._polylines),this._ellipsoid=t.globe.ellipsoid;var n=document.createElement("canvas");n.width=256,n.height=256,this._canvas=n}var r=function(){try{return"x"in Object.defineProperty({},"x",{})}catch(e){return!1}}(),n=Object.defineProperties;function o(e){return e<.01?3:e<.1?2:e<1?1:0}return r&&n||(n=function(e){return e}),n(t.prototype,{url:{get:function(){}},proxy:{get:function(){}},tileWidth:{get:function(){return this._tileWidth}},tileHeight:{get:function(){return this._tileHeight}},maximumLevel:{get:function(){return 18}},minimumLevel:{get:function(){return 0}},tilingScheme:{get:function(){return this._tilingScheme}},rectangle:{get:function(){return this._tilingScheme.rectangle}},tileDiscardPolicy:{get:function(){}},errorEvent:{get:function(){return this._errorEvent}},ready:{get:function(){return this._ready}},credit:{get:function(){return this._credit}},hasAlphaChannel:{get:function(){return!0}}}),t.prototype.makeLabel=function(e,t,r,n){this._labels.add({position:this._ellipsoid.cartographicToCartesian(new i.Cartographic(e,t,10)),text:r,font:"normal",fillColor:this._color,outlineColor:this._color,style:i.LabelStyle.FILL,pixelOffset:new i.Cartesian2(5,n?5:-5),eyeOffset:i.Cartesian3.ZERO,horizontalOrigin:i.HorizontalOrigin.LEFT,verticalOrigin:n?i.VerticalOrigin.BOTTOM:i.VerticalOrigin.TOP,scale:1})},t.prototype._drawGrid=function(t){if(!this._currentExtent||!this._currentExtent.equals(t)){this._currentExtent=t,this._polylines.removeAll(),this._labels.removeAll();for(var r=0,n=0,a=0;a<e.length&&r<(t.north-t.south)/10;a++)r=e[a];for(var l=0;l<e.length&&n<(t.east-t.west)/10;l++)n=e[l];var c=(t.west<0?Math.ceil(t.west/n):Math.floor(t.west/n))*n,u=(t.south<0?Math.ceil(t.south/r):Math.floor(t.south/r))*r,s=(t.east<0?Math.ceil(t.east/r):Math.floor(t.east/r))*r,f=(t.north<0?Math.ceil(t.north/n):Math.floor(t.north/n))*n;c=Math.max(c-2*n,-Math.PI),s=Math.min(s+2*n,Math.PI),u=Math.max(u-2*r,-Math.PI/2),f=Math.min(f+2*n,Math.PI/2);for(var p=this._ellipsoid,d=i.Math.toRadians(1),g=u+Math.floor((f-u)/r/2)*r,m=c;m<s;m+=n){for(var h=[],y=u;y<f;y+=d)h.push(new i.Cartographic(m,y));h.push(new i.Cartographic(m,f)),this._polylines.add({positions:p.cartographicArrayToCartesianArray(h),width:.75,material:new i.Material({fabric:{type:"Color",uniforms:{color:this._color}}})});var b=i.Math.toDegrees(m);this.makeLabel(m,g,this._sexagesimal?this._decToSex(b):b.toFixed(o(n)),!1)}for(var v=c+Math.floor((s-c)/n/2)*n,O=u;O<f;O+=r){for(var S=[],w=c;w<s;w+=d)S.push(new i.Cartographic(w,O));S.push(new i.Cartographic(s,O)),this._polylines.add({positions:p.cartographicArrayToCartesianArray(S),width:1,material:new i.Material({fabric:{type:"Color",uniforms:{color:this._color}}})});var x=i.Math.toDegrees(O);this.makeLabel(v,O,this._sexagesimal?this._decToSex(x):x.toFixed(o(r)),!0)}}},t.prototype.requestImage=function(){return this._show&&this._drawGrid(this._getExtentView()),this._canvas},t.prototype.setVisible=function(e){this._show=e,e?(this._currentExtent=null,this._drawGrid(this._getExtentView())):(this._polylines.removeAll(),this._labels.removeAll())},t.prototype.isVisible=function(){return this._show},t.prototype._decToSex=function(t){var r=Math.floor(t),n=(60*(Math.abs(t)-r)).toFixed(2);return"60.00"===n&&(r+=1,e="0.00"),[r,":",n].join("")},t.prototype._getExtentView=function(){for(var e=this._scene.camera,t=this._scene.canvas,r=[e.pickEllipsoid(new i.Cartesian2(0,0),this._ellipsoid),e.pickEllipsoid(new i.Cartesian2(t.width,0),this._ellipsoid),e.pickEllipsoid(new i.Cartesian2(0,t.height),this._ellipsoid),e.pickEllipsoid(new i.Cartesian2(t.width,t.height),this._ellipsoid)],n=0;n<4;n++)if(void 0===r[n])return i.Rectangle.MAX_VALUE;return i.Rectangle.fromCartographicArray(this._ellipsoid.cartesianArrayToCartographicArray(r))},t.prototype.destroy=function(){this._show=!1,this._polylines&&this._scene.primitives.remove(this._polylines),this._labels&&this._scene.primitives.remove(this._labels)},t}();n.registerType("graticule",{create:function(e,t){var r=t.scene,n=new a(o({tileWidth:512,tileHeight:512,numLines:10},e||{}),r);return e.visibility&&n.setVisible(!0),n}})},"./MapStore2/web/client/components/map/cesium/plugins/MarkerLayer.js":function(e,t,r){var n=r("./MapStore2/web/client/utils/cesium/Layers.js"),i=r("./MapStore2/web/client/libs/cesium.js"),o=r("./MapStore2/node_modules/lodash/lodash.js").isEqual,a=r("./MapStore2/node_modules/object-assign/index.js");n.registerType("marker",{create:function(e,t){var r=a({},{point:{pixelSize:5,color:i.Color.RED,outlineColor:i.Color.WHITE,outlineWidth:2}},e.style),n=t.entities.add(a({position:i.Cartesian3.fromDegrees(e.point.lng,e.point.lat)},r));return{detached:!0,point:n,remove:function(){t.entities.remove(n)}}},update:function(e,t,r,n){return o(t.point,r.point)?null:(e.remove(),this.create(t,n))}})},"./MapStore2/web/client/components/map/cesium/plugins/OSMLayer.js":function(e,t,r){var n=r("./MapStore2/web/client/utils/cesium/Layers.js"),i=r("./MapStore2/web/client/libs/cesium.js");n.registerType("osm",(function(){return i.createOpenStreetMapImageryProvider({url:"//a.tile.openstreetmap.org/"})}))},"./MapStore2/web/client/components/map/cesium/plugins/OverlayLayer.js":function(e,t,r){var n=r("./MapStore2/web/client/utils/cesium/Layers.js"),i=r("./MapStore2/web/client/libs/cesium.js"),o=r("./MapStore2/node_modules/eventlistener/eventlistener.js"),a=function(){function e(e){this._scene=e.scene;var t=document.createElement("div");t.className="infoWindow",this._div=t;var r=document.createElement("div");r.className="frame",this._div.appendChild(r);var n=document.createElement("div");n.className="content",r.appendChild(n),e.container.appendChild(t),this._content=n,this.setVisible(!0)}return e.prototype.setVisible=function(e){this._visible=e,this._div.style.display=e?"block":"none"},e.prototype.setContent=function(e){if("string"==typeof e)this._content.innerHTML=e;else{for(;this._content.firstChild;)this._content.removeChild(this._content.firstChild);this._content.appendChild(e)}},e.prototype.setPosition=function(e,t){this._position=this._scene.globe.ellipsoid.cartographicToCartesian(i.Cartographic.fromDegrees(t,e,0))},e.prototype.showAt=function(e,t,r){this.setPosition(e,t),this.setContent(r),this.setVisible(!0)},e.prototype.hide=function(){this.setVisible(!1)},e.prototype.computeVisible=function(){var e=6356752.314245179,t=this._scene.camera.position,r=t.x/6378137,n=t.y/6378137,i=t.z/e,o=r*r+n*n+i*i-1,a=this._position,l=a.x/6378137-r,c=a.y/6378137-n,u=a.z/e-i,s=-(l*r+c*n+u*i);s>o&&s*s/(l*l+c*c+u*u)>o?this.setVisible(!1):this.setVisible(!0)},e.prototype.update=function(){if(this.computeVisible(),this._visible&&this._position){var e=i.SceneTransforms.wgs84ToWindowCoordinates(this._scene,this._position);if(e){var t=Math.floor(e.x)-this._div.clientWidth/2+"px",r=Math.floor(e.y)-this._div.clientHeight+"px";this._div.tabIndex=5,this._div.style.left=t,this._div.style.top=r}}},e.prototype.destroy=function(){this._div.parentNode.removeChild(this._div)},e}();n.registerType("overlay",{create:function(e,t){var r=function(e,t){var r=e.cloneNode(!0);r.id=t.id+"-overlay",r.className=(t.className||e.className)+"-overlay",r.removeAttribute("data-reactid"),function e(t){if(0!==t.length)for(var r=0;r<t.length;r++){var n=t.item(r);n.removeAttribute("data-reactid"),e(n.children||[])}}(r.children||[]);var n=t.closeClass||"close";if(t.onClose&&1===r.getElementsByClassName(n).length){var i=r.getElementsByClassName(n)[0];o.add(i,"click",(function(e){t.onClose(e.target.getAttribute("data-overlayid"))}))}return r}(document.getElementById(e.id),e),n=new a(t);n.showAt(e.position.y,e.position.x,r),n.setVisible(!0);var i=t.scene.primitives.add(n);return{detached:!0,info:i,remove:function(){t.scene.primitives.remove(i)}}}})},"./MapStore2/web/client/components/map/cesium/plugins/TileProviderLayer.js":function(e,t,r){"use strict";r.r(t);var n=r("./MapStore2/web/client/utils/cesium/Layers.js"),i=r.n(n),o=r("./MapStore2/web/client/libs/cesium.js"),a=r.n(o),l=r("./MapStore2/web/client/utils/TileConfigProvider.js"),c=r("./MapStore2/web/client/utils/ConfigUtils.js"),u=r("./MapStore2/web/client/utils/ProxyUtils.js");function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(n=(a=l.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function p(e){this.proxy=e}function d(){}p.prototype.getURL=function(e){var t=function(e){var t=e,r="";return-1!==e.indexOf("?")&&(t=e.substring(0,e.indexOf("?")+1),-1!==e.indexOf("%")&&(t=decodeURIComponent(t)),r=e.substring(e.indexOf("?")+1)),{url:t,queryString:r}}(e),r=t.url,n=t.queryString;return 0===r.indexOf("//")&&(r=location.protocol+r),Object(u.getProxyUrl)()+encodeURIComponent(r+n)},d.prototype.getURL=function(e){return e},i.a.registerType("tileprovider",(function(e){var t,r=s(l.default.getLayerConfig(e.provider,e),2),n=r[0],i=r[1],o=c.default.getProxyUrl({});o&&(t=i.noCors||Object(u.needProxy)(n));var f,g,m=i.credits,h=m?new a.a.Credit(m.text,m.imageUrl,m.link):i.attribution;return new a.a.UrlTemplateImageryProvider({url:(f=n,g=i,f.replace(/(?!(\{?[zyxs]?\}))\{*([\w_]+)*\}/g,(function(){var e=arguments[0],t=arguments[1]?arguments[1]:arguments[2],r=g[t];if(void 0===r)throw new Error("No value provided for variable "+e);return"function"==typeof r&&(r=r(g)),r}))),enablePickFeatures:!1,subdomains:i.subdomains,maximumLevel:i.maxZoom,minimumLevel:i.minZoom,credit:h,proxy:t?new p(o):new d})}))},"./MapStore2/web/client/components/map/cesium/plugins/WMSLayer.js":function(e,t,r){function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function i(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var a=r("./MapStore2/web/client/utils/cesium/Layers.js"),l=r("./MapStore2/web/client/libs/cesium.js"),c=r("./MapStore2/web/client/utils/cesium/BILTerrainProvider.js")(l),u=r("./MapStore2/web/client/utils/ConfigUtils.js").default,s=r("./MapStore2/web/client/utils/ProxyUtils.js"),f=s.getProxyUrl,p=s.needProxy,d=r("./MapStore2/node_modules/object-assign/index.js"),g=r("./MapStore2/node_modules/lodash/lodash.js").isArray,m=r("./MapStore2/web/client/utils/cesium/WMSUtils.js"),h=r("./MapStore2/web/client/utils/LayersUtils.js"),y=h.getAuthenticationParam,b=h.getURLs,v=r("./MapStore2/web/client/utils/VendorParamsUtils.js").optionsToVendorParams,O=r("./MapStore2/web/client/utils/SecurityUtils.js").addAuthenticationToSLD,S=r("./MapStore2/web/client/utils/VectorTileUtils.js").isVectorFormat;function w(e){var t=e,r="";return-1!==e.indexOf("?")&&(t=e.substring(0,e.indexOf("?")+1),-1!==e.indexOf("%")&&(t=decodeURIComponent(t)),r=e.substring(e.indexOf("?")+1)),{url:t,queryString:r}}function x(e){this.proxy=e}function j(){}function M(e){return Object.keys(e).map((function(t){return t+"="+encodeURIComponent(e[t])})).join("&")}x.prototype.getURL=function(e){var t=w(e),r=t.url,n=t.queryString;return f()+encodeURIComponent(r+n)},j.prototype.getURL=function(e){var t=w(e);return t.url+t.queryString};var T=function e(t){var r;return t.useForElevation?new c(function(e){var t,r=u.getProxyUrl({}),n=e.url;return r&&(t=p(e.url)&&r)&&(n=t+encodeURIComponent(n)),d({url:n,layerName:e.name})}(t)):((r=t.singleTile?new l.SingleTileImageryProvider(function(e){var t=void 0!==e.opacity?e.opacity:1,r=v(e),n=d({styles:e.style||"",format:(S(e.format)?"image/png":e.format)||"image/png",transparent:void 0===e.transparent||e.transparent,opacity:t,tiled:void 0===e.tiled||e.tiled,layers:e.name,width:e.size||2e3,height:e.size||2e3,bbox:"-180.0,-90,180.0,90",srs:"EPSG:4326"},r||{},y(e));return{url:(g(e.url)?e.url[Math.round(Math.random()*(e.url.length-1))]:e.url)+"?service=WMS&version=1.1.0&request=GetMap&"+M(O(n,e))}}(t)):new l.WebMapServiceImageryProvider(function(e){var t,r=void 0!==e.opacity?e.opacity:1,n=v(e),i=u.getProxyUrl({});i&&(t=p(e.url)&&i);var o=e.credits,a=o?new l.Credit(o.text||o.title,o.imageUrl,o.link):e.attribution;return d({url:"{s}",credit:a,subdomains:b(g(e.url)?e.url:[e.url]),proxy:t&&new x(t)||new j,layers:e.name,enablePickFeatures:!1,parameters:d({styles:e.style||"",format:(S(e.format)?"image/png":e.format)||"image/png",transparent:void 0===e.transparent||e.transparent,opacity:r,tiled:void 0===e.tiled||e.tiled,width:e.tileSize||256,height:e.tileSize||256},d({},e._v_?{_v_:e._v_}:{},n||{},y(e)))})}(t))).updateParams=function(r){var n=d({},t,{params:d({},t.params||{},r)});return e(n)},r)};a.registerType("wms",{create:T,update:function(e,t,r){var n=t&&t.params,o=r&&r.params,a=i(i({},n),o);return Object.keys(i(i(i({},t),r),a)).filter((function(e){return m.PARAM_OPTIONS.indexOf(e.toLowerCase())>=0})).filter((function(e){return(void 0===r[e]?o&&o[e]:r[e])!==(void 0===t[e]?n&&n[e]:t[e])})).length>0||t.securityToken!==r.securityToken||t.tileSize!==r.tileSize?T(t):null}})},"./MapStore2/web/client/components/map/cesium/plugins/WMTSLayer.js":function(e,t,r){"use strict";r.r(t);var n=r("./MapStore2/web/client/utils/cesium/Layers.js"),i=r.n(n),o=r("./MapStore2/web/client/utils/ConfigUtils.js"),a=r("./MapStore2/web/client/utils/ProxyUtils.js"),l=r("./MapStore2/web/client/utils/WMTSUtils.js"),c=r("./MapStore2/web/client/libs/cesium.js"),u=r.n(c),s=r("./MapStore2/web/client/utils/LayersUtils.js"),f=r("./MapStore2/node_modules/object-assign/index.js"),p=r.n(f),d=r("./MapStore2/node_modules/lodash/lodash.js"),g=r("./node_modules/url/url.js"),m=r.n(g),h=r("./MapStore2/web/client/utils/VectorTileUtils.js");function y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function b(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){v(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function O(e){var t=e,r="";return-1!==e.indexOf("?")&&(t=e.substring(0,e.indexOf("?")+1),-1!==e.indexOf("%")&&(t=decodeURIComponent(t)),r=e.substring(e.indexOf("?")+1)),{url:t,queryString:r}}function S(e){this.proxy=e}function w(){}S.prototype.getURL=function(e){var t=O(e),r=t.url,n=t.queryString;return Object(a.getProxyUrl)()+encodeURIComponent(r+n)},w.prototype.getURL=function(e){var t=O(e);return t.url+t.queryString};var x=function(e){return e.indexOf("EPSG:4326")>=0?new u.a.GeographicTilingScheme:e.indexOf("EPSG:3857")>=0?new u.a.WebMercatorTilingScheme:null},j=function(e,t){var r=l.getTileMatrixSet(e.tileMatrixSet,t,e.allowedSRS,e.matrixIds);return{tileMatrixSet:r,matrixIds:function(e,t){return e.length>t?Object(d.slice)(e,0,t):e.length<t?e.concat(new Array(t-e.length)):e}(e.matrixIds&&function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return(Object(d.isObject)(e)&&e[t]||Object(d.isArray)(e)&&e||[]).map((function(e){return e.identifier}))}(e.matrixIds,r)||function(e){for(var t=new Array(30),r=0;r<30;++r)t[r]=e.tileMatrixPrefix+r;return t}(e))}};function M(e){var t="EPSG:4326",r=j(e,t),n=r.tileMatrixSet,i=r.matrixIds;if(0===i.length){var l=j(e,t="EPSG:3857");n=l.tileMatrixSet,i=l.matrixIds}var c,u=o.default.getProxyUrl({});u&&(c=Object(a.needProxy)(e.url)&&u);var f,g=(f=e.matrixIds&&e.matrixIds[n],function(e,t,r){return f&&f[r]&&!f[r].ranges||e<=parseInt(Object(d.get)(f[r],"ranges.cols.max"),10)&&e>=parseInt(Object(d.get)(f[r],"ranges.cols.min"),10)&&t<=parseInt(Object(d.get)(f[r],"ranges.rows.max"),10)&&t>=parseInt(Object(d.get)(f[r],"ranges.rows.min"),10)}),y=m.a.format({query:b({},Object(s.getAuthenticationParam)(e))});return p()({url:Object(d.head)(Object(s.getURLs)(Object(d.isArray)(e.url)?e.url:[e.url],y)),format:(Object(h.isVectorFormat)(e.format)?"image/png":e.format)||"image/png",isValid:g,layer:e.name,style:e.style||"",tileMatrixLabels:i,tilingScheme:x(t,e.matrixIds[n]),proxy:c&&new S(c)||new w,enablePickFeatures:!1,tileWidth:e.tileWidth||e.tileSize||256,tileHeight:e.tileHeight||e.tileSize||256,tileMatrixSetID:n,maximumLevel:30,parameters:b({},Object(s.getAuthenticationParam)(e))})}var T=function e(t){var r,n=M(t),i=(r=new u.a.WebMapTileServiceImageryProvider(n)).requestImage;return r.requestImage=function(e,t,o){return n.isValid(e,t,o)?i.bind(r)(e,t,o):new Promise((function(){}))},r.updateParams=function(r){var n=p()({},t,{params:p()({},t.params||{},r)});return e(n)},r};i.a.registerType("wmts",{create:T,update:function(e,t,r){return t.securityToken!==r.securityToken||r.format!==t.format?T(t):null}})},"./MapStore2/web/client/components/map/cesium/plugins/index.js":function(e,t,r){"use strict";r.r(t),t.default={BingLayer:r("./MapStore2/web/client/components/map/cesium/plugins/BingLayer.js"),OSMLayer:r("./MapStore2/web/client/components/map/cesium/plugins/OSMLayer.js"),TileProviderLayer:r("./MapStore2/web/client/components/map/cesium/plugins/TileProviderLayer.js"),WMSLayer:r("./MapStore2/web/client/components/map/cesium/plugins/WMSLayer.js"),WMTSLayer:r("./MapStore2/web/client/components/map/cesium/plugins/WMTSLayer.js"),GraticuleLayer:r("./MapStore2/web/client/components/map/cesium/plugins/GraticuleLayer.js"),MarkerLayer:r("./MapStore2/web/client/components/map/cesium/plugins/MarkerLayer.js"),OverlayLayer:r("./MapStore2/web/client/components/map/cesium/plugins/OverlayLayer.js")}},"./MapStore2/web/client/components/map/plugins/cesium.js":function(e,t,r){"use strict";r.r(t);var n=r("./MapStore2/node_modules/recompose/es/Recompose.js").createSink;t.default=function(){return r("./MapStore2/web/client/components/map/cesium/plugins/index.js"),{Map:r("./MapStore2/web/client/components/map/cesium/Map.jsx").default,Layer:r("./MapStore2/web/client/components/map/cesium/Layer.jsx").default,Feature:n((function(){}))}}},"./MapStore2/web/client/utils/CoordinatesUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"FORMULAS",(function(){return I})),r.d(t,"getProjUrl",(function(){return A})),r.d(t,"determineCrs",(function(){return G})),r.d(t,"normalizePoint",(function(){return _})),r.d(t,"reproject",(function(){return U})),r.d(t,"reprojectExtent",(function(){return B})),r.d(t,"getPolygonFromExtent",(function(){return q})),r.d(t,"getExtentFromNormalized",(function(){return V})),r.d(t,"crsCodeTable",(function(){return W})),r.d(t,"setCrsLabels",(function(){return H})),r.d(t,"getUnits",(function(){return X})),r.d(t,"getProjectedBBox",(function(){return z})),r.d(t,"createBBox",(function(){return K})),r.d(t,"reprojectGeoJson",(function(){return Q})),r.d(t,"lineIntersectPolygon",(function(){return Y})),r.d(t,"normalizeLng",(function(){return Z})),r.d(t,"reprojectBbox",(function(){return $})),r.d(t,"bboxToFeatureGeometry",(function(){return J})),r.d(t,"getCompatibleSRS",(function(){return ee})),r.d(t,"getEquivalentSRS",(function(){return te})),r.d(t,"getEPSGCode",(function(){return re})),r.d(t,"normalizeSRS",(function(){return ne})),r.d(t,"isAllowedSRS",(function(){return ie})),r.d(t,"getAvailableCRS",(function(){return oe})),r.d(t,"filterCRSList",(function(){return ae})),r.d(t,"calculateAzimuth",(function(){return le})),r.d(t,"calculateDistance",(function(){return ce})),r.d(t,"extendExtent",(function(){return ue})),r.d(t,"getGeoJSONExtent",(function(){return se})),r.d(t,"isValidExtent",(function(){return fe})),r.d(t,"calculateCircleCoordinates",(function(){return pe})),r.d(t,"transformLineToArcs",(function(){return de})),r.d(t,"transformArcsToLine",(function(){return ge})),r.d(t,"coordsOLtoLeaflet",(function(){return me})),r.d(t,"mergeToPolyGeom",(function(){return he})),r.d(t,"getViewportGeometry",(function(){return ye})),r.d(t,"getExtentFromViewport",(function(){return be})),r.d(t,"fetchProjRemotely",(function(){return ve})),r.d(t,"parseURN",(function(){return Oe})),r.d(t,"parseString",(function(){return Se})),r.d(t,"getWMSBoundingBox",(function(){return we})),r.d(t,"isSRSAllowed",(function(){return xe})),r.d(t,"getNormalizedLatLon",(function(){return je})),r.d(t,"isInsideVisibleArea",(function(){return Me})),r.d(t,"centerToVisibleArea",(function(){return Te})),r.d(t,"calculateCircleRadiusFromPixel",(function(){return Ee})),r.d(t,"roundCoord",(function(){return Pe})),r.d(t,"midpoint",(function(){return Le})),r.d(t,"pointObjectToArray",(function(){return Ce})),r.d(t,"isPointInsideExtent",(function(){return Ie})),r.d(t,"isBboxCompatible",(function(){return Fe})),r.d(t,"extractCrsFromURN",(function(){return Ae})),r.d(t,"makeNumericEPSG",(function(){return Ne})),r.d(t,"makeBboxFromOWS",(function(){return Ge}));var n=r("./MapStore2/node_modules/node-geo-distance/index.js"),i=r.n(n),o=r("./MapStore2/web/client/libs/proj4.js"),a=r.n(o),l=r("./MapStore2/web/client/libs/ajax.js"),c=r.n(l),u=r("./MapStore2/node_modules/object-assign/index.js"),s=r.n(u),f=r("./MapStore2/node_modules/lodash/lodash.js"),p=r("./MapStore2/node_modules/@turf/line-intersect/index.js"),d=r.n(p),g=r("./MapStore2/node_modules/@turf/polygon-to-linestring/index.js"),m=r.n(g),h=r("./MapStore2/node_modules/@turf/great-circle/main.es.js"),y=r("./MapStore2/node_modules/turf-point/index.js"),b=r.n(y),v=r("./MapStore2/node_modules/@turf/bbox-polygon/main.es.js"),O=r("./MapStore2/node_modules/@turf/boolean-overlap/main.es.js"),S=r("./MapStore2/node_modules/@turf/boolean-contains/main.es.js");function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function x(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){j(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function j(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M(e){return function(e){if(Array.isArray(e))return P(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||E(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,i=!1,o=void 0;try{for(var a,l=e[Symbol.iterator]();!(n=(a=l.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==l.return||l.return()}finally{if(i)throw o}}return r}(e,t)||E(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function E(e,t){if(e){if("string"==typeof e)return P(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?P(e,t):void 0}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var L,C=a.a,I={vincenty:function(e){for(var t=0,r=0;r<e.length-1;++r){var n=e[r],o=e[r+1],a=T(n,2),l=a[0],c=a[1],u=T(o,2),s=u[0],f=u[1];t+=parseFloat(i.a.vincentySync({longitude:l,latitude:c},{longitude:s,latitude:f}))}return t},haversine:function(e){for(var t=0,r=0;r<e.length-1;++r){var n=e[r],o=e[r+1],a=T(n,2),l=a[0],c=a[1],u=T(o,2),s=u[0],f=u[1];t+=parseFloat(i.a.haversineSync({longitude:l,latitude:c},{longitude:s,latitude:f}))}return t}};function F(e,t){return(r=e).length>=2&&"number"==typeof r[0]&&"number"==typeof r[1]?t(e):e.map((function(e){return F(e,t)}));var r}var A=function(e){return"http://spatialreference.org/ref/epsg/".concat(e,"/proj4/")};function N(e,t,r){if(null===e)return e;var n=Object(f.cloneDeep)(e);return"Feature"===e.type?n.geometry=N(e.geometry,t,r):"FeatureCollection"===e.type?n.features=n.features.map((function(e){return N(e,t,r)})):"GeometryCollection"===e.type?n.geometries=n.geometries.map((function(e){return N(e,t,r)})):t&&t(n),r&&r(n),n}function G(e){return"string"==typeof e||e instanceof String?a.a.defs(e)?new a.a.Proj(e):null:e}var R={"EPSG:4326":"WGS 84","EPSG:3857":"EPSG:3857"},_=function(e){return{x:e.x||0,y:e.y||0,srs:e.srs||e.crs||"EPSG:4326",crs:e.srs||e.crs||"EPSG:4326"}},D=function(e){var t=e;return Object(f.isNumber)(e.x)||(t.x=parseFloat(e.x)),Object(f.isNumber)(e.y)||(t.y=parseFloat(e.y)),t},U=function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t&&a.a.defs(t)?new a.a.Proj(t):null,o=r&&a.a.defs(r)?new a.a.Proj(r):null;if(i&&o){var l=Object(f.isArray)(e)?a.a.toPoint(e):a.a.toPoint([e.x,e.y]),c=s()({},t===r?D(l):a.a.transform(i,o,D(l)),{srs:r});return n?_(c):c}return null},k=["EPSG:900913","EPSG:4326","EPSG:3857"],B=function(e,t,r){return"EPSG:4326"===t?e:r?e.map((function(e){return[U([e[0],e[1]],"EPSG:4326",t),U([e[2],e[3]],"EPSG:4326",t)].reduce((function(e,t){return[].concat(M(e),[t.x,t.y])}),[])})):[U([e[0],e[1]],"EPSG:4326",t),U([e[2],e[3]],"EPSG:4326",t)].reduce((function(e,t){return[].concat(M(e),[t.x,t.y])}),[])},q=function(e){return e?e.hasOwnProperty("geometry")&&"Polygon"===e.geometry.type?e:Object(v.a)(e):null},V=function(e,t){var r=function(e,t){var r="EPSG:4326"!==t?[U([parseFloat(e.minx),parseFloat(e.miny)],t,"EPSG:4326"),U([parseFloat(e.maxx),parseFloat(e.maxy)],t,"EPSG:4326")].reduce((function(e,t){return[].concat(M(e),[t.x,t.y])}),[]):[parseFloat(e.minx),parseFloat(e.miny),parseFloat(e.maxx),parseFloat(e.maxy)],n=!1;return"EPSG:4326"===t?n=Math.abs(e.maxx-e.minx)>=360:"EPSG:900913"!==t&&"EPSG:3857"!==t||(n=Math.abs(e.maxx-e.minx)>=40075016.68557849),n?[0,r[1],360,r[3]]:[(r[0]+180)%360,r[1],(r[2]+180)%360,r[3]].map((function(e,t){return t%2==0&&e<0?360+e:e}))}(e,t),n=r[2]<r[0];return n?{extent:B([[-180,r[1],r[2]-180,r[3]],[r[0]-180,r[1],180,r[3]]],t,n),isIDL:n}:{extent:B([r[0]-180,r[1],r[2]-180,r[3]],t,n),isIDL:n}},W={wgs84:4326,wgs1984:4326,crs84:4326,ogccrs84:4326,lambert93:2154,rgflambert93:2154},H=function(e){R=s()({},R,e)},X=function(e){return new a.a.Proj(e).units||"degrees"},z=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3?arguments[3]:void 0,i=t*n[0]/2,o=t*n[1]/2,a=Math.cos(r),l=Math.sin(r),c=i*a,u=i*l,s=o*a,f=o*l,p=e.x,d=e.y,g=p-c+f,m=p-c-f,h=p+c-f,y=p+c+f,b=d-u-s,v=d-u+s,O=d+u+s,S=d+u-s,w=L.createBBox(Math.min(g,m,h,y),Math.min(b,v,O,S),Math.max(g,m,h,y),Math.max(b,v,O,S));return w},K=function(e,t,r,n){return{minx:e,miny:t,maxx:r,maxy:n}},Q=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EPSG:4326",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"EPSG:4326",n=t,i=r;"string"==typeof n&&(n=G(n)),"string"==typeof i&&(i=G(i));var o=C(n,i);return N(e,(function(e){e.crs&&delete e.crs,e.coordinates=F(e.coordinates,(function(e){var t=T(e,2),r=t[0],n=t[1];return o.forward([r,n])}))}),(function(e){var t,r;e.bbox&&(e.bbox=(t=[Number.MAX_VALUE,Number.MAX_VALUE],r=[-Number.MAX_VALUE,-Number.MAX_VALUE],N(e,(function(e){F(e.coordinates,(function(e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),r[0]=Math.max(r[0],e[0]),r[1]=Math.max(r[1],e[1])}))})),[t[0],t[1],r[0],r[1]]))}))},Y=function(e,t){var r=m()(t).features[0];return 0!==d()(e,r).features.length},Z=function(e){var t=e/360%1*360;return t<-180?t+=360:t>180&&(t-=360),t},$=function(e,t,r){var n,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];n=Object(f.isArray)(e)?{sw:[e[0],e[1]],ne:[e[2],e[3]]}:{sw:[e.minx,e.miny],ne:[e.maxx,e.maxy]};var o=[];for(var a in n)if(n.hasOwnProperty(a)){var l=L.reproject(n[a],t,r,i);if(!l)return null;var c=l.x,u=l.y;o.push(c),o.push(u)}return o},J=function(e){var t=Object(f.isArray)(e)?{minx:e[0],miny:e[1],maxx:e[2],maxy:e[3]}:e,r=t.minx,n=t.miny,i=t.maxx,o=t.maxy;return{type:"Polygon",coordinates:[[[r,n],[r,o],[i,o],[i,n],[r,n]]]}},ee=function(e,t){return"EPSG:900913"===e&&!t["EPSG:900913"]&&t["EPSG:3857"]?"EPSG:3857":"EPSG:3857"===e&&!t["EPSG:3857"]&&t["EPSG:900913"]?"EPSG:900913":e},te=function(e){return"EPSG:900913"===e||"EPSG:3857"===e?["EPSG:3857","EPSG:900913"]:[e]},re=function(e){return-1!==e.indexOf(":")?"EPSG:"+e.substring(e.lastIndexOf(":")+1):e},ne=function(e,t){var r="EPSG:900913"===e?"EPSG:3857":e;return t&&!t[r]?L.getCompatibleSRS(r,t):r},ie=function(e,t){return t[L.getCompatibleSRS(e,t)]},oe=function(){var e={};for(var t in a.a.defs)a.a.defs.hasOwnProperty(t)&&(e[t]={label:R[t]||t});return e},ae=function(e,t,r,n){var i=Object.keys(e).reduce((function(r,n){return s()({},-1===t.indexOf(n)?r:x(x({},r),{},j({},n,e[n])))}),{}),o=n.map((function(e){return e.code})),a=Object.keys(r).reduce((function(e,t){return s()({},-1===o.indexOf(t)?e:x(x({},e),{},j({},t,r[t])))}),{});return s()({},i,a)},le=function(e,t,r){var n=L.reproject(e,r,"EPSG:4326"),i=L.reproject(t,r,"EPSG:4326"),o=n.x*Math.PI/180,a=n.y*Math.PI/180,l=i.x*Math.PI/180,c=i.y*Math.PI/180,u=l-o,s=Math.sin(u)*Math.cos(c),f=Math.cos(a)*Math.sin(c)-Math.sin(a)*Math.cos(c)*Math.cos(u);return(180*Math.atan2(s,f)/Math.PI+360)%360},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"haversine";return e.length>=2&&-1!==Object.keys(I).indexOf(t)?I[t](e):0},ue=function(e,t){var r=e.slice();return t[0]<e[0]&&(r[0]=t[0]),t[2]>e[2]&&(r[2]=t[2]),t[1]<e[1]&&(r[1]=t[1]),t[3]>e[3]&&(r[3]=t[3]),r},se=function(e){var t=this,r=[1/0,1/0,-1/0,-1/0],n=function(e,r){var n=L.getGeoJSONExtent(r);return t.isValidExtent(n)?t.extendExtent(n,e):n};if(e.coordinates){if("Point"===e.type){var i=e.coordinates;r[0]=i[0]-.01*i[0],r[1]=i[1]-.01*i[1],r[2]=i[0]+.01*i[0],r[3]=i[1]+.01*i[1]}return Object(f.chunk)(Object(f.flattenDeep)(e.coordinates),2).reduce((function(e,t){return[t[0]<e[0]?t[0]:e[0],t[1]<e[1]?t[1]:e[1],t[0]>e[2]?t[0]:e[2],t[1]>e[3]?t[1]:e[3]]}),r)}if("GeometryCollection"===e.type)return e.geometries.reduce(n,r);if(e.type){if("FeatureCollection"===e.type)return e.features.reduce(n,r);if("Feature"===e.type&&e.geometry)return L.getGeoJSONExtent(e.geometry)}return r},fe=function(e){return!(-1!==e.indexOf(1/0)||-1!==e.indexOf(-1/0)||e[0]>e[2]||e[1]>e[3])},pe=function(e,t,r,n){var i,o,a,l=Math.PI*(1/r-.5);n&&(l+=n/180*Math.PI);for(var c=[[]],u=0;u<r;u++)i=l+2*u*Math.PI/r,o=e.x+t*Math.cos(i),a=e.y+t*Math.sin(i),c[0].push([o,a]);return c[0].push(c[0][0]),c},de=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{npoints:100,offset:10,properties:{}},r=[],n=0;n<e.length-1;++n){var i=e[n],o=e[n+1],a=b()(i),l=b()(o);if(i[0]!==o[0]||i[1]!==o[1]){var c=Object(h.a)(a,l,t);r=[].concat(M(r),M(c.geometry.coordinates))}}return r},ge=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return e.length<=t?[Object(f.head)(e),Object(f.last)(e)]:e.length>t?[Object(f.head)(e)].concat(L.transformArcsToLine(Object(f.slice)(e,t))):[]},me=function(e){var t=e.coordinates;switch(e.type){case"Polygon":return t.map((function(e){return e.map((function(e){return e.reverse()}))}));case"LineString":return t.map((function(e){return e.reverse()}));case"Point":return t.reverse();default:return[]}},he=function(e){return 1===e.length?e[0].geometry:{type:"GeometryCollection",geometries:e.map((function(e){return e.geometry}))}},ye=function(e,t){if(Object(f.head)(k.filter((function(e){return e===t})))){var r=V(e,t),n=r.extent,i=r.isIDL,o=(i?n:[n]).map((function(e){var t=[e[0],e[1]],r=[e[2],e[3]];return[[t,[t[0],r[1]],r,[r[0],t[1]],t]]}));if(i){var a=n[1][0]+(Math.abs(n[0][0]-n[0][2])+Math.abs(n[1][0]-n[1][2]))/2;return{type:"MultiPolygon",radius:0,projection:t,coordinates:o,extent:n,center:[a=a>180?a-360:a,(n[0][1]+n[0][3])/2]}}return{type:"Polygon",radius:0,projection:t,coordinates:o[0],extent:n,center:[(n[0]+n[2])/2,(n[1]+n[3])/2]}}var l=[e.minx,e.miny,e.maxx,e.maxy],c=[l[0],l[1]],u=[l[2],l[3]];return{type:"Polygon",radius:0,projection:t,coordinates:[[c,[c[0],u[1]],u,[u[0],c[1]],c]],extent:l,center:[(l[0]+l[2])/2,(l[1]+l[3])/2]}},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bounds,r=e.crs,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"EPSG:4326";if(!t||!r)return null;var i=L.getViewportGeometry(t,r),o=i.extent;if(4===o.length)return L.reprojectBbox(o,r,n);var a=o.map((function(e){return e[2]-e[0]})),l=T(a,2),c=l[0],u=l[1];return c>u?L.reprojectBbox(o[0],r,n):L.reprojectBbox(o[1],r,n)},ve=function(e,t){var r=2===e.split(":").length?e.split(":")[1]:"3857";return c.a.get(t||A(r),null,{timeout:2e3})},Oe=function(e){var t=e&&e.properties&&e.properties.name||e&&e.name||e&&e.properties&&e.properties.code||e,r=t&&Object(f.last)(t.split(":"));return"WGS 1984"===r||"WGS84"===r?"EPSG:4326":r?"EPSG:"+r:null},Se=function(e){var t=e.split(" "),r=parseFloat(t[0]),n=parseFloat(t[1]);return!isNaN(r)&&!isNaN(n)&&{x:r,y:n}||null},we=function(e,t){var r=t||"EPSG:3857",n=e&&Object(f.isArray)(e)&&Object(f.head)(e.filter((function(e){return e&&e.$&&e.$.SRS===r&&e.$.maxx&&e.$.maxy&&e.$.minx&&e.$.miny})).map((function(e){return e&&e.$&&L.reprojectBbox([parseFloat(e.$.minx),parseFloat(e.$.miny),parseFloat(e.$.maxx),parseFloat(e.$.maxy)],r,"EPSG:4326")})));return Object(f.isArray)(n)&&{minx:n[0],miny:n[1],maxx:n[2],maxy:n[3]}||null},xe=function(e){return!!a.a.defs(e)},je=function(e){var t=e.lng,r=void 0===t?1:t,n=e.lat;return{lat:void 0===n?1:n,lng:L.normalizeLng(r)}},Me=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=L.getNormalizedLatLon(e),o=U([i.lng,i.lat],"EPSG:4326",t.projection);if(!t.bbox)return!1;var a=L.reprojectBbox(t.bbox.bounds,t.bbox.crs,t.projection),l=x({left:0,right:0,top:0,bottom:0},r),c={minx:a[0]+l.left*n,miny:a[1]+l.bottom*n,maxx:a[2]-l.right*n,maxy:a[3]-l.top*n},u=L.getViewportGeometry(c,t.projection),s=4===u.extent.length?[M(u.extent)]:M(u.extent);return Object(f.head)(s.map((function(e){return o.x>=e[0]&&o.y>=e[1]&&o.x<=e[2]&&o.y<=e[3]})).filter((function(e){return e})))||!1},Te=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=L.getNormalizedLatLon(e),o=U([i.lng,i.lat],"EPSG:4326",t.projection),a=x({left:0,right:0,top:0,bottom:0},r),l={width:(t.size.width-a.right-a.left)*n,height:(t.size.height-a.top-a.bottom)*n},c={minx:o.x-l.width/2-a.left*n,miny:o.y-l.height/2-a.bottom*n,maxx:o.x+l.width/2+a.right*n,maxy:o.y+l.height/2+a.top*n},u=L.getViewportGeometry(c,t.projection);if(4===u.extent.length)return{pos:U([u.extent[0]+t.size.width/2*n,u.extent[1]+t.size.height/2*n],t.projection,"EPSG:4326"),zoom:t.zoom,crs:"EPSG:4326"};if(Math.abs(u.extent[0][2]-u.extent[0][0])>Math.abs(u.extent[1][2]-u.extent[1][0])){var s=U([u.extent[0][2]-t.size.width/2*n,u.extent[0][3]-t.size.height/2*n],t.projection,"EPSG:4326"),f=x(x({},s),{},{x:s.x+(i.lng>s.x?360:0)});return{pos:f,zoom:t.zoom,crs:"EPSG:4326"}}return{pos:U([u.extent[1][0]+t.size.width/2*n,u.extent[1][1]+t.size.height/2*n],t.projection,"EPSG:4326"),zoom:t.zoom,crs:"EPSG:4326"}},Ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.01,o=Object(f.isArray)(r)?r:[r.x,r.y];if(Object(f.isNumber)(o[0])&&!isNaN(o[0])&&Object(f.isNumber)(o[1])&&!isNaN(o[1])&&Object(f.isNumber)(t.x)&&!isNaN(t.x)&&Object(f.isNumber)(t.y)&&!isNaN(t.y)){var a=Object(f.isFunction)(e)?e([t.x,t.y>=n?t.y-n:t.y+n]):null,l=a&&(Object(f.isArray)(a)?a:[a.x,a.y]);return Object(f.isArray)(l)?Math.sqrt((o[0]-l[0])*(o[0]-l[0])+(o[1]-l[1])*(o[1]-l[1])):i}return i},Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.roundingBehaviour,r=void 0===t?"round":t,n=e.value,i=void 0===n?0:n,o=e.maximumFractionDigits,a=void 0===o?0:o;return 0===a&&Math[r]?Math[r](i):i},Le=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=Object(f.isArray)(e)?{x:e[0],y:e[1]}:e,i=Object(f.isArray)(t)?{x:t[0],y:t[1]}:t,o={x:.5*(n.x+i.x),y:.5*(n.y+i.y)};return r?[o.x,o.y]:o},Ce=function(e){return Object(f.isObject)(e)&&Object(f.isNumber)(e.x)&&Object(f.isNumber)(e.y)?[e.x,e.y]:e},Ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{lat:1,lng:1},t=arguments.length>1?arguments[1]:void 0;return Object(S.a)(q(t),b()([e.lng,e.lat]))},Fe=function(e,t){return Object(O.a)(e,t)||Object(S.a)(e,t)||Object(S.a)(t,e)},Ae=function(e){if(e){var t=e.split(":");if(!("urn"!==t[0]||"ogc"!==t[1]&&"x-ogc"!==t[1]||"def"!==t[2]||"crs"!==t[3]||!t[4]&&!t[6])){var r=t[4],n=t[6];return r?"".concat(r,":").concat(n):n}}return null},Ne=function(e){if(!e||"EPSG:"!==e.slice(0,5))return null;var t=e.slice(5),r=parseInt(t,10);if(r>=1024&&r<=32767)return e;var n=t.replace(" ","").replace(":","").toLowerCase(),i=W[n];return i>=1024&&i<=32767?"EPSG:".concat(i):null},Ge=function(e,t){var r=[e[0],e[1]],n=[t[0],t[1]];if(r[1]>n[1]){var i=r;r=n,n=i}if(r[0]>n[0]){var o=r.slice(),a=n.slice();r=[a[0],o[1]],n=[o[0],a[1]]}return[r[0],r[1],n[0],n[1]]};L={setCrsLabels:H,getUnits:X,reproject:U,getProjectedBBox:z,createBBox:K,reprojectGeoJson:Q,lineIntersectPolygon:Y,normalizePoint:_,normalizeLng:Z,reprojectBbox:$,getCompatibleSRS:ee,getEquivalentSRS:te,getEPSGCode:re,normalizeSRS:ne,isAllowedSRS:ie,getAvailableCRS:oe,filterCRSList:ae,calculateAzimuth:le,calculateDistance:ce,FORMULAS:I,extendExtent:ue,getGeoJSONExtent:se,isValidExtent:fe,calculateCircleCoordinates:pe,transformLineToArcs:de,transformArcsToLine:ge,coordsOLtoLeaflet:me,mergeToPolyGeom:he,getViewportGeometry:ye,getProjUrl:A,getExtentFromViewport:be,fetchProjRemotely:ve,parseURN:Oe,determineCrs:G,parseString:Se,getWMSBoundingBox:we,isSRSAllowed:xe,getNormalizedLatLon:je,isInsideVisibleArea:Me,centerToVisibleArea:Te,calculateCircleRadiusFromPixel:Ee,roundCoord:Pe,midpoint:Le,pointObjectToArray:Ce,getExtentFromNormalized:V,getPolygonFromExtent:q,isPointInsideExtent:Ie,isBboxCompatible:Fe,extractCrsFromURN:Ae,crsCodeTable:W,makeNumericEPSG:Ne,makeBboxFromOWS:Ge},t.default=L},"./MapStore2/web/client/utils/FilterUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"cqlToOgc",(function(){return v})),r.d(t,"escapeCQLStrings",(function(){return O})),r.d(t,"checkOperatorValidity",(function(){return S})),r.d(t,"isCrossLayerFilterValid",(function(){return w})),r.d(t,"setupCrossLayerFilterDefaults",(function(){return j})),r.d(t,"ogcDateField",(function(){return E})),r.d(t,"ogcListField",(function(){return P})),r.d(t,"ogcStringField",(function(){return L})),r.d(t,"ogcBooleanField",(function(){return C})),r.d(t,"ogcNumberField",(function(){return I})),r.d(t,"processOGCSimpleFilterField",(function(){return F})),r.d(t,"toOGCFilterParts",(function(){return G})),r.d(t,"toOGCFilter",(function(){return R})),r.d(t,"processOGCFilterGroup",(function(){return _})),r.d(t,"processOGCFilterFields",(function(){return D})),r.d(t,"getGmlPointElement",(function(){return U})),r.d(t,"getGmlPolygonElement",(function(){return k})),r.d(t,"getGmlLineStringElement",(function(){return B})),r.d(t,"processOGCGeometry",(function(){return q})),r.d(t,"processOGCSpatialFilter",(function(){return V})),r.d(t,"getGetFeatureBase",(function(){return W})),r.d(t,"getCrossLayerCqlFilter",(function(){return H})),r.d(t,"processOGCCrossLayerFilter",(function(){return X})),r.d(t,"toCQLFilter",(function(){return z})),r.d(t,"processCQLFilterGroup",(function(){return K})),r.d(t,"getCQLGeometryElement",(function(){return Q})),r.d(t,"processCQLSpatialFilter",(function(){return Y})),r.d(t,"cqlDateField",(function(){return Z})),r.d(t,"cqlStringField",(function(){return $})),r.d(t,"cqlBooleanField",(function(){return J})),r.d(t,"cqlNumberField",(function(){return ee})),r.d(t,"findSubGroups",(function(){return te})),r.d(t,"cqlListField",(function(){return re})),r.d(t,"processCQLFilterFields",(function(){return ne})),r.d(t,"processCQLSimpleFilterField",(function(){return ie})),r.d(t,"getOgcAllPropertyValue",(function(){return oe})),r.d(t,"getSLD",(function(){return ae})),r.d(t,"getWFSFilterData",(function(){return le})),r.d(t,"isLikeOrIlike",(function(){return ce})),r.d(t,"isFilterEmpty",(function(){return ue})),r.d(t,"isFilterValid",(function(){return se})),r.d(t,"composeAttributeFilters",(function(){return pe})),r.d(t,"reprojectFilterInNativeCrs",(function(){return de})),r.d(t,"normalizeFilterCQL",(function(){return ge})),r.d(t,"mergeFiltersToOGC",(function(){return me}));var n=r("./MapStore2/web/client/utils/ogc/GML/index.js"),i=r("./MapStore2/web/client/utils/ogc/WFS/base.js"),o=r("./MapStore2/web/client/utils/ogc/Filter/operators.js"),a=r("./MapStore2/web/client/utils/ogc/Filter/CQL/parser.js"),l=r("./MapStore2/web/client/utils/ogc/Filter/fromObject.js"),c=r.n(l),u=r("./MapStore2/web/client/utils/ogc/Filter/FilterBuilder.js"),s=r.n(u),f=r("./MapStore2/web/client/utils/CoordinatesUtils.js"),p=r("./MapStore2/node_modules/lodash/lodash.js");function d(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b,v=function(e,t){var r=s()(t);return c()(r)(Object(a.read)(e))},O=function(e){return e&&e.replace?e.replace(/\'/g,"''"):e},S=function(e,t){return!Object(p.isNil)(e)&&"isNull"!==t||!Object(p.isUndefined)(e)&&"isNull"===t},w=function(e){return Object(p.get)(e,"operation",!1)&&Object(p.get)(e,"collectGeometries.queryCollection.typeName",!1)&&Object(p.get)(e,"collectGeometries.queryCollection.geometryName",!1)},x=function(e){return'"'+e+'"'},j=function(e){if(!e||!Object(p.get)(e,"collectGeometries.queryCollection"))return null;if(Object(p.get)(e,"collectGeometries.queryCollection")){var t=(Object(p.get)(e,"collectGeometries.queryCollection.filterFields")||[]).filter((function(e){return S(e.value,e.operator)})),r=Object(p.get)(e,"collectGeometries.queryCollection.groupFields")||[{id:1,index:0,logic:"OR"}];return h(h({},e),{},{collectGeometries:h(h({},e.collectGeometries),{},{queryCollection:h(h({},e.collectGeometries.queryCollection),{},{filterFields:t,groupFields:r})})})}return null},M=function(e){return e?"1.0"===e?"1.0.0":"1.1"===e?"1.1.0":e:"2.0"},T={ogc:{startTag:"<ogc:PropertyName>",endTag:"</ogc:PropertyName>"},fes:{startTag:"<fes:ValueReference>",endTag:"</fes:ValueReference>"}},E=function(e,t,r,n){var i;if("><"===t){if(r.startDate&&r.endDate){var a=r.startDate.toISOString?r.startDate.toISOString():r.startDate,l=r.endDate.toISOString?r.endDate.toISOString():r.endDate;i=o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag+"<"+n+":LowerBoundary><"+n+":Literal>"+a+"</"+n+":Literal></"+n+":LowerBoundary><"+n+":UpperBoundary><"+n+":Literal>"+l+"</"+n+":Literal></"+n+":UpperBoundary>")}}else if(r.startDate){var c=r.startDate.toISOString?r.startDate.toISOString():r.startDate;i=o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag+"<"+n+":Literal>"+c+"</"+n+":Literal>")}return i},P=function(e,t,r,n){var i;return Object(p.isNil)(r)||(i=o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag+"<"+n+":Literal>"+r+"</"+n+":Literal>")),i},L=function(e,t,r,n){var i;return S(r,t)&&(i="isNull"===t?o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag):"="===t?o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag+"<"+n+":Literal>"+r+"</"+n+":Literal>"):o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag+"<"+n+":Literal>*"+r+"*</"+n+":Literal>")),i},C=function(e,t,r,n){var i="";return S(r,t)&&"="===t&&""!==r&&(i=o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag+"<"+n+":Literal>"+r+"</"+n+":Literal>")),i},I=function(e,t,r,n){var i;if("><"===t)Object(p.isNil)(r)||null===r.lowBound||void 0===r.lowBound||null!==r.upBound&&void 0!==r.upBound?Object(p.isNil)(r)||null===r.upBound||void 0===r.upBound||null!==r.lowBound&&void 0!==r.lowBound?Object(p.isNil)(r)||null===r.upBound||void 0===r.upBound||null===r.lowBound||void 0===r.lowBound||(i=o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag+"<"+n+":LowerBoundary><"+n+":Literal>"+r.lowBound+"</"+n+":Literal></"+n+":LowerBoundary><"+n+":UpperBoundary><"+n+":Literal>"+r.upBound+"</"+n+":Literal></"+n+":UpperBoundary>")):i=o.ogcComparisonOperators["<="](n,T[n].startTag+e+T[n].endTag+"<"+n+":Literal>"+r.upBound+"</"+n+":Literal>"):i=o.ogcComparisonOperators[">="](n,T[n].startTag+e+T[n].endTag+"<"+n+":Literal>"+r.lowBound+"</"+n+":Literal>");else{var a=Object(p.isNil)(r)||null===r.lowBound||void 0===r.lowBound?r:r.lowBound;Object(p.isNil)(a)||(i=o.ogcComparisonOperators[t](n,T[n].startTag+e+T[n].endTag+"<"+n+":Literal>"+a+"</"+n+":Literal>"))}return i},F=function(e,t){var r="";switch(e.type){case"date":r=E(e.attribute,e.operator,e.values,t);break;case"number":r=I(e.attribute,e.operator,e.values,t);break;case"string":r=L(e.attribute,e.operator,e.values,t);break;case"boolean":r=C(e.attribute,e.operator,e.values,t);break;case"list":if(e.values&&e.values.length>0){r=e.values.reduce((function(r,n){var i=null===n||"null"===n?"isNull":"=";return r+L(e.attribute,i,n,t)}),""),r=o.ogcLogicalOperators.OR(t,r)}}return r},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.typeName,r=e.geometryName,n=e.cqlFilter,i=void 0===n?"INCLUDE":n;return"queryCollection('".concat(t,"', '").concat(r,"','").concat(O(i),"')")},N=function(e){return"collectGeometries(".concat(e,")")},G=function(e,t,r){var n,a,l,c,u=[];if(e.filterFields&&e.filterFields.length>0)""!==(n=e.groupFields&&e.groupFields.length>0?b.processOGCFilterGroup(e.groupFields[0],e,r):b.processOGCFilterFields(null,e,r))&&u.push(n);else if(e.simpleFilterFields&&e.simpleFilterFields.length>0){var s=o.ogcLogicalOperators.AND(r,e.simpleFilterFields.map((function(e){return F(e,r)})).join(""));u.push(s)}if(Object(p.isArray)(e.spatialField)?(c=Object(p.find)(e.spatialField,(function(e){return"BBOX"===e.operation})))||(l=e.spatialField):e.spatialField&&("BBOX"===e.spatialField.operation?c=e.spatialField:l=[e.spatialField]),c){if(Object(p.isArray)(c.geometry&&c.geometry.extent[0])){var f=c.geometry.extent.reduce((function(e,n){var i=Object.assign({},c);return c.geometry.extent=n,e+b.processOGCSpatialFilter(t,i,r)}),"");a=o.ogcLogicalOperators.OR(r,f)}u.push(a)}else if(l&&(l=l.filter((function(e){return e&&e.geometry&&e.operation}))).length>0){var d=l.map((function(e){return b.processOGCSpatialFilter(t,e,r)})).join("");a=l.length>1?o.ogcLogicalOperators[e.spatialFieldOperator||"AND"](r,d):d,u.push(a)}if(e.crossLayerFilter&&e.crossLayerFilter.operation){var g=h(h({},e.crossLayerFilter),{},{attribute:e.crossLayerFilter.attribute});Array.isArray()?g.forEach((function(e){return u.push(b.processOGCCrossLayerFilter(e,r))})):u.push(b.processOGCCrossLayerFilter(g,r))}return e.options&&e.options.cqlFilter&&u.push(v(e.options.cqlFilter,{filterNS:r,wfsVersion:t,gmlVersion:Object(i.wfsToGmlVersion)(t)})),u},R=function(e,t,r){var n,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"EPSG:4326";try{n=t instanceof Object?t:JSON.parse(t)}catch(e){return e}var u=M(r||"2.0"),s="2.0"===u?"fes":"ogc",f=b.getGetFeatureBase(u,n.pagination,o,a,t&&t.options),p=b.toOGCFilterParts(n,u,s),d="";return p.length>0&&(d="<"+s+":Filter>",1===p.length?d+=p[0]:(d+="<"+s+":And>",p.forEach((function(e){d+=e})),d+="</"+s+":And>"),d+="</"+s+":Filter>"),f+="<wfs:Query ".concat("2.0"===u?"typeNames":"typeName",'="').concat(e,'" ').concat("native"!==c&&'srsName="'.concat(c,'"')||"",">"),f+=d,l&&(f+=l.map((function(e){return T[s].startTag+e+T[s].endTag})).join("")),i&&i.sortBy&&i.sortOrder&&(f+="<"+s+":SortBy><"+s+":SortProperty>"+T[s].startTag+i.sortBy+T[s].endTag+"<"+s+":SortOrder>"+i.sortOrder+"</"+s+":SortOrder></"+s+":SortProperty></"+s+":SortBy>"),f+="</wfs:Query></wfs:GetFeature>"},_=function(e,t,r){var n=b.processOGCFilterFields(e,t,r),i=b.findSubGroups(e,t.groupFields);return i.length>0&&i.forEach((function(e){n+=b.processOGCFilterGroup(e,t,r)})),""!==n?o.ogcLogicalOperators[e.logic](r,n):""},D=function(e,t,r){var n=e?t.filterFields.filter((function(t){return t.groupId===e.id&&S(t.value,t.operator)})):t.filterFields.filter((function(e){return S(e.value,e.operator)}));return n.length?n.reduce((function(e,t){var n;switch(t.type){case"date":case"date-time":case"time":n=E(t.attribute,t.operator,t.value,r);break;case"number":n=I(t.attribute,t.operator,t.value,r);break;case"string":n=L(t.attribute,t.operator,t.value,r);break;case"boolean":n=C(t.attribute,t.operator,t.value,r);break;case"list":n=P(t.attribute,t.operator,t.value,r)}return"isNull"===t.operator&&(n=L(t.attribute,t.operator,t.operator,r)),n&&e.push(n),e}),[]).join(""):""},U=function(e,t,r){return Object(n.pointElement)(e,t,Object(i.wfsToGmlVersion)(r))},k=function(e,t,r){return Object(n.polygonElement)(e,t,Object(i.wfsToGmlVersion)(r))},B=function(e,t,r){return Object(n.lineStringElement)(e,t,Object(i.wfsToGmlVersion)(r))},q=function(e,t){return Object(n.processOGCGeometry)(Object(i.wfsToGmlVersion)(e),t)},V=function(e,t,r){if(t.collectGeometries)return b.processOGCCrossLayerFilter(t);var a=T[r].startTag+t.attribute+T[r].endTag;switch(t.operation){case"INTERSECTS":case"DWITHIN":case"WITHIN":case"CONTAINS":a+=Object(n.processOGCGeometry)(Object(i.wfsToGmlVersion)(e),t.geometry),"DWITHIN"===t.operation&&(a+="<"+r+':Distance units="m">'+(t.geometry.distance||0)+"</"+r+":Distance>");break;case"BBOX":var l=t.geometry.extent[0]+" "+t.geometry.extent[1],c=t.geometry.extent[2]+" "+t.geometry.extent[3];a+='<gml:Envelope srsName="'+t.geometry.projection+'"><gml:lowerCorner>'+l+"</gml:lowerCorner><gml:upperCorner>"+c+"</gml:upperCorner></gml:Envelope>"}return o.ogcSpatialOperators[t.operation](r,a)},W=function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},o=M(e),a="<wfs:GetFeature ";switch(a+=n?'outputFormat="'+n+'" ':"",a+=t&&(t.startIndex||0===t.startIndex)?'startIndex="'+t.startIndex+'" ':"",a+=i.viewParams?' viewParams="'.concat(i.viewParams,'" '):"",o){case"1.0.0":a+=t&&t.maxFeatures?'maxFeatures="'+t.maxFeatures+'" ':"",a=r?a+' resultType="hits"':a,a+='service="WFS" version="'+o+'" outputFormat="GML2" xmlns:gml="http://www.opengis.net/gml" xmlns:wfs="http://www.opengis.net/wfs" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+(i.noSchemaLocation?"":'xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/WFS-basic.xsd"')+">";break;case"1.1.0":a+=t&&t.maxFeatures?'maxFeatures="'+t.maxFeatures+'" ':"",a=r?a+' resultType="hits"':a,a+='service="WFS" version="'+o+'" xmlns:gml="http://www.opengis.net/gml" xmlns:wfs="http://www.opengis.net/wfs" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+(i.noSchemaLocation?"":'xsi:schemaLocation="http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"')+">";break;default:a+=t&&t.maxFeatures?'count="'+t.maxFeatures+'" ':"",a=r&&!t?a+' resultType="hits"':a,a+='service="WFS" version="'+o+'" xmlns:wfs="http://www.opengis.net/wfs/2.0" xmlns:fes="http://www.opengis.net/fes/2.0" xmlns:gml="http://www.opengis.net/gml/3.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" '+(i.noSchemaLocation?"":'xsi:schemaLocation="http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd http://www.opengis.net/gml/3.2 http://schemas.opengis.net/gml/3.2.1/gml.xsd"')+">"}return a},H=function(e){return Object(p.get)(e,"collectGeometries.queryCollection.cqlFilter")||(Object(p.get)(e,"collectGeometries.queryCollection.filterFields")||[]).length>0&&(Object(p.get)(e,"collectGeometries.queryCollection.groupFields")||[]).length>0&&b.toCQLFilter(e.collectGeometries.queryCollection)||"INCLUDE"},X=function(e,t){var r=t||"ogc",n=T[r].startTag+e.attribute+T[r].endTag;if(e.collectGeometries){var i=b.getCrossLayerCqlFilter(e);n+='<ogc:Function name="collectGeometries"><ogc:Function name="queryCollection">'+"<ogc:Literal>".concat(e.collectGeometries.queryCollection.typeName,"</ogc:Literal>")+"<ogc:Literal>".concat(e.collectGeometries.queryCollection.geometryName,"</ogc:Literal>")+"<ogc:Literal><![CDATA[".concat(i,"]]></ogc:Literal>")+"</ogc:Function></ogc:Function>"}return"DWITHIN"===e.operation&&(n+="<"+r+':Distance units="m">'+(e.distance||0)+"</"+r+":Distance>"),o.ogcSpatialOperators[e.operation](r,n)},z=function(e){var t;try{t=e instanceof Object?e:JSON.parse(e)}catch(e){return e}var r,n,i=[];if(t.filterFields&&t.filterFields.length>0)(r=b.processCQLFilterGroup(t.groupFields[0],t))&&i.push(r);else if(t.simpleFilterFields&&t.simpleFilterFields.length>0){var o=t.simpleFilterFields.reduce((function(e,t){var r=e,n=b.processCQLSimpleFilterField(t);return!1!==n&&(r=e.length>0?e+" AND ("+n+")":"("+n+")"),r}),"");o=o.length>0?o:"INCLUDE",i.push(o)}if(t.spatialField&&(n=b.processCQLSpatialFilter(t))&&i.push(n),t.crossLayerFilter){var a=t.crossLayerFilter,l=a.operation,c=a.attribute,u=a.collectGeometries&&a.collectGeometries.queryCollection;if(l&&c&&u){var s=u.typeName,f=u.geometryName,p=b.getCrossLayerCqlFilter(a),d=N(A({typeName:s,geometryName:f,cqlFilter:p}));i.push("".concat(l,"(").concat(c,",").concat(d,")"))}}return i.length?"("+(i.length>1?i.join(") AND ("):i[0])+")":null},K=function(e,t){var r="NOR"===e.logic?h(h({},e),{},{logic:"AND",negateAll:!0}):e,n=b.processCQLFilterFields(r,t),i=b.findSubGroups(r,t.groupFields);if(i.length>0){var o=i.map((function(e){return(r.negateAll?"NOT (":"(")+b.processCQLFilterGroup(e,t)+")"})).join(" "+r.logic+" ");return n?[n,o].join(" "+r.logic+" "):o}return n},Q=function(e,t){var r=t+"(";switch(t){case"Point":r+=e.join(" ");break;case"MultiPoint":e.forEach((function(t,n){r+=t.join(" "),r+=n<e.length-1?", ":""}));break;case"Polygon":e.forEach((function(t,i){r+="(";var o=Object(n.closePolygon)(t).map((function(e){return e[0]+" "+e[1]}));r+=o.join(", "),r+=")",r+=i<e.length-1?", ":""}));break;case"MultiPolygon":e.forEach((function(t,i){r+="(",t.forEach((function(e,i){r+="(";var o=Object(n.closePolygon)(e).map((function(e){return e[0]+" "+e[1]}));r+=o.join(", "),r+=")",r+=i<t.length-1?", ":""})),r+=")",r+=i<e.length-1?", ":""}))}return r+=")"},Y=function(e){var t=(Object(p.isArray)(e.spatialField)?e.spatialField:[e.spatialField]).filter((function(e){return e&&e.geometry&&e.operation})),r="";return t.forEach((function(n,i){if(r+=n.operation+'("'+n.attribute+'",',n.collectGeometries&&n.collectGeometries.queryCollection)r+=N(A(n.collectGeometries.queryCollection));else{var o=n.geometry.projection||"";o=2===o.split(":").length?"SRID="+o.split(":")[1]+";":"",r+=o+b.getCQLGeometryElement(n.geometry.coordinates,n.geometry.type)}r+=")",i<t.length-1&&(r+=" ".concat(e.spatialFieldOperator||"AND"," "))})),r},Z=function(e,t,r){var n;"><"===t?r.startDate&&r.endDate&&(n="("+e+">='"+(r.startDate.toISOString?r.startDate.toISOString():r.startDate)+"' AND "+e+"<='"+(r.endDate.toISOString?r.endDate.toISOString():r.endDate)+"')"):r.startDate&&(n=e+t+"'"+(r.startDate.toISOString?r.startDate.toISOString():r.startDate)+"'");return n},$=function(e,t,r){var n,i=x(e);if(!Object(p.isNil)(r))if("isNull"===t)n="isNull("+i+")=true";else if("="===t){n=i+t+("'"+O(r)+"'")}else if("ilike"===t){n="strToLowerCase("+i+") LIKE "+("'%"+O(r).toLowerCase()+"%'")}else{n=i+" LIKE "+("'%"+O(r)+"%'")}return n},J=function(e,t,r){var n="";Object(p.isNil)(r)||""===r||"="===t&&(n='"'+e+'"'+t+("'"+r+"'"));return n},ee=function(e,t,r){var n,i=x(e);if("><"===t)Object(p.isNil)(r)||null===r.lowBound||void 0===r.lowBound||null!==r.upBound&&void 0!==r.upBound?Object(p.isNil)(r)||null===r.upBound||void 0===r.upBound||null!==r.lowBound&&void 0!==r.lowBound?Object(p.isNil)(r)||null===r.upBound||void 0===r.upBound||null===r.lowBound||void 0===r.lowBound||(n="("+i+">='"+r.lowBound+"' AND "+i+"<='"+r.upBound+"')"):n="("+i+"<='"+r.upBound+"')":n="("+i+">='"+r.lowBound+"')";else{var o=Object(p.isNil)(r)||null===r.lowBound||void 0===r.lowBound?r:r.lowBound;Object(p.isNil)(o)||(n=i+" "+t+" '"+o+"'")}return n},te=function(e,t){return t.filter((function(t){return t.groupId===e.id}))},re=function(e,t,r){return b.cqlStringField(e,t,r)},ne=function(e,t){var r=t.filterFields.filter((function(t){return t.groupId===e.id})),n=[];return r&&(r.forEach((function(t){var r;switch(t.type){case"date":case"time":case"date-time":r=b.cqlDateField(t.attribute,t.operator,t.value);break;case"number":r=b.cqlNumberField(t.attribute,t.operator,t.value);break;case"string":r=b.cqlStringField(t.attribute,t.operator,t.value);break;case"boolean":r=b.cqlBooleanField(t.attribute,t.operator,t.value);break;case"list":r=b.cqlListField(t.attribute,t.operator,t.value)}r&&n.push(e.negateAll?"NOT ("+r+")":r)})),n=n.join(" "+e.logic+" ")),n},ie=function(e){var t=!1;switch(e.type){case"date":t=b.cqlDateField(e.attribute,e.operator,e.values);break;case"number":t=b.cqlNumberField(e.attribute,e.operator,e.values);break;case"string":t=b.cqlStringField(e.attribute,e.operator,e.values);break;case"boolean":t=b.cqlBooleanField(e.attribute,e.operator,e.values);break;case"list":if(e.values.length!==e.optionsValues.length){var r=!1,n=e.values.reduce((function(e,t){return null===t||"null"===t?r=!0:e.push("'"+t+"'"),e}),[]);t=n.length>0?e.attribute+" IN("+n.join(",")+")":t,r&&(t=t?t+" OR isNull("+e.attribute+")=true":"isNull("+e.attribute+")=true")}}return!!(t&&t.length>0)&&t},oe=function(e,t){return'<wfs:GetPropertyValue service="WFS" valueReference=\''.concat(t,'\'\n                version="2.0" xmlns:fes="http://www.opengis.net/fes/2.0"\n                xmlns:gml="http://www.opengis.net/gml/3.2"\n                xmlns:wfs="http://www.opengis.net/wfs/2.0"\n                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"\n                xsi:schemaLocation="http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd http://www.opengis.net/gml/3.2 http://schemas.opengis.net/gml/3.2.1/gml.xsd">\n                    <wfs:Query typeNames="').concat(e,'"/>\n            </wfs:GetPropertyValue>')},ae=function(e,t,r){var n=b.toOGCFilter(e,t,r),i=n.search("<".concat(b.nsplaceholder,":Filter>"));if(-1!==i){var o=n.search("</wfs:Query>");n=n.substr(i,o-i)}else n="";return'<StyledLayerDescriptor version="1.0.0"\n            xsi:schemaLocation="http://www.opengis.net/sld StyledLayerDescriptor.xsd" xmlns:ogc="http://www.opengis.net/ogc" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:gml="http://www.opengis.net/gml" xmlns:gsml="urn:cgi:xmlns:CGI:GeoSciML:2.0" xmlns:sld="http://www.opengis.net/sld" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><NamedLayer><Name>'.concat(e,"</Name><UserStyle><FeatureTypeStyle><Rule >").concat(n,'<PointSymbolizer><Graphic><Mark><WellKnownName>circle</WellKnownName><Fill><CssParameter name="fill">#0000FF</CssParameter></Fill></Mark><Size>20</Size></Graphic></PointSymbolizer></Rule></FeatureTypeStyle></UserStyle></NamedLayer></StyledLayerDescriptor>')},le=function(e,t){return"string"==typeof e?e:"OGC"===e.filterType?b.toOGCFilter(e.featureTypeName,h(h({},e),{},{options:t}),e.ogcVersion,e.sortOptions,e.hits):b.toCQLFilter(e)},ce=function(e){return"ilike"===e||"like"===e},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filterFields,r=void 0===t?[]:t,n=e.spatialField,i=void 0===n?{}:n,o=e.crossLayerFilter,a=void 0===o?{}:o;return!(r.filter((function(e){return e.value||0===e.value})).length>0||i.geometry||a&&a.attribute&&a.operation)},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.filterFields&&e.filterFields.length>0||e.simpleFilterFields&&e.simpleFilterFields.length>0||e.spatialField&&e.spatialField.geometry&&e.spatialField.operation||Object(p.isArray)(e.spatialField)&&Object(p.findIndex)(e.spatialField,(function(e){return e.operation&&e.geometry}))>-1||e.crossLayerFilter&&e.crossLayerFilter.collectGeometries&&e.crossLayerFilter.collectGeometries.queryCollection&&e.crossLayerFilter.collectGeometries.queryCollection.geometryName&&e.crossLayerFilter.collectGeometries.queryCollection.typeName},fe=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Object(p.flatten)(t.filter((function(e){return!!e})))},pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"AND",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"AND",n={id:(new Date).getTime(),index:0,logic:t};return e.reduce((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.filterFields,o=void 0===i?[]:i,a=t.groupFields,l=void 0===a?[]:a,c=t.spatialField,u=arguments.length>2?arguments[2]:void 0;return{groupFields:e.groupFields.concat(o.length>0&&l.map((function(e){return{groupId:0===e.index&&n.id||"".concat(e.groupId,"_").concat(u),logic:e.logic,id:"".concat(e.id,"_").concat(u),index:1+e.index}}))||[]),filterFields:e.filterFields.concat(o.map((function(e){return h(h({},e),{},{groupId:"".concat(e.groupId,"_").concat(u)})}))),spatialField:fe(e.spatialField,c),spatialFieldOperator:r}}),{groupFields:[n],filterFields:[],spatialField:[]})},de=function(e,t){var r,n=e.spatialField.geometry.projection,i=e.spatialField.geometry.center,o=e.spatialField.geometry.radius,a=Object(f.reprojectGeoJson)(e.spatialField.geometry,e.spatialField.geometry.projection||"EPSG:3857",t).coordinates,l=i&&[(r=Object(f.reproject)(i,n,t)).x,r.y],c=o&&Object(f.reproject)([o,0],n,t).x;return h(h({},e),{},{spatialField:h(h({},e.spatialField),{},{geometry:h(h({},e.spatialField.geometry),{},{center:l,radius:c,coordinates:a,projection:t})})})},ge=function(e,t){return e&&e.spatialField&&e.spatialField.geometry&&e.spatialField.geometry.coordinates&&e.spatialField.geometry.coordinates[0]&&(e.spatialField.projection||"EPSG:3857")!==t?t?b.reprojectFilterInNativeCrs(e,t):h(h({},e),{},{spatialField:void 0}):e},me=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.nsPlaceholder,r=void 0===t?"ogc":t,n=e.ogcVersion,o=void 0===n?"2.0":n,l=e.addXmlnsToRoot,u=void 0!==l&&l,f=e.xmlnsToAdd,g=void 0===f?[]:f,m=s()({filterNS:r,wfsVersion:o,gmlVersion:Object(i.wfsToGmlVersion)(o)}),h=c()(m),y=arguments.length,b=new Array(y>1?y-1:0),v=1;v<y;v++)b[v-1]=arguments[v];var O=m.filter(m.and.apply(m,d(Object(p.flatten)(b.filter((function(e){return!!e&&(Object(p.isString)(e)||se(e)&&!e.disabled)})).map((function(e){return Object(p.isString)(e)?[h(Object(a.read)(e))]:G(e,o,r)}))))));if(u){var S=O.indexOf(">");return"".concat(O.slice(0,S)).concat(g.length>0?" ".concat(g.join(" ")):"").concat(O.slice(S))}return O};b={processOGCFilterGroup:_,processOGCFilterFields:D,processOGCCrossLayerFilter:X,getGetFeatureBase:W,toOGCFilterParts:G,findSubGroups:te,toCQLFilter:z,getCrossLayerCqlFilter:H,processCQLFilterGroup:K,processCQLSimpleFilterField:ie,processCQLSpatialFilter:Y,processCQLFilterFields:ne,getCQLGeometryElement:Q,cqlStringField:$,cqlDateField:Z,cqlNumberField:ee,cqlBooleanField:J,cqlListField:re,toOGCFilter:R,reprojectFilterInNativeCrs:de,processOGCSpatialFilter:V,mergeFiltersToOGC:me}},"./MapStore2/web/client/utils/MapUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_SCREEN_DPI",(function(){return b})),r.d(t,"METERS_PER_UNIT",(function(){return v})),r.d(t,"GOOGLE_MERCATOR",(function(){return O})),r.d(t,"EXTENT_TO_ZOOM_HOOK",(function(){return S})),r.d(t,"ZOOM_TO_EXTENT_HOOK",(function(){return w})),r.d(t,"RESOLUTIONS_HOOK",(function(){return x})),r.d(t,"RESOLUTION_HOOK",(function(){return j})),r.d(t,"COMPUTE_BBOX_HOOK",(function(){return M})),r.d(t,"GET_PIXEL_FROM_COORDINATES_HOOK",(function(){return T})),r.d(t,"GET_COORDINATES_FROM_PIXEL_HOOK",(function(){return E})),r.d(t,"registerHook",(function(){return L})),r.d(t,"getHook",(function(){return C})),r.d(t,"executeHook",(function(){return I})),r.d(t,"clearHooks",(function(){return F})),r.d(t,"dpi2dpm",(function(){return A})),r.d(t,"dpi2dpu",(function(){return N})),r.d(t,"getSphericalMercatorScale",(function(){return G})),r.d(t,"getGoogleMercatorScale",(function(){return R})),r.d(t,"getSphericalMercatorScales",(function(){return _})),r.d(t,"getGoogleMercatorScales",(function(){return D})),r.d(t,"getResolutionsForScales",(function(){return U})),r.d(t,"getGoogleMercatorResolutions",(function(){return k})),r.d(t,"getResolutions",(function(){return B})),r.d(t,"getScales",(function(){return q})),r.d(t,"defaultGetZoomForExtent",(function(){return V})),r.d(t,"getZoomForExtent",(function(){return W})),r.d(t,"getCurrentResolution",(function(){return H})),r.d(t,"getCenterForExtent",(function(){return X})),r.d(t,"getBbox",(function(){return z})),r.d(t,"isNearlyEqual",(function(){return K})),r.d(t,"mapUpdated",(function(){return Q})),r.d(t,"transformExtent",(function(){return Y})),r.d(t,"groupSaveFormatted",(function(){return Z})),r.d(t,"saveMapConfiguration",(function(){return $})),r.d(t,"generateNewUUIDs",(function(){return J})),r.d(t,"mergeMapConfigs",(function(){return ee})),r.d(t,"addRootParentGroup",(function(){return te})),r.d(t,"isSimpleGeomType",(function(){return re})),r.d(t,"getSimpleGeomType",(function(){return ne})),r.d(t,"getIdFromUri",(function(){return ie})),r.d(t,"parseLayoutValue",(function(){return oe})),r.d(t,"prepareMapObjectToCompare",(function(){return ae})),r.d(t,"updateObjectFieldKey",(function(){return le})),r.d(t,"compareMapChanges",(function(){return ce})),r.d(t,"createRegisterHooks",(function(){return ue}));var n=r("./MapStore2/node_modules/lodash/lodash.js"),i=r("./MapStore2/node_modules/uuid/v1.js"),o=r.n(i),a=r("./MapStore2/web/client/utils/CoordinatesUtils.js"),l=r("./MapStore2/web/client/utils/ImmutableUtils.js"),c=r("./MapStore2/web/client/utils/LayersUtils.js"),u=r("./MapStore2/node_modules/object-assign/index.js"),s=r.n(u);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function d(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return g(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?m(Object(r),!0).forEach((function(t){y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=96,v={m:1,degrees:111194.87428468118,ft:.3048,"us-ft":1200/3937},O={RADIUS:6378137,TILE_WIDTH:256,ZOOM_FACTOR:2},S="EXTENT_TO_ZOOM_HOOK",w="ZOOM_TO_EXTENT_HOOK",x="RESOLUTIONS_HOOK",j="RESOLUTION_HOOK",M="COMPUTE_BBOX_HOOK",T="GET_PIXEL_FROM_COORDINATES_HOOK",E="GET_COORDINATES_FROM_PIXEL_HOOK",P={};function L(e,t){P[e]=t}function C(e){return P[e]}function I(e,t,r){var n=C(e);return n?t(n):r?r():null}function F(){P={}}function A(e){return e*(100/2.54)}function N(e,t){var r=Object(a.getUnits)(t||"EPSG:3857");return v[r]*A(e||b)}function G(e,t,r,n,i){return 2*Math.PI*e/(t*Math.pow(r,n)/A(i||b))}function R(e,t){return G(O.RADIUS,O.TILE_WIDTH,O.ZOOM_FACTOR,e,t)}function _(e,t,r,n,i,o){for(var a=[],l=n;l<=i;l++)a.push(G(e,t,r,l,o));return a}function D(e,t,r){return _(O.RADIUS,O.TILE_WIDTH,O.ZOOM_FACTOR,e,t,r)}function U(e,t,r){var n=N(r,t);return e.map((function(e){return e/n}))}function k(e,t,r){return U(D(e,t,r),"EPSG:3857",r)}function B(){return C("RESOLUTIONS_HOOK")?C("RESOLUTIONS_HOOK")():k(0,21,b)}function q(e,t){var r=N(t,e);return B().map((function(e){return e*r}))}function V(e,t,r,n,i,o){var a=e[2]-e[0],l=e[3]-e[1],c=Math.abs(a/t.width),u=Math.abs(l/t.height),s=Math.max(c,u),f=(o||U(D(r,n,i||b),"EPSG:3857",i)).reduce((function(e,t,r){var n=Math.abs(t-s);return n>e.diff?e:{diff:n,zoom:r}}),{diff:Number.POSITIVE_INFINITY,zoom:0}).zoom;return Math.max(0,Math.min(f,n))}function W(e,t,r,n,i){return C("EXTENT_TO_ZOOM_HOOK")?C("EXTENT_TO_ZOOM_HOOK")(e,t,r,n,i):V(e,t,r,n,i,C("RESOLUTIONS_HOOK")?C("RESOLUTIONS_HOOK")(e,t,r,n,i,A(i||b)):null)}function H(e,t,r,n){return C("RESOLUTION_HOOK")?C("RESOLUTION_HOOK")(e,t,r,n):k(t,r,n)[e]}function X(e,t){var r=(e[2]-e[0])/2,n=(e[3]-e[1])/2;return{x:e[0]+r,y:e[1]+n,crs:t}}function z(e,t){return I("COMPUTE_BBOX_HOOK",(function(r){return r(e,t)}))}var K=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0};function Q(e,t){var r,i,o,a;return!(!e||Object(n.isEmpty)(e)||!t||Object(n.isEmpty)(t))&&(!(K(null==t||null===(r=t.center)||void 0===r?void 0:r.x,null==e||null===(i=e.center)||void 0===i?void 0:i.x)&&K(null==t||null===(o=t.center)||void 0===o?void 0:o.y,null==e||null===(a=e.center)||void 0===a?void 0:a.y))||(null==t?void 0:t.zoom)!==(null==e?void 0:e.zoom))}function Y(e,t,r,n){var i=Object(a.getUnits)(e);return"ft"===i?{width:r/v.ft,height:n/v.ft}:"us-ft"===i?{width:r/v["us-ft"],height:n/v["us-ft"]}:"degrees"===i?{width:r/(111132.92-559.82*Math.cos(2*t.y)+1.175*Math.cos(4*t.y)),height:n/(111412.84*Math.cos(t.y)-93.5*Math.cos(3*t.y))}:{width:r,height:n}}var Z=function(e){return{id:e.id,title:e.title,description:e.description,tooltipOptions:e.tooltipOptions,tooltipPlacement:e.tooltipPlacement,expanded:e.expanded}};function $(e,t,r,i,o,a,u){var f={center:e.center,maxExtent:e.maxExtent,projection:e.projection,units:e.units,mapInfoControl:e.mapInfoControl,zoom:e.zoom,mapOptions:e.mapOptions||{}},p=t.map((function(e){return Object(c.saveLayer)(e)})),d=r.reduce((function(e,t){return e.concat(Object(c.getGroupNodes)(t))}),[].concat(r.map((function(e){return e.id})))).map((function(e){var t=Object(c.getNode)(r,e);return t&&t.nodes?Z(t):null})).filter((function(e){return e})),g=i.filter((function(e){return!!e.thumbnail})),m=Object(c.extractSourcesFromLayers)(p),y=p.map((function(e){return s()({},e,{tileMatrixSet:e.tileMatrixSet&&e.tileMatrixSet.length>0,matrixIds:e.matrixIds&&Object.keys(e.matrixIds)})})),b=Object(n.findIndex)(y,(function(e){return"annotations"===e.id}));if(-1!==b){var v=y[b].features.map((function(e){return"FeatureCollection"===e.type?h(h({},e),{},{features:e.features.map((function(e){return e.properties.geometryGeodesic?Object(l.e)("properties.geometryGeodesic",null,e):e}))}):e.properties.geometryGeodesic?Object(l.e)("properties.geometryGeodesic",null,e):{}}));y[b]=Object(l.e)("features",v,y[b])}return h({version:2,map:s()({},f,{layers:y,groups:d,backgrounds:g,text_search_config:o,bookmark_search_config:a},!Object(n.isEmpty)(m)&&{sources:m}||{})},u)}var J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(n.cloneDeep)(e),r=h(h({},Object(n.get)(e,"map.layers",[]).reduce((function(e,t){return h(h({},e),{},y({},t.id,"annotations"===t.id?t.id:o()()))}),{})),Object(n.get)(e,"widgetsConfig.widgets",[]).reduce((function(e,t){return h(h({},e),{},y({},t.id,o()()))}),{}));return Object(l.e)("map.backgrounds",Object(n.get)(e,"map.backgrounds",[]).map((function(e){return h(h({},e),{},{id:r[e.id]})})),Object(l.e)("widgetsConfig",{collapsed:Object(n.mapValues)(Object(n.mapKeys)(Object(n.get)(e,"widgetsConfig.collapsed",{}),(function(e,t){return r[t]})),(function(e){return h(h({},e),{},{layouts:Object(n.mapValues)(e.layouts,(function(e){return h(h({},e),{},{i:r[e.i]})}))})})),layouts:Object(n.mapValues)(Object(n.get)(e,"widgetsConfig.layouts",{}),(function(e){return e.map((function(e){return h(h({},e),{},{i:r[e.i]})}))})),widgets:Object(n.get)(e,"widgetsConfig.widgets",[]).map((function(e){return h(h({},e),{},{id:r[e.id],layer:h(h({},Object(n.get)(e,"layer",{})),{},{id:r[Object(n.get)(e,"layer.id")]})})}))},Object(l.e)("map.layers",Object(n.get)(e,"map.layers",[]).map((function(e){return h(h({},e),{},{id:r[e.id]})})),t)))},ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return Object(n.pick)(e,Object(n.keys)(e).filter((function(t){return void 0!==e[t]})))}))},i=J(t),o=[].concat(d(Object(n.get)(e,"map.backgrounds",[])),d(Object(n.get)(i,"map.backgrounds",[]))),a=r(Object(n.get)(e,"map.layers",[])),l=r(Object(n.get)(i,"map.layers",[])),c=Object(n.find)(a,(function(e){return"annotations"===e.id})),u=Object(n.find)(l,(function(e){return"annotations"===e.id})),s=[].concat(d(l.filter((function(e){return"annotations"!==e.id}))),d(a.filter((function(e){return"annotations"!==e.id}))),d(c||u?[h(h(h({},c||{}),u||{}),{},{features:[].concat(d(Object(n.get)(c,"features",[])),d(Object(n.get)(u,"features",[])))})]:[])),f=s.filter((function(e){return"background"===e.group})),p=Object(n.findIndex)(f,(function(e){return e.visibility})),g=Object(n.get)(e,"map.sources",{}),m=Object(n.get)(i,"map.sources",{}),b=h(h({},g),m),v=Object(n.get)(e,"widgetsConfig",{}),O=Object(n.get)(i,"widgetsConfig",{});return h(h(h({},i),e),{},{catalogServices:h(h({},Object(n.get)(e,"catalogServices",{})),{},{services:h(h({},Object(n.get)(e,"catalogServices.services",{})),Object(n.get)(i,"catalogServices.services",{}))}),map:h(h(h({},i.map),e.map),{},{backgrounds:o,groups:Object(n.uniqWith)([].concat(d(Object(n.get)(e,"map.groups",[])),d(Object(n.get)(i,"map.groups",[]))),(function(e,t){return e.id===t.id})),layers:[].concat(d(f.slice(0,p+1)),d(f.slice(p+1).map((function(e){return h(h({},e),{},{visibility:!1})}))),d(s.filter((function(e){return"background"!==e.group})))),sources:Object(n.isEmpty)(b)?void 0:b}),widgetsConfig:{collapsed:h(h({},v.collapsed),O.collapsed),layouts:Object(n.uniq)([].concat(d(Object(n.keys)(v.layouts)),d(Object(n.keys)(O.layouts)))).reduce((function(e,t){return h(h({},e),{},y({},t,[].concat(d(Object(n.get)(v,"layouts.".concat(t),[])),d(Object(n.get)(O,"layouts.".concat(t),[])))))}),{}),widgets:[].concat(d(Object(n.get)(v,"widgets",[])),d(Object(n.get)(O,"widgets",[])))},timelineData:h(h({},Object(n.get)(e,"timelineData",{})),Object(n.get)(i,"timelineData",{})),dimensionData:h(h({},Object(n.get)(e,"dimensionData",{})),Object(n.get)(i,"dimensionData",{}))})},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RootGroup",r=Object(n.get)(e,"map.groups",[]),i=r.filter((function(e){return"Default"!==e.id})),a=Object(n.find)(r,(function(e){return"Default"===e.id})),l=a&&{id:o()(),title:t,expanded:a.expanded},c=a?[].concat(d(i.map((function(e){var t=e.id,r=p(e,["id"]);return h({id:"".concat(l.id,".").concat(t)},r)}))),[l]):i;return h(h({},e),{},{map:h(h({},e.map),{},{groups:c,layers:Object(n.get)(e,"map.layers",[]).map((function(e){var t,r=e.group;return h(h({},p(e,["group"])),{},{group:!a||"background"===r||"Default"!==r&&r?a&&(null===(t=Object(n.find)(c,(function(e){var t=e.id;return t.slice(t.indexOf(".")+1)===r})))||void 0===t?void 0:t.id)||r:l.id})}))})})};function re(e){switch(e){case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":case"Text":return!1;case"Point":case"Circle":case"LineString":case"Polygon":default:return!0}}function ne(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Point";switch(e){case"Point":case"LineString":case"Polygon":case"Circle":return e;case"MultiPoint":case"Marker":return"Point";case"MultiLineString":return"LineString";case"MultiPolygon":return"Polygon";case"GeometryCollection":return"GeometryCollection";case"Text":return"Point";default:return e}}var ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/data\/(\d+)/,r=decodeURIComponent(e),n=t.exec(r);return n&&n.length&&n.length>1?n[1]:null},oe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(n.isString)(e)&&-1!==e.indexOf("%")?parseFloat(Object(n.trim)(e))*t/100:Object(n.isNumber)(e)?e:0},ae=function e(t){var r=["apiKey","time","args","fixed"],n=function(e){return r.reduce((function(t,r){return t||e===r}),!1)};Object.keys(t).forEach((function(r){var i=t[r],o=f(i);"object"!==o||null===i||n(r)?"undefined"!==o&&i&&!n(r)||delete t[r]:(e(i),Object.keys(i).length||delete t[r])}))},le=function(e,t,r){e[t]&&(Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(e,t)),delete e[t])},ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=["map.layers","map.backgrounds","map.text_search_config","map.bookmark_search_config","map.text_serch_config","map.zoom","widgetsConfig"],i=Object(n.pick)(Object(n.cloneDeep)(e),r),o=Object(n.pick)(Object(n.cloneDeep)(t),r);return le(i.map,"text_serch_config","text_search_config"),le(o.map,"text_serch_config","text_search_config"),ae(i),ae(o),Object(n.isEqual)(i,o)},ue=function(){var e={};return{registerHook:function(t,r){e[t]=r},getHook:function(t){return e[t]},executeHook:function(t,r,n){var i=e[t];return i?r(i):n?n():null}}};t.default={createRegisterHooks:ue,EXTENT_TO_ZOOM_HOOK:S,RESOLUTIONS_HOOK:x,RESOLUTION_HOOK:j,COMPUTE_BBOX_HOOK:M,GET_PIXEL_FROM_COORDINATES_HOOK:T,GET_COORDINATES_FROM_PIXEL_HOOK:E,DEFAULT_SCREEN_DPI:b,ZOOM_TO_EXTENT_HOOK:w,registerHook:L,getHook:C,dpi2dpm:A,getSphericalMercatorScales:_,getSphericalMercatorScale:G,getGoogleMercatorScales:D,getGoogleMercatorResolutions:k,getGoogleMercatorScale:R,getResolutionsForScales:U,getZoomForExtent:W,defaultGetZoomForExtent:V,getCenterForExtent:X,getResolutions:B,getScales:q,getBbox:z,mapUpdated:Q,getCurrentResolution:H,transformExtent:Y,saveMapConfiguration:$,generateNewUUIDs:J,mergeMapConfigs:ee,addRootParentGroup:te,isSimpleGeomType:re,getSimpleGeomType:ne,getIdFromUri:ie,parseLayoutValue:oe,prepareMapObjectToCompare:ae,updateObjectFieldKey:le,compareMapChanges:ce,clearHooks:F}},"./MapStore2/web/client/utils/ProxyUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"needProxy",(function(){return o})),r.d(t,"getProxyUrl",(function(){return a}));var n=r("./MapStore2/web/client/utils/ConfigUtils.js"),i=r("./MapStore2/node_modules/lodash/lodash.js"),o=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(Object(i.isArray)(t))return t.reduce((function(t,r){return e(r)&&t}),!0);var o=!1,a=!(0===t.indexOf("http")),l=!a&&t.match(/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/);if(l){var c=window.location;a=l[1]===c.protocol&&l[3]===c.hostname;var u=l[4],s=c.port;(80!==u&&""!==u||"80"!==s&&""!==s)&&(a=a&&u===s)}if(!a){var f=n.default.getProxyUrl(r);if(f){var p=[];Object(i.isObject)(f)&&(p=f.useCORS||[],f=f.url);var d=p.reduce((function(e,r){return e||0===t.indexOf(r)}),!1);d||(o=!0)}}return o},a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.default.getProxyUrl(e);return t&&Object(i.isObject)(t)&&(t=t.url),t}},"./MapStore2/web/client/utils/VendorParamsUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"optionsToVendorParams",(function(){return l}));var n=r("./MapStore2/web/client/utils/FilterUtils.js");r("./MapStore2/web/client/utils/ConfigUtils.js");function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var l=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=t.layerFilter,a=t.filterObj,l=[Object(n.isFilterValid)(i)&&!i.disabled&&Object(n.toCQLFilter)(i),Object(n.isFilterValid)(a)&&Object(n.toCQLFilter)(a),t&&t.params&&t.params.CQL_FILTER,r];return(e=(l=l.filter((function(e){return!!e}))).length>1?l.map((function(e){return"(".concat(e,")")})).join(" AND "):l.pop())?o(o({},t.params),{},{CQL_FILTER:e}):t.params}},"./MapStore2/web/client/utils/WMTSUtils.js":function(e,t,r){"use strict";r.r(t),r.d(t,"getDefaultMatrixId",(function(){return u})),r.d(t,"getMatrixIds",(function(){return s})),r.d(t,"limitMatrix",(function(){return f})),r.d(t,"getTileMatrixSet",(function(){return p})),r.d(t,"getRequestEncoding",(function(){return d})),r.d(t,"getOperations",(function(){return g})),r.d(t,"getOperation",(function(){return m})),r.d(t,"getGetTileURL",(function(){return h})),r.d(t,"getCapabilitiesURL",(function(){return y})),r.d(t,"getDefaultStyleIdentifier",(function(){return b})),r.d(t,"getDefaultFormat",(function(){return v})),r.d(t,"sortTileMatrix",(function(){return O})),r.d(t,"getTileMatrix",(function(){return S}));var n,i=r("./MapStore2/web/client/utils/CoordinatesUtils.js"),o=r("./MapStore2/node_modules/lodash/lodash.js");function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){c(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var u=function(e){for(var t=new Array(30),r=0;r<30;++r)t[r]=e.tileMatrixPrefix+r;return t},s=function(e,t){return Object(o.isObject)(e)&&Object(o.isArray)(e[t])&&e[t]||Object(o.isArray)(e)&&e||[]},f=function(e,t){return e.length>t?Object(o.slice)(e,0,t):e.length<t?e.concat(new Array(t-e.length)):e},p=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:t;return e&&Object(o.isString)(e)?e:e?Object(i.getEquivalentSRS)(t,r).reduce((function(t,r){if(Object(o.isArray)(e)){var a=Object(o.head)(e.filter((function(e){return(e["ows:Identifier"]===r||Object(i.getEPSGCode)(e["ows:SupportedCRS"])===r)&&n[e["ows:Identifier"]]})));return a&&a["ows:Identifier"]?a["ows:Identifier"]:t}return Object(o.isObject)(e)&&e[r]||t}),a):a},d=function(e){var t=n.getOperations(e);return n.getOperation(t,"GetTile","KVP")?"KVP":n.getOperation(t,"GetTile","RESTful")&&"RESTful"},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o.castArray)(e.Capabilities["ows:OperationsMetadata"]["ows:Operation"])},m=function(e,t,r){return Object(o.head)(Object(o.castArray)(Object(o.head)(e.filter((function(e){return e.$.name===t})).map((function(e){return Object(o.castArray)(e["ows:DCP"]["ows:HTTP"]["ows:Get"])})))||[]).filter((function(e){return(e["ows:Constraint"]&&e["ows:Constraint"]["ows:AllowedValues"]["ows:Value"])===r})).map((function(e){return e.$["xlink:href"]})))},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.ResourceURL,r=e.GetTileURL,n=e.requestEncoding;return"KVP"===n?r:t&&Object(o.castArray)(t).map((function(e){var t=e.$,r=void 0===t?{}:t;return r.template||r.value}))||r},y=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(o.head)(Object(o.castArray)(e.capabilitiesURL||e.GetTileURL))},b=function(e){return Object(o.head)(Object(o.castArray)(e.Style).filter((function(e){var t=e.$;return"true"===(void 0===t?{}:t).isDefault})).map((function(e){return e["ows:Identifier"]})))},v=function(e){return Object(o.head)(Object(o.castArray)(e.Format))},O=function(e,t){return e?l(l({},e),{},{TileMatrix:Object(o.sortBy)(null==e?void 0:e.TileMatrix.map((function(e){return l(l({},e),{},{ScaleDenominator:Number(e.ScaleDenominator)})})),"ScaleDenominator").reverse().filter((function(e){return!t||t.map((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.identifier;return t})).indexOf(e["ows:Identifier"])>=0}))}):e},S=function(e,t){var r,n,i=p(e.tileMatrixSet,t,e.allowedSRS,e.matrixIds),a=e.matrixIds&&s(e.matrixIds,i||t),l=O(Object(o.head)(e.tileMatrixSet.filter((function(e){return e["ows:Identifier"]===i}))),a),c=null==l||null===(r=(n=l.TileMatrix).map)||void 0===r?void 0:r.call(n,(function(e){return e["ows:Identifier"]}));return{matrixIds:c&&a?a.sort((function(e,t){return c.indexOf(e.identifier)-c.indexOf(t.identifier)})):a,tileMatrixSetName:i,tileMatrixSet:l}};n={getOperations:g,getOperation:m}},"./MapStore2/web/client/utils/cesium/BILTerrainProvider.js":function(e,t){e.exports=function(e){var t={};t.CRS=[{name:"CRS:84",ellipsoid:e.Ellipsoid.WGS84,firstAxeIsLatitude:!1,tilingScheme:e.GeographicTilingScheme,supportedCRS:"urn:ogc:def:crs:OGC:2:84"},{name:"EPSG:4326",ellipsoid:e.Ellipsoid.WGS84,firstAxeIsLatitude:!0,tilingScheme:e.GeographicTilingScheme,SupportedCRS:"urn:ogc:def:crs:EPSG::4326"},{name:"EPSG:3857",ellipsoid:e.Ellipsoid.WGS84,firstAxeIsLatitude:!1,tilingScheme:e.WebMercatorTilingScheme,SupportedCRS:"urn:ogc:def:crs:EPSG::3857"},{name:"OSGEO:41001",ellipsoid:e.Ellipsoid.WGS84,firstAxeIsLatitude:!1,tilingScheme:e.WebMercatorTilingScheme,SupportedCRS:"urn:ogc:def:crs:EPSG::3857"}],t.FormatImage=[{format:"image/png",extension:"png"},{format:"image/jpeg",extension:"jpg"},{format:"image/jpeg",extension:"jpeg"},{format:"image/gif",extension:"gif"},{format:"image/png; mode=8bit",extension:"png"}],t.FormatArray=[{format:"image/bil",postProcessArray:function(e,t,r,n,i){var o,a=new DataView(e),l=new ArrayBuffer(t.height*t.width*2),c=new DataView(l);if(l.byteLength===e.byteLength){for(var u,s=0;s<l.byteLength;s+=2)(u=a.getInt16(s,!1)-i)>n&&u<r?(c.setInt16(s,u,!0),u):c.setInt16(s,0,!0);o=new Int16Array(l)}return o}}],t.WMSParser={},t.TMSParser={},t.WMTSParser={},t.parser=function(r){var n;switch((r=e.defaultValue(r,e.defaultValue.EMPTY_OBJECT)).service){case"TMS":n=t.TMSParser.generate(r);break;case"WMTS":n=t.WMTSParser.generate(r);break;default:n=t.WMSParser.generate(r)}return n},t.WMSParser.generate=function(r){var n;if(r=e.defaultValue(r,e.defaultValue.EMPTY_OBJECT),e.defined(r.url)){var i=r.url,o=i.lastIndexOf("?");o>-1&&(i=i.substring(0,o));var a=i+"?SERVICE=WMS&REQUEST=GetCapabilities&tiled=true";e.defined(r.proxy)&&(a=r.proxy.getURL(a)),n=e.when(e.loadXML(a),(function(e){return t.WMSParser.getMetaDatafromXML(e,r)}))}else{if(!e.defined(r.xml))throw new e.DeveloperError("either description.url or description.xml are required.");n=t.WMSParser.getMetaDatafromXML(r.xml,r)}return n},t.WMSParser.getMetaDatafromXML=function(r,n){if(!(r instanceof XMLDocument))throw new e.DeveloperError("xml must be a XMLDocument");if(!e.defined(n.layerName))throw new e.DeveloperError("description.layerName is required.");var i={},o=n.layerName,a=(e.defaultValue(n.maxLevel,11),void 0);i.heightMapWidth=e.defaultValue(n.heightMapWidth,65),i.heightMapHeight=e.defaultValue(n.heightMapHeight,i.heightMapWidth);var l={width:65,height:65},c=void 0;i.formatImage=n.formatImage,i.formatArray=n.formatArray,i.tilingScheme=void 0;var u=void 0,s=void 0;i.ready=!1,i.levelZeroMaximumGeometricError=void 0,i.waterMask=e.defaultValue(n.waterMask,!1),"boolean"!=typeof i.waterMask&&(i.waterMask=!1),i.offset=e.defaultValue(n.offset,0),i.highest=e.defaultValue(n.highest,12e3),i.lowest=e.defaultValue(n.lowest,-500);var f=n.styleName;i.hasStyledImage=e.defaultValue(n.hasStyledImage,"string"==typeof n.styleName);var p=r.querySelector("[version]");null!==p&&(a=p.getAttribute("version"),s=/^1\.[3-9]\./.test(a));var d=r.querySelector("Request>GetMap OnlineResource").getAttribute("xlink:href"),g=d.indexOf("?");g>-1&&(d=d.substring(0,g)),e.defined(n.proxy)&&(d=n.proxy.getURL(d));var m=r.querySelectorAll("Request>GetMap>Format");if(!e.defined(i.formatImage))for(var h=0;h<m.length&&!e.defined(i.formatArray);h++){(y=t.FormatArray.filter((function(e){return e.format===m[h].textContent}))).length>0&&(i.formatArray=y[0])}e.defined(i.formatArray)&&"string"==typeof i.formatArray.format&&"function"==typeof i.formatArray.postProcessArray?i.formatArray.terrainDataStructure={heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1}:i.formatArray=void 0;for(h=0;h<m.length&&!e.defined(i.formatImage);h++){var y;(y=t.FormatImage.filter((function(e){return e.format===m[h].textContent}))).length>0&&(i.formatImage=y[0])}e.defined(i.formatImage)&&"string"==typeof i.formatImage.format?i.formatImage.terrainDataStructure={heightScale:1,heightOffset:0,elementsPerHeight:2,stride:4,elementMultiplier:256,isBigEndian:!0}:i.formatImage=void 0;for(var b,v=r.querySelectorAll("Layer[queryable='1'],Layer[queryable='true']"),O=0;O<v.length&&!e.defined(b);O++)if(v[O].querySelector("Name").textContent===o){var S=(b=v[O]).getAttribute("fixedHeight"),w=b.getAttribute("fixedWidth");e.defined(S)&&(S=parseInt(S),i.heightMapHeight=S>0&&S<i.heightMapHeight?S:i.heightMapHeight,l.height=S>0?S:l.height),e.defined(w)&&(w=parseInt(w),i.heightMapWidth=w>0&&w<i.heightMapWidth?w:i.heightMapWidth,l.width=w>0?w:l.width)}if(e.defined(b)&&e.defined(a)){for(var x=!1,j=0;j<t.CRS.length&&!x;j++){var M=t.CRS[j],T=M.name,E=b.querySelector("BoundingBox[SRS='"+T+"'],BoundingBox[CRS='"+T+"']");if(null!==E){var P,L,C,I;c=T,u=M.firstAxeIsLatitude,i.tilingScheme=new M.tilingScheme({ellipsoid:M.ellipsoid}),u&&s?(P=parseFloat(E.getAttribute("miny")),L=parseFloat(E.getAttribute("maxy")),C=parseFloat(E.getAttribute("minx")),I=parseFloat(E.getAttribute("maxx"))):(P=parseFloat(E.getAttribute("minx")),L=parseFloat(E.getAttribute("maxx")),C=parseFloat(E.getAttribute("miny")),I=parseFloat(E.getAttribute("maxy")));new e.Rectangle(P,C,L,I);i.getTileDataAvailable=function(e,t,r){return!0},x=!0}}if(e.defined(f)){for(var F=b.querySelectorAll("Style>Name"),A=!1,N=0;N<F.length&&!A;N++)f===F[N].textContent&&(A=!0);A||(f=void 0)}for(var G=r.querySelectorAll("VendorSpecificCapabilities>TileSet"),R=!1,_=0;_<G.length&&!R;_++){var D=null!==G[_].querySelector("BoundingBox[SRS='"+c+"'],BoundingBox[CRS='"+c+"']");G[_].querySelector("Layers").textContent===o&&D&&(l.width=parseInt(G[_].querySelector("Width").textContent),l.height=parseInt(G[_].querySelector("Height").textContent),R=!0)}i.ready=x&&(e.defined(i.formatImage)||e.defined(i.formatArray))&&e.defined(a)}if(i.ready){var U=d+"?SERVICE=WMS&REQUEST=GetMap&layers="+o+"&version="+a+"&bbox=";if(U+=s&&u?"{south},{west},{north},{east}":"{west},{south},{east},{north}",U+="&crs="+c+"&srs="+c,i.formatImage){var k=U+"&format="+i.formatImage.format+"&width="+l.width+"&height="+l.height;e.defined(f)&&(k+="&styles="+f+"&style="+f),i.URLtemplateImage=function(){return k},i.imageSize=l}if(i.formatArray){var B=U+"&format="+i.formatArray.format+"&width="+i.heightMapWidth+"&height="+i.heightMapHeight;i.URLtemplateArray=function(){return B}}}return i},t.TMSParser.generate=function(r){var n;if(r=e.defaultValue(r,e.defaultValue.EMPTY_OBJECT),e.defined(r.url))n=e.loadXML(r.url).then((function(e){return t.TMSParser.parseXML(e,r)}));else{if(!e.defined(r.xml))throw new e.DeveloperError("either description.url or description.xml are required.");n=t.TMSParser.parseXML(r.xml,r)}return n},t.TMSParser.parseXML=function(r,n){if(!(r instanceof XMLDocument))throw new e.DeveloperError("xml must be a XMLDocument");var i;if(null!=r.querySelector("TileMapService")){if(!e.defined(n.layerName))throw new e.DeveloperError("layerName is required.");var o=[].slice.apply(r.querySelectorAll("TileMap[title='"+n.layerName+"']")).map((function(r){var i=r.getAttribute("href");return e.defined(n.proxy)&&(i=n.proxy.getURL(i)),e.when(e.loadXML(i),(function(e){return t.TMSParser.getMetaDatafromXML(e,n)}))}));i=e.when.all(o).then((function(t){for(var r,n=0;n<t.length&&!e.defined(r);n++)e.defined(t[n])&&(r=t[n]);return r})).then((function(e){return e}))}else i=t.TMSParser.getMetaDatafromXML(r,n);return i},t.TMSParser.getMetaDatafromXML=function(r,n){var i={ready:!1};i.heightMapWidth=e.defaultValue(n.heightMapWidth,65),i.heightMapHeight=e.defaultValue(n.heightMapHeight,i.heightMapWidth);var o=e.defaultValue(n.maxLevel,11),a=n.proxy;i.hasStyledImage=e.defaultValue(n.hasStyledImage,"string"==typeof n.styleName),i.waterMask=e.defaultValue(n.waterMask,!1),"boolean"!=typeof i.waterMask&&(i.waterMask=!1),i.offset=e.defaultValue(n.offset,0),i.highest=e.defaultValue(n.highest,12e3),i.lowest=e.defaultValue(n.lowest,-500);var l=r.querySelector("SRS").textContent,c=t.CRS.filter((function(e){return e.name===l}));c.length>0&&(i.tilingScheme=new c[0].tilingScheme({ellipsoid:c[0].ellipsoid}));var u=r.querySelector("TileFormat"),s=t.FormatImage.filter((function(e){return e.extension==u.getAttribute("extension")}));s.length>0&&(i.formatImage=s[0],i.imageSize={},i.imageSize.width=parseInt(u.getAttribute("width")),i.imageSize.height=parseInt(u.getAttribute("height")));var f=[].slice.call(r.querySelectorAll("TileSets>TileSet")),p=[];if(e.defined(i.formatImage)&&((p=f.map((function(t){var r=t.getAttribute("href")+"/{x}/{tmsY}."+i.formatImage.extension;return e.defined(a)&&(r=a.getURL(r)),{url:r,level:parseInt(t.getAttribute("order"))}}))).sort((function(e,t){return e.level-t.level})),p.length>0&&(i.tileSets=p)),e.defined(i.tileSets)&&e.defined(i.formatImage)&&e.defined(i.tilingScheme)){i.URLtemplateImage=function(e,t,r){var n="";return r<p.length&&(n=p[r].url),n};var d=r.querySelector("BoundingBox"),g=parseFloat(d.getAttribute("miny")),m=parseFloat(d.getAttribute("maxy")),h=parseFloat(d.getAttribute("minx")),y=parseFloat(d.getAttribute("maxx")),b=new e.Rectangle(h,g,y,m);i.getTileDataAvailable=function(t,r,n){var a,l,c,u,s,f,d=i.tilingScheme.tileXYToNativeRectangle(t,r,n),g=(a=b,l=d,c=Math.max(a.west,l.west),u=Math.min(a.east,l.east),s=Math.max(a.south,l.south),f=Math.min(a.north,l.north),u<=c||s>=f?void 0:new e.Rectangle(c,s,u,f));return e.defined(g)&&n<o&&n<p.length},i.ready=!0}else i=void 0;return i},t.WMTSParser.generate=function(r){var n;if(r=e.defaultValue(r,e.defaultValue.EMPTY_OBJECT),e.defined(r.url)){var i=r.url,o=i.lastIndexOf("?");o>-1&&(i=i.substring(0,o));var a=i+"?REQUEST=GetCapabilities";e.defined(r.proxy)&&(a=r.proxy.getURL(a)),n=e.loadXML(a).then((function(e){return t.WMTSParser.getMetaDatafromXML(e,r)}))}else{if(!e.defined(r.xml))throw new e.DeveloperError("either description.url or description.xml are required.");n=t.WMTSParser.getMetaDatafromXML(r.xml,r)}return n},t.WMTSParser.getMetaDatafromXML=function(r,n){if(!(r instanceof XMLDocument))throw new e.DeveloperError("xml must be a XMLDocument");var i={},o=n.layerName;i.ready=!1,i.heightMapWidth=e.defaultValue(n.heightMapWidth,65),i.heightMapHeight=e.defaultValue(n.heightMapHeight,i.heightMapWidth);var a,l=e.defaultValue(n.maxLevel,12),c=n.proxy,u=n.styleName;i.hasStyledImage=e.defaultValue(n.hasStyledImage,"string"==typeof n.styleName),i.waterMask=e.defaultValue(n.waterMask,!1),"boolean"!=typeof i.waterMask&&(i.waterMask=!1),i.offset=e.defaultValue(n.offset,0),i.highest=e.defaultValue(n.highest,12e3),i.lowest=e.defaultValue(n.lowest,-500);for(var s,f,p,d=[],g=[].slice.call(r.querySelectorAll('Operation[name="GetTile"] HTTP Get')).map((function(e){var t,r=e.querySelector("Value").textContent;return"KVP"===r&&(t={node:e,type:"KVP"}),"RESTful"===r&&(t={node:e,type:"RESTful"}),t})).filter((function(t){return e.defined(t)})),m=0;m<g.length;m++){var h=g[m];"RESTful"!==h.type||e.defined(f)||(f=h.node.getAttribute("xlink:href"),e.defined(c)&&(f=c.getURL(f))),"KVP"!==h.type||e.defined(s)||(s=h.node.getAttribute("xlink:href"),e.defined(c)&&(s=c.getURL(s)))}var y,b=r.querySelectorAll("Contents>Layer>Identifier");for(m=0;m<b.length&&!e.defined(y);m++)o===b[m].textContent&&(y=b[m].parentNode);if(e.defined(y)){var v,O,S=y.querySelectorAll("Style");for(m=0;m<S.length;m++){var w=S[m].querySelector("Identifier").textContent;null!=S[m].getAttribute("isDefault")&&(v=w),w===u&&(O=w)}e.defined(u)&&u==O||(u=e.defaultValue(v,""));for(var x=[].slice.call(y.querySelectorAll("Format")),j=0;j<t.FormatImage.length&&!e.defined(p);j++){x.filter((function(e){return e.textContent===t.FormatImage[j].format})).length>0&&(p=t.FormatImage[j])}d=y.querySelectorAll("TileMatrixSetLink")}for(var M=[].slice.call(r.querySelectorAll("TileMatrixSet>Identifier")),T=0;T<d.length&&!i.ready;T++){var E,P,L=d[T],C=L.querySelector("TileMatrixSet").textContent;for(m=0;m<M.length&&!e.defined(E);m++)M[m].textContent===C&&(E=M[m].parentNode);for(var I=E.querySelector("SupportedCRS").textContent,F=0;F<t.CRS.length&&!e.defined(P);F++)t.CRS[F].SupportedCRS===I&&(P=t.CRS[F]);if(e.defined(P)){var A,N=[].slice.call(E.querySelectorAll("TileMatrix"));(A=N.map((function(e){var t=e.querySelector("Identifier").textContent,r=parseInt(e.querySelector("MatrixWidth").textContent),n=parseInt(e.querySelector("MatrixHeight").textContent),i=parseInt(e.querySelector("TileWidth").textContent),o=parseInt(e.querySelector("TileHeight").textContent);return{id:t,maxWidth:r,maxHeight:n,scaleDenominator:parseFloat(e.querySelector("ScaleDenominator").textContent),complete:!1,tileWidth:i,tileHeight:o}}))).sort((function(e,t){return t.scaleDenominator-e.scaleDenominator})),listTileMatrixLimits=L.querySelectorAll("TileMatrixSetLimits>TileMatrixLimits");for(var G=0;G<A.length;G++)for(var R=A[G],_=0;_<listTileMatrixLimits.length;_++){var D=listTileMatrixLimits[_];R.id===D.querySelector("TileMatrix").textContent&&(R.minTileRow=parseInt(D.querySelector("MinTileRow").textContent),R.maxTileRow=parseInt(D.querySelector("MaxTileRow").textContent),R.minTileCol=parseInt(D.querySelector("MinTileCol").textContent),R.maxTileCol=parseInt(D.querySelector("MaxTileCol").textContent),R.complete=!0,A[G]=R)}if(A.length>0){i.tilingScheme=new P.tilingScheme({ellipsoid:P.ellipsoid,numberOfLevelZeroTilesX:A[0].maxWidth,numberOfLevelZeroTilesY:A[0].maxHeight});var U=y.querySelector("ResourceURL[format='"+p.format+"']");if(null!=U?a=U.getAttribute("template").replace("{TileRow}","{y}").replace("{TileCol}","{x}").replace("{Style}",u).replace("{TileMatrixSet}",C).replace("{layer}",o).replace("{infoFormatExtension}",p.extension):e.defined(s)&&(a=s+"service=WMTS&request=GetTile&version=1.0.0&layer="+o+"&style=&"+u+"format="+p.format+"&TileMatrixSet="+C+"&TileMatrix={TileMatrix}&TileRow={y}&TileCol={x}"),e.defined(a)){i.getTileDataAvailable=function(e,t,r){var n=!1;if(r<l&&r<A.length){var i=A[r];n=i.complete?t<=i.maxTileRow&&t>=i.minTileRow&&e<=i.maxTileCol&&e>=i.minTileCol:e<i.maxWidth&&t<i.maxHeight}return n},i.URLtemplateImage=function(e,t,r){var n="";if(i.getTileDataAvailable(e,t,r)){var o=A[r];n=a.replace("{TileMatrix}",o.id)}return n};var k={width:A[0].tileWidth,height:A[0].tileHeight};0==A.filter((function(e){return e.tileWidth!=k.width||e.tileHeight!=k.height})).length&&(i.imageSize=k),i.ready=!0}}}}return i};var r=function(r){if(!e.defined(r))throw new e.DeveloperError("description is required.");var i=new e.Event,o=r.credit;"string"==typeof o&&(o=new e.Credit(o)),this.ready=!1,e.defineProperties(this,{errorEvent:{get:function(){return i}},credit:{get:function(){return o}},hasVertexNormals:{get:function(){return!1}}}),n(t.parser(r),this)};function n(t,n){e.when(t,(function(t){e.defined(t)&&t.ready&&(t.levelZeroMaximumGeometricError=e.TerrainProvider.getEstimatedLevelZeroGeometricErrorForAHeightmap(t.tilingScheme.ellipsoid,t.heightMapWidth,t.tilingScheme.getNumberOfXTilesAtLevel(0)),e.defined(t.URLtemplateImage)&&(t.getHeightmapTerrainDataImage=function(a,l,c){var u;if(!isNaN(a+l+c)){var s=i(t.URLtemplateImage(a,l,c),a,l,c,n),f={highest:t.highest,lowest:t.lowest,offset:t.offset},p=o(a,l,c,n),d=e.throttleRequestByServer(s,e.loadImage);e.defined(d)&&(u=e.when(d,(function(e){return r.imageToHeightmapTerrainData(e,f,{width:t.heightMapWidth,height:t.heightMapHeight},t.waterMask,p,t.hasStyledImage)})).otherwise((function(){return new e.HeightmapTerrainData({buffer:new Uint16Array(t.heightMapWidth*t.heightMapHeight),width:t.heightMapWidth,height:t.heightMapHeight,childTileMask:p,waterMask:new Uint8Array(t.heightMapWidth*t.heightMapHeight),structure:t.formatImage.terrainDataStructure})})))}return u}),e.defined(t.URLtemplateArray)&&(t.getHeightmapTerrainDataArray=function(a,l,c){var u;if(!isNaN(a+l+c)){var s=i(t.URLtemplateArray(a,l,c),a,l,c,n),f={highest:t.highest,lowest:t.lowest,offset:t.offset},p=o(a,l,c,n),d=e.throttleRequestByServer(s,e.loadArrayBuffer);e.defined(d)&&(u=e.when(d,(function(e){return r.arrayToHeightmapTerrainData(e,f,{width:t.heightMapWidth,height:t.heightMapHeight},t.formatArray,t.waterMask,p)})).otherwise((function(){return e.defined(t.getHeightmapTerrainDataImage)?t.getHeightmapTerrainDataImage(a,l,c):new e.HeightmapTerrainData({buffer:new Uint16Array(t.heightMapWidth*t.heightMapHeight),width:t.heightMapWidth,height:t.heightMapHeight,childTileMask:p,waterMask:new Uint8Array(t.heightMapWidth*t.heightMapHeight),structure:t.formatImage.terrainDataStructure})})))}return u}),n.getLevelMaximumGeometricError=function(e){return t.levelZeroMaximumGeometricError/(1<<e)},n.requestTileGeometry=function(r,n,i){var o;return e.defined(t.getHeightmapTerrainDataArray)?o=t.getHeightmapTerrainDataArray(r,n,i):e.defined(t.getHeightmapTerrainDataImage)&&(o=t.getHeightmapTerrainDataImage(r,n,i)),o},e.defineProperties(n,{tilingScheme:{get:function(){return t.tilingScheme}},ready:{get:function(){return t.ready}},hasWaterMask:{get:function(){return t.waterMask}},heightMapHeight:{get:function(){return t.heightMapHeight}},heightMapWidth:{get:function(){return t.heightMapWidth}},getTileDataAvailable:{get:function(){return t.getTileDataAvailable}}}))}))}function i(e,t,r,n,i){var o=i.tilingScheme.tileXYToNativeRectangle(t,r,n),a=(o.east-o.west)/(i.heightMapWidth-1),l=(o.north-o.south)/(i.heightMapHeight-1);o.west-=.5*a,o.east+=.5*a,o.south-=.5*l,o.north+=.5*l;var c=i.tilingScheme.getNumberOfYTilesAtLevel(n)-r-1;return e.replace("{south}",o.south).replace("{north}",o.north).replace("{west}",o.west).replace("{east}",o.east).replace("{x}",t).replace("{y}",r).replace("{tmsY}",c)}function o(e,t,r,n){var i=0,o=r+1;return i|=n.getTileDataAvailable(2*e,2*t,o)?1:0,i|=n.getTileDataAvailable(2*e+1,2*t,o)?2:0,i|=n.getTileDataAvailable(2*e,2*t+1,o)?4:0,i|=n.getTileDataAvailable(2*e+1,2*t+1,o)?8:0}return r.arrayToHeightmapTerrainData=function(t,r,n,i,o,a){"number"==typeof n&&(n={width:n,height:n});var l=i.postProcessArray(t,n,r.highest,r.lowest,r.offset);if(!e.defined(l))throw new e.DeveloperError("no good size");var c={buffer:l,width:n.width,height:n.height,childTileMask:a,structure:i.terrainDataStructure};if(o){for(var u=new Uint8Array(l.length),s=0;s<l.length;s++)l[s]<=0&&(u[s]=255);c.waterMask=u}return new e.HeightmapTerrainData(c)},r.imageToHeightmapTerrainData=function(t,r,n,i,o,a){"number"==typeof n&&(n={width:n,height:n});for(var l=e.getImagePixels(t,n.width,n.height),c=new Uint8Array(l.length/4),u=new Int16Array(l.length/4),s=0,f=0,p=0;p<l.length;p+=4){var d=l[p],g=l[p+1],m=l[p+2]>128,h=(d<<8|g)-r.offset-32768;h>r.lowest&&h<r.highest&&(m||a)?(u[p/4]=h,f+=h,s++):u[p/4]=0==s?0:f/s}var y={buffer:u,width:n.width,height:n.height,childTileMask:o,structure:{heightScale:1,heightOffset:0,elementsPerHeight:1,stride:1,elementMultiplier:256,isBigEndian:!1}};if(i){for(c=new Uint8Array(heightBuffer.length),p=0;p<heightBuffer.length;p++)heightBuffer[p]<=0&&(c[p]=255);y.waterMask=c}return new e.HeightmapTerrainData(y)},r}},"./MapStore2/web/client/utils/cesium/WMSUtils.js":function(e,t){e.exports={PARAM_OPTIONS:["layers","styles","style","format","transparent","version","tiled","opacity","zindex","srs","singletile","_v_","filterobj"]}},"./MapStore2/web/client/utils/ogc/Filter/CQL/parser.js":function(e,t){var r="INTERSECTS",n="BBOX",i="CONTAINS",o="DWITHIN",a="WITHIN",l={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,IS_NULL:/^IS NULL/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('([^']|'')*'|-?\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(e){var t=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(e);if(t){var r=e.length,n=e.indexOf("(",t[0].length);if(n>-1)for(var i=1;n<r&&i>0;)switch(n++,e.charAt(n)){case"(":i++;break;case")":i--}return[e.substr(0,n+1)]}return null},END:/^$/},c={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON","BETWEEN","COMMA","IS_NULL"],BETWEEN:["VALUE"],IS_NULL:["END"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},u={"=":"=","<>":"<>","<":"<","<=":"<=",">":">",">=":">=",LIKE:"like",ILIKE:"ilike",BETWEEN:"><","IS NULL":"isNull"},s={AND:"and",OR:"or",NOT:"not"},f={RPAREN:3,LOGICAL:2,COMPARISON:1},p=function(e,t){return t instanceof RegExp?t.exec(e):t(e)},d=function(e,t){var r,n,i=t.length;for(r=0;r<i;r++){n=t[r];var o=p(e,l[n]);if(o){var a=o[0];return{type:n,text:a,remainder:e.substr(a.length).replace(/^\s*/,"")}}}var c="ERROR: In parsing: ["+e+"], expected one of: ";for(r=0;r<i;r++)c+="\n    "+(n=t[r])+": "+l[n];throw new Error(c)},g=function(e){for(var t=[],l=[];e.length;){var c=e.shift();switch(c.type){case"PROPERTY":case"GEOMETRY":case"VALUE":l.push(c);break;case"COMPARISON":case"BETWEEN":case"IS_NULL":case"LOGICAL":for(var p=f[c.type];t.length>0&&f[t[t.length-1].type]<=p;)l.push(t.pop());t.push(c);break;case"SPATIAL":case"NOT":case"LPAREN":t.push(c);break;case"RPAREN":for(;t.length>0&&"LPAREN"!==t[t.length-1].type;)l.push(t.pop());t.pop(),t.length>0&&"SPATIAL"===t[t.length-1].type&&l.push(t.pop());break;case"COMMA":case"END":break;default:throw new Error("Unknown token type "+c.type)}}for(;t.length>0;)l.push(t.pop());var d=function e(){var t=l.pop();switch(t.type){case"LOGICAL":var c=e();return{filters:[e(),c],type:s[t.text.toUpperCase()]};case"NOT":return{filters:[e()],type:s.NOT};case"BETWEEN":l.pop();var f=e(),p=e();return{property:e(),lowerBoundary:p,upperBoundary:f,type:u.BETWEEN};case"COMPARISON":var d=e();return{property:e(),value:d,type:u[t.text.toUpperCase()]};case"IS_NULL":return{property:e(),type:u[t.text.toUpperCase()]};case"VALUE":var g=t.text.match(/^'(.*)'$/);return g?g[1].replace(/''/g,"'"):Number(t.text);case"SPATIAL":switch(t.text.toUpperCase()){case"BBOX":var m=e(),h=e(),y=e(),b=e(),v=e();return{type:n,property:v,value:[b,y,h,m]};case"INTERSECTS":var O=e(),S=e();return{type:r,property:S,value:O};case"WITHIN":var w=e(),x=e();return{type:a,property:x,value:w};case"CONTAINS":var j=e(),M=e();return{type:i,property:M,value:j};case"DWITHIN":var T=e(),E=e(),P=e();return{type:o,value:E,property:P,distance:Number(T)};default:return null}case"GEOMETRY":return function(){throw new Error("WKT parsing for CQL filter not supported yet")}(t.text);default:return t.text}}();if(l.length>0){for(var g="Remaining tokens after building AST: \n",m=l.length-1;m>=0;m--)g+=l[m].type+": "+l[m].text+"\n";throw new Error(g)}return d};e.exports={read:function(e){return g(function(e){var t,r=[],n=e,i=["NOT","GEOMETRY","SPATIAL","PROPERTY","LPAREN"];do{if(n=(t=d(n,i)).remainder,i=c[t.type],"END"!==t.type&&!i)throw new Error("No follows list for "+t.type);r.push(t)}while("END"!==t.type);return r}(e))}}},"./MapStore2/web/client/utils/ogc/Filter/FilterBuilder.js":function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r("./MapStore2/web/client/utils/ogc/Filter/operators.js"),o=i.logical,a=i.spatial,l=i.comparison,c=i.literal,u=i.propertyName,s=i.valueReference,f=i.distance,p=i.lower,d=i.upper,g=r("./MapStore2/web/client/utils/ogc/Filter/filter.js"),m=g.filter,h=g.fidFilter,y=r("./MapStore2/web/client/utils/ogc/GML/index.js").processOGCGeometry;e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.filterNS,r=void 0===t?"ogc":t,i=e.gmlVersion,g=e.wfsVersion,b=void 0===g?"1.1.0":g,v=i||"3.1.1",O=function(e){return y(v,e)},S=function(e){return"object"===n(e)&&Date,c(r,e)},w=0===b.indexOf("2.")?s:u;return{filter:m.bind(null,r),fidFilter:h.bind(null,r),and:o.and.bind(null,r),or:o.or.bind(null,r),not:o.not.bind(null,r),property:function(e){return{equalTo:function(t){return l.equal(r,w(r,e),S(t))},greaterThen:function(t){return l.greater(r,w(r,e),S(t))},greaterThenOrEqualTo:function(t){return l.greaterOrEqual(r,w(r,e),S(t))},lessThen:function(t){return l.less(r,w(r,e),S(t))},lessThenOrEqualTo:function(t){return l.lessOrEqual(r,w(r,e),S(t))},notEqualTo:function(t){return l.notEqual(r,w(r,e),S(t))},between:function(t,n){return l.between(r,w(r,e),p(r,S(t)),d(r,S(n)))},like:function(t,n){return l.like(r,w(r,e),S(t),n)},ilike:function(t,n){return l.ilike(r,w(r,e),S(t),n)},isNull:function(){return l.isNull(r,w(r,e))},intersects:function(t){return a.intersects(r,w(r,e),O(t))},within:function(t){return a.within(r,w(r,e),O(t))},dwithin:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"m";return a.dwithin(r,w(r,e),O(t),f(r,n,i))},contains:function(t){return a.contains(r,w(r,e),O(t))}}}}}},"./MapStore2/web/client/utils/ogc/Filter/filter.js":function(e,t){var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ogc",t=arguments.length>1?arguments[1]:void 0;return"<".concat(e,":Filter>").concat(Array.isArray(t)?t.join(""):t,"</").concat(e,":Filter>")};e.exports={fidFilter:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ogc",t=arguments.length>1?arguments[1]:void 0;return r(e,"<".concat(e,':FeatureId fid="').concat(t,'"/>'))},filter:r}},"./MapStore2/web/client/utils/ogc/Filter/fromObject.js":function(e,t,r){function n(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return i(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var o=r("./MapStore2/node_modules/lodash/lodash.js"),a=o.includes,l=o.isNil,c=["and","or","not"],u={"=":"equalTo","<>":"notEqualTo","><":"between","<":"lessThen","<=":"lessThenOrEqualTo",">":"greaterThen",">=":"greaterThenOrEqualTo",like:"like",ilike:"ilike"};e.exports=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(r){var i=r.type,o=r.filters,s=void 0===o?[]:o,f=r.value,p=r.property,d=r.lowerBoundary,g=r.upperBoundary;return a(c,i)?t[i].apply(t,n(s.map(e(t)))):t.property(p)[u[i]](l(f)?d:f,g)}}},"./MapStore2/web/client/utils/ogc/Filter/operators.js":function(e,t){var r={"=":function(e,t){return"<".concat(e,":PropertyIsEqualTo>").concat(t,"</").concat(e,":PropertyIsEqualTo>")},">":function(e,t){return"<".concat(e,":PropertyIsGreaterThan>").concat(t,"</").concat(e,":PropertyIsGreaterThan>")},"<":function(e,t){return"<".concat(e,":PropertyIsLessThan>").concat(t,"</").concat(e,":PropertyIsLessThan>")},">=":function(e,t){return"<".concat(e,":PropertyIsGreaterThanOrEqualTo>").concat(t,"</").concat(e,":PropertyIsGreaterThanOrEqualTo>")},"<=":function(e,t){return"<".concat(e,":PropertyIsLessThanOrEqualTo>").concat(t,"</").concat(e,":PropertyIsLessThanOrEqualTo>")},"<>":function(e,t){return"<".concat(e,":PropertyIsNotEqualTo>").concat(t,"</").concat(e,":PropertyIsNotEqualTo>")},"><":function(e,t){return"<".concat(e,":PropertyIsBetween>").concat(t,"</").concat(e,":PropertyIsBetween>")},like:function(e,t){return"<".concat(e,':PropertyIsLike matchCase="true" wildCard="*" singleChar="." escapeChar="!">').concat(t,"</").concat(e,":PropertyIsLike>")},ilike:function(e,t){return"<".concat(e,':PropertyIsLike matchCase="false" wildCard="*" singleChar="." escapeChar="!">').concat(t,"</").concat(e,":PropertyIsLike>")},isNull:function(e,t){return"<".concat(e,":PropertyIsNull>").concat(t,"</").concat(e,":PropertyIsNull>")}},n={AND:function(e,t){return"<".concat(e,":And>").concat(t,"</").concat(e,":And>")},OR:function(e,t){return"<".concat(e,":Or>").concat(t,"</").concat(e,":Or>")},NOR:function(e,t){return"<".concat(e,":Not><").concat(e,":Or>").concat(t,"</").concat(e,":Or></").concat(e,":Not>")},NOT:function(e,t){return"<".concat(e,":Not>").concat(t,"</").concat(e,":Not>")}},i={INTERSECTS:function(e,t){return"<".concat(e,":Intersects>").concat(t,"</").concat(e,":Intersects>")},BBOX:function(e,t){return"<".concat(e,":BBOX>").concat(t,"</").concat(e,":BBOX>")},CONTAINS:function(e,t){return"<".concat(e,":Contains>").concat(t,"</").concat(e,":Contains>")},DWITHIN:function(e,t){return"<".concat(e,":DWithin>").concat(t,"</").concat(e,":DWithin>")},WITHIN:function(e,t){return"<".concat(e,":Within>").concat(t,"</").concat(e,":Within>")}},o=function(e,t,r){return t(e,Array.isArray(r)?r.join(""):r)},a={and:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return i&&i.length>0?o(e,n.AND,[t].concat(i)):o(e,n.AND,t)},or:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return i&&i.length>0?o(e,n.OR,[t].concat(i)):o(e,n.OR,t)},not:function(e,t){return o(e,n.NOT,t)},nor:function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];return i&&i.length>0?o(e,n.NOR,[t].concat(i)):o(e,n.NOR,t)}},l={intersects:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o(e,i.INTERSECTS,r)},within:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o(e,i.WITHIN,r)},bbox:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o(e,i.BBOX,r)},dwithin:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o(e,i.DWITHIN,r)},contains:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o(e,i.CONTAINS,r)}},c={equal:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r["="],n)},greater:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r[">"],n)},less:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r["<"],n)},greaterOrEqual:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r[">="],n)},lessOrEqual:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r["<="],n)},notEqual:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r["<>"],n)},between:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r["><"],n)},like:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r.like,n)},ilike:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r.ilike,n)},isNull:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return o(e,r.isNull,n)}};e.exports={ogcComparisonOperators:r,ogcLogicalOperators:n,ogcSpatialOperators:i,propertyName:function(e,t){return"<".concat(e,":PropertyName>").concat(t,"</").concat(e,":PropertyName>")},valueReference:function(e,t){return"<".concat(e,":ValueReference>").concat(t,"</").concat(e,":ValueReference>")},distance:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"m";return"<".concat(e,':Distance units="').concat(r,'">').concat(t,"</").concat(e,":Distance>")},literal:function(e,t){return"<".concat(e,":Literal>").concat(t,"</").concat(e,":Literal>")},logical:a,spatial:l,comparison:c,lower:function(e,t){return"<".concat(e,":LowerBoundary>").concat(t,"</").concat(e,":LowerBoundary>")},upper:function(e,t){return"<".concat(e,":UpperBoundary>").concat(t,"</").concat(e,":UpperBoundary>")}}},"./MapStore2/web/client/utils/ogc/GML/index.js":function(e,t,r){var n=r("./MapStore2/node_modules/lodash/lodash.js").isArray,i=function(e){return 0===e.indexOf("2.")},o=function(e){if(e.length>=3){var t=e[0],r=e[e.length-1];if(t[0]!==r[0]||t[1]!==r[1])return e.concat([e[0]])}return e},a=function(e,t,r){var n='<gml:Point srsDimension="2"';return n+=t?' srsName="'+t+'">':">",n+=i(r)?"<gml:coord><X>"+e[0]+"</X><Y>"+e[1]+"</Y></gml:coord>":"<gml:pos>"+e.join(" ")+"</gml:pos>",n+="</gml:Point>"},l=function(e,t,r){var a=i(r),l="<gml:Polygon";return l+=t?' srsName="'+t+'">':">",(e.length&&n(e[0])&&e[0].length&&n(e[0][0])?e:[e]).forEach((function(e,t){var r=o(e).map((function(e){return e[0]+(a?",":" ")+e[1]})),n=a?"outerBoundaryIs":"exterior",i=a?"innerBoundaryIs":"exterior";l+=(t<1?"<gml:"+n+">":"<gml:"+i+">")+"<gml:LinearRing>"+(a?"<gml:coordinates>":"<gml:posList>")+r.join(" ")+(a?"</gml:coordinates>":"</gml:posList>")+"</gml:LinearRing>"+(t<1?"</gml:"+n+">":"</gml:"+i+">")})),l+="</gml:Polygon>"},c=function(e,t,r){var n=i(r),o="<gml:LineString";o+=t?' srsName="'+t+'">':">";var a=e.map((function(e){return e[0]+(n?",":" ")+e[1]}));return o+=(n?"<gml:coordinates>":"<gml:posList>")+a.join(" ")+(n?"</gml:coordinates>":"</gml:posList>"),o+="</gml:LineString>"};e.exports={closePolygon:o,pointElement:a,polygonElement:l,lineStringElement:c,processOGCGeometry:function(e,t){var r="",n=t.projection||"EPSG:4326";switch(t.type){case"Point":r+=a(t.coordinates,n,e);break;case"MultiPoint":r+='<gml:MultiPoint srsName="'+(t.projection||"EPSG:4326")+'">',t.coordinates.forEach((function(t){t&&(r+="<gml:pointMember>",r+=a(t,n,e),r+="</gml:pointMember>")})),r+="</gml:MultiPoint>";break;case"LineString":r+=c(t.coordinates,n,e);break;case"MultiLineString":var i="3.2"===e?"MultiCurve":"MultiLineString",o="3.2"===e?"curveMember":"lineStringMember";r+="<gml:".concat(i,' srsName="').concat(n,'">'),t.coordinates.forEach((function(t){t&&(r+="<gml:"+o+">",r+=c(t,n,e),r+="</gml:"+o+">")})),r+="</gml:"+i+">";break;case"Polygon":r+=l(t.coordinates,n,e);break;case"MultiPolygon":var u="3.2"===e?"MultiSurface":"MultiPolygon",s="3.2"===e?"surfaceMembers":"polygonMember";r+="<gml:".concat(u,' srsName="').concat(n,'">'),t.coordinates.forEach((function(t){t&&(r+="<gml:"+s+">",r+=l(t,n,e),r+="</gml:"+s+">")})),r+="</gml:"+u+">"}return r}}},"./MapStore2/web/client/utils/ogc/WFS/base.js":function(e,t,r){var n=r("./MapStore2/node_modules/lodash/lodash.js"),i=n.head,o=n.get,a=function(e){return/[<>&'"]/.test(e)?"<![CDATA[".concat(e,"]]>"):e},l=r("./MapStore2/web/client/utils/ogc/GML/index.js").processOGCGeometry,c={"1.0.0":"2.0","1.1.0":"3.1.1","2.0":"3.2","2.0.0":"3.2"},u=function(e){return o(e,"featureTypes[0].properties")},s=function(e,t){return i((u(t)||[]).filter((function(t){return t.name===e})))},f=function(e){return e.targetNamespace},p=function(e){return 0===e.type.indexOf("gml:")},d=function(e,t){return null==t||t&&!0===t.nillable||t&&!1===t.nillable&&null!=e},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.geom,r=e.properties,n=arguments.length>1?arguments[1]:void 0;return d(p(n)?t:r[n.name],n)};e.exports={schemaLocation:f,isGeometryType:p,featureTypeSchema:function(e){return"xmlns:".concat(e.targetPrefix,'="').concat(f(e),'"')},getValue:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"1.1.0",i=p(s(t,r));return i?e?l(n,{type:e.type,coordinates:e.coordinates}):"":null==e?"":"string"==typeof e?a(e):e},getPropertyDesciptor:s,findGeometryProperty:function(e){return i((u(e)||[]).filter((function(e){return 0===e.type.indexOf("gml:")})))},getFeatureTypeProperties:u,getTypeName:function(e){return e.targetPrefix?e.targetPrefix+":"+e.featureTypes[0].typeName:e.featureTypes[0].typeName},wfsToGmlVersion:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"1.1.0";return c[e]},processOGCGeometry:l,isValid:function(e,t){return u(t).map((function(t){return g(e,t)}))},isValidProperty:g,isValidValueForPropertyName:function(e,t,r){return d(e,s(t,r))},isValidValue:d}}}]);